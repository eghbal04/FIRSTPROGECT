<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>IAMPHOENIX</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Arabic:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Mono&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/index-custom.css">
    <link rel="stylesheet" href="css/floating-ai-assistant.css">
    <link rel="stylesheet" href="css/smooth-transitions.css">
    <link rel="stylesheet" href="css/mobile-user-popup.css">
    <link rel="stylesheet" href="css/modern-theme.css">

    <!-- Loading ethers.js version 6 from CDN -->
    <script src="https://cdn.jsdelivr.net/npm/ethers@6.10.0/dist/ethers.umd.min.js"></script>
    <!-- Loading WalletConnect Provider from official CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>
    <!-- Loading WalletConnect Handler -->
    <script src="js/walletconnect-handler.js?v=5.7"></script>

      <!-- Loading WalletConnect UMD locally -->
  <script src="js/walletconnect-v1.8.0.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>
  <script src="js/auth-redirect.js"></script>
  <script src="js/modern-theme-variables.js"></script>
  
      <!-- Loading contract base knowledge -->
  <!-- <script src="js/contract-knowledge-base.js"></script> -->
  
      <!-- Loading Floating AI Assistants -->
  <!-- <script src="js/floating-ai-assistant.js"></script> -->
  
  <!-- Immediate AI Assistant Initialization -->
  <!--
  <script>
    // Force immediate initialization
    document.addEventListener('DOMContentLoaded', function() {
      console.log('๐ DOM Content Loaded - Initializing AI Assistant...');

      setTimeout(() => {
        // ููุท ุฏุณุชุงุฑ ูพุดุฑูุชู ุฑุง ููุฏุงุฑุฏู ฺฉู
        if (typeof FloatingAIAssistant !== 'undefined') {
          console.log('โ FloatingAIAssistant class found');

          if (!window.floatingAI) {
            console.log('๐ Creating new FloatingAIAssistant instance...');
            window.floatingAI = new FloatingAIAssistant();
          }
          
          if (window.floatingAI) {
            console.log('โ FloatingAI instance ready');
            window.floatingAI.switchToIdleState();
          }
        } else {
          console.error('โ FloatingAIAssistant class not found');
        }
      }, 1000);
    });
  </script>
  -->
  
  <!-- Test script for floating AI -->

</head>
<body>
  <div id="online-session-bubble" style="display:none;">
          <span class="bubble-text">Online session is in progress! ๐</span>
    <span class="bubble-timer" id="bubble-timer"></span>
    <a href="learning.html" class="bubble-link" target="_blank">Go to Class</a>
    <span class="bubble-close" id="bubble-close">ร</span>
  </div>
  <div id="bubble-mini" style="display:none;">
    <span class="bubble-mini-icon">๐</span>
  </div>


  <script>
    function formatCountdown(ms) {
      if (ms <= 0) return '00:00:00';
      let s = Math.floor(ms / 1000);
      let h = Math.floor(s / 3600);
      s = s % 3600;
      let m = Math.floor(s / 60);
      s = s % 60;
      return `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
    }
    function showSessionBubble() {
      const info = window.sessionInfo;
      if (!info || !info.active) return;
      const bubble = document.getElementById('online-session-bubble');
      const mini = document.getElementById('bubble-mini');
      const timer = document.getElementById('bubble-timer');
      const link = bubble.querySelector('.bubble-link');
      link.href = info.link || 'learning.html';
      bubble.style.display = 'flex';
      mini.style.display = 'none';
      // ุดูุงุฑุด ูุนฺฉูุณ
      function updateTimer() {
        const now = Date.now();
        if (now < info.startTime) {
          timer.textContent = 'ุดุฑูุน ุชุง ุฌูุณู: ' + formatCountdown(info.startTime - now);
        } else if (now < info.endTime) {
          timer.textContent = 'ุฒูุงู ุจุงูโูุงูุฏู: ' + formatCountdown(info.endTime - now);
        } else {
          timer.textContent = 'ุฌูุณู ุจู ูพุงุงู ุฑุณุฏ';
        }
      }
      updateTimer();
      window._bubbleTimerInterval = setInterval(updateTimer, 1000);
    }
    function hideSessionBubble() {
      document.getElementById('online-session-bubble').style.display = 'none';
      document.getElementById('bubble-mini').style.display = 'flex';
      if (window._bubbleTimerInterval) clearInterval(window._bubbleTimerInterval);
    }
    function showMiniBubble() {
      document.getElementById('bubble-mini').style.display = 'flex';
      document.getElementById('online-session-bubble').style.display = 'none';
    }
    function expandMiniBubble() {
      showSessionBubble();
    }
    // ุฑูุฏุงุฏ ุจุณุชู
    document.addEventListener('DOMContentLoaded', function() {
      if (window.sessionInfo && window.sessionInfo.active) {
        showSessionBubble();
      }
      document.getElementById('bubble-close').onclick = hideSessionBubble;
      document.getElementById('bubble-mini').onclick = expandMiniBubble;
    });
  </script>

  
  
  <div id="main-dashboard" class="page-section" style="position:relative;overflow:visible;">
    <!-- User Status Bar (shown above dashboard cards for active users) -->
    <div id="index-user-status-bar" style="display:none;max-width:1200px;margin:0.75rem auto 0.5rem auto;padding:0.75rem 1rem;border-radius:16px;border:1px solid rgba(0,255,136,0.25);background:linear-gradient(135deg, rgba(0,255,136,0.08), rgba(167,134,255,0.08));box-shadow:0 6px 18px rgba(0,0,0,0.25), 0 1px 0 rgba(255,255,255,0.06) inset;backdrop-filter:blur(10px);">
      <div style="display:flex;align-items:center;justify-content:center;gap:0.75rem;flex-wrap:wrap;">
        <div style="display:flex;align-items:center;gap:0.5rem;flex-wrap:wrap;">
          <span id="index-status-active" style="display:inline-flex;align-items:center;gap:0.4rem;padding:0.35rem 0.7rem;border-radius:12px;font-weight:700;color:#0f2d1f;background:linear-gradient(135deg,#00ff88,#00d178);border:1px solid rgba(0,255,136,0.4);box-shadow:0 2px 8px rgba(0,255,136,0.25);">โ ูุนุงู</span>
          <span id="index-status-id" style="display:inline-flex;align-items:center;gap:0.4rem;padding:0.35rem 0.7rem;border-radius:12px;color:#ffffff;background:linear-gradient(135deg, rgba(0,255,136,0.12), rgba(167,134,255,0.12));border:1px solid rgba(255,255,255,0.18);font-weight:700;">๐ IAM--</span>
          <span id="index-status-address" title="" style="display:inline-flex;align-items:center;gap:0.4rem;padding:0.35rem 0.7rem;border-radius:12px;color:#ffffff;background:linear-gradient(135deg, rgba(167,134,255,0.12), rgba(0,255,136,0.12));border:1px solid rgba(255,255,255,0.18);font-family:'Fira Mono', monospace;">๐ 0x...</span>
          <button onclick="scrollToRanking()" style="display:inline-flex;align-items:center;gap:0.4rem;padding:0.35rem 0.7rem;border-radius:12px;color:#ffffff;background:linear-gradient(135deg, rgba(167,134,255,0.8), rgba(0,255,136,0.8));border:1px solid rgba(255,255,255,0.18);font-weight:700;cursor:pointer;border:none;font-size:0.9rem;">๐ ุฑูฺฉูฺฏ</button>
        </div>
      </div>
    </div>
    <script>
      (function(){
        function shortenAddress(addr){ if(!addr||typeof addr!=='string') return '-'; return addr.slice(0,6)+'...'+addr.slice(-4); }
        function formatIAMId(indexVal){
          try {
            let s = (typeof indexVal === 'bigint') ? indexVal.toString() : (indexVal && indexVal.toString ? indexVal.toString() : String(indexVal||''));
            // ensure only digits
            s = s.replace(/\D+/g,'');
            if (!s) return 'IAM-----';
            return 'IAM' + s.padStart(5,'0');
          } catch { return 'IAM-----'; }
        }
        function showBar(address, userData){
          const bar = document.getElementById('index-user-status-bar'); if(!bar) return;
          if (!address) { bar.style.display='none'; return; }
          // Derive active state robustly
          let active = false;
          let hasIndex = false;
          if (userData && userData.index != null) {
            try {
              const idxStr = (typeof userData.index === 'bigint') ? userData.index.toString() : (userData.index.toString ? userData.index.toString() : String(userData.index));
              hasIndex = idxStr !== '0';
            } catch(_) {}
          }
          if (userData) {
            if (userData.isActive === true || userData.activated === true) active = true;
            else if (userData.isActive === false || userData.activated === false) active = false;
          }
          // Consider registered index as active indicator if flags are missing
          if (!active && hasIndex) active = true;
          const idEl = document.getElementById('index-status-id');
          const addrEl = document.getElementById('index-status-address');
          const statusEl = document.getElementById('index-status-active');
          if (idEl) {
            if (hasIndex) { idEl.textContent = '๐ ' + formatIAMId(userData.index); }
            else { idEl.textContent = '๐ IAM--'; }
          }
          if (addrEl) { addrEl.textContent = '๐ ' + shortenAddress(address); addrEl.title = address; }
          if (statusEl) {
            if (active) {
              statusEl.textContent = 'โ ูุนุงู';
              statusEl.style.background = 'linear-gradient(135deg,#00ff88,#00d178)';
              statusEl.style.color = '#0f2d1f';
              statusEl.style.border = '1px solid rgba(0,255,136,0.4)';
              statusEl.style.boxShadow = '0 2px 8px rgba(0,255,136,0.25)';
            } else {
              statusEl.textContent = 'โ ุบุฑูุนุงู';
              statusEl.style.background = 'linear-gradient(135deg,#ff6b6b,#c82333)';
              statusEl.style.color = '#ffffff';
              statusEl.style.border = '1px solid rgba(255,68,68,0.4)';
              statusEl.style.boxShadow = '0 2px 8px rgba(255,68,68,0.25)';
            }
          }
          const copyBtn = document.getElementById('index-status-copy');
          if(copyBtn){ copyBtn.onclick = function(){ if(!address) return; navigator.clipboard.writeText(address).then(()=>{ const t=copyBtn.textContent; copyBtn.textContent='โ ฺฉูพ ุดุฏ'; setTimeout(()=>copyBtn.textContent=t,1500); }); } }
          bar.style.display='block';
        }
        function schedule(ms, fn){ setTimeout(fn, ms); }
        async function tryUpdate(){
          try{
            if(typeof window.ethers === 'undefined'){ return schedule(2000, tryUpdate); }
            // Prefer existing connected contract (with correct ABI)
            let address = null;
            let userData = null;
            if (window.contractConfig && window.contractConfig.contract) {
              try {
                address = window.contractConfig.address;
                const contract = window.contractConfig.contract;
                if (!address && window.contractConfig.signer && window.contractConfig.signer.getAddress) {
                  address = await window.contractConfig.signer.getAddress();
                }
                if (!address) { return schedule(3000, tryUpdate); }
                // Try primary users(address)
                try {
                  userData = await Promise.race([
                    contract.users(address),
                    new Promise((_,rej)=>setTimeout(()=>rej(new Error('timeout')),3000))
                  ]);
                } catch(e) {
                  userData = null;
                }
                // Fallbacks to derive index and activation
                let idxVal = null;
                try {
                  if (!userData || userData.index == null || (userData.index.toString && userData.index.toString() === '0')) {
                    if (typeof contract.getUserIndex === 'function') {
                      const idxRaw = await Promise.race([
                        contract.getUserIndex(address),
                        new Promise((_,rej)=>setTimeout(()=>rej(new Error('timeout')),3000))
                      ]);
                      idxVal = (typeof idxRaw === 'bigint') ? idxRaw : (idxRaw && idxRaw.toString ? BigInt(idxRaw.toString()) : null);
                    }
                  } else { idxVal = userData.index; }
                } catch(_) {}
                let act = null;
                try {
                  if (!userData || (userData.isActive == null && userData.activated == null)) {
                    if (typeof contract.getUserTree === 'function') {
                      const tree = await Promise.race([
                        contract.getUserTree(address),
                        new Promise((_,rej)=>setTimeout(()=>rej(new Error('timeout')),3000))
                      ]);
                      if (Array.isArray(tree) && tree.length >= 3) act = !!tree[2];
                    }
                  } else { act = !!(userData.isActive || userData.activated); }
                } catch(_) {}
                if (idxVal != null || act != null) {
                  userData = userData || {};
                  if (idxVal != null) userData.index = idxVal;
                  if (act != null) { userData.isActive = act; userData.activated = act; }
                }
              } catch(e) {
                // fallback to provider+IAM globals
              }
            }

            if (!userData) {
              const provider = (window.ethereum ? new ethers.BrowserProvider(window.ethereum) : null);
              if(!provider){ return schedule(2000, tryUpdate); }
              if(!address && window.ethereum && typeof window.ethereum.request==='function'){
                try{ const acc = await Promise.race([window.ethereum.request({method:'eth_accounts'}), new Promise((_,rej)=>setTimeout(()=>rej(new Error('timeout')),1500))]); if(acc && acc[0]) address = acc[0]; }catch(_e){}
              }
              if(!address){ return schedule(4000, tryUpdate); }
              if(!(window.IAM_ADDRESS && window.IAM_ABI)){
                // Show bar with address even if contract globals not ready
                showBar(address, null);
                return schedule(2000, tryUpdate);
              }
              try {
                const fallbackContract = new ethers.Contract(window.IAM_ADDRESS, window.IAM_ABI, provider);
                // Try users(address)
                try {
                  userData = await Promise.race([
                    fallbackContract.users(address),
                    new Promise((_,rej)=>setTimeout(()=>rej(new Error('timeout')),3000))
                  ]);
                } catch(_) { userData = null; }
                // Fill missing index
                let idxVal = null;
                try {
                  if (!userData || userData.index == null || (userData.index.toString && userData.index.toString() === '0')) {
                    if (typeof fallbackContract.getUserIndex === 'function') {
                      const idxRaw = await Promise.race([
                        fallbackContract.getUserIndex(address),
                        new Promise((_,rej)=>setTimeout(()=>rej(new Error('timeout')),3000))
                      ]);
                      idxVal = (typeof idxRaw === 'bigint') ? idxRaw : (idxRaw && idxRaw.toString ? BigInt(idxRaw.toString()) : null);
                    }
                  } else { idxVal = userData.index; }
                } catch(_) {}
                // Fill missing activation
                let act = null;
                try {
                  if (!userData || (userData.isActive == null && userData.activated == null)) {
                    if (typeof fallbackContract.getUserTree === 'function') {
                      const tree = await Promise.race([
                        fallbackContract.getUserTree(address),
                        new Promise((_,rej)=>setTimeout(()=>rej(new Error('timeout')),3000))
                      ]);
                      if (Array.isArray(tree) && tree.length >= 3) act = !!tree[2];
                    }
                  } else { act = !!(userData.isActive || userData.activated); }
                } catch(_) {}
                if (idxVal != null || act != null) {
                  userData = userData || {};
                  if (idxVal != null) userData.index = idxVal;
                  if (act != null) { userData.isActive = act; userData.activated = act; }
                }
                if (!userData) return schedule(4000, tryUpdate);
              } catch(e) {
                return schedule(4000, tryUpdate);
              }
            }

            showBar(address, userData);
            schedule(10000, tryUpdate);
          }catch(e){ schedule(4000, tryUpdate); }
        }
        // expose for external triggers (e.g., after connect)
        window.indexStatusTryUpdate = tryUpdate;
        document.addEventListener('DOMContentLoaded', function(){
          schedule(1000, tryUpdate);
          if (window.ethereum && typeof window.ethereum.on === 'function') {
            try { window.ethereum.on('accountsChanged', () => setTimeout(tryUpdate, 500)); } catch(_){ }
            try { window.ethereum.on('chainChanged', () => setTimeout(tryUpdate, 800)); } catch(_){ }
          }
        });
      })();
    </script>
    <div class="dashboard-cards" style="display:flex;justify-content:center;flex-wrap:wrap;gap:1rem;max-width:1400px;margin:0 auto;">
      <!-- AI Assistant will be inserted here by JavaScript -->

      <!-- Blockchain Information Cards -->
      <div class="modern-card dashboard-card" style="min-width:100%;max-width:100%;margin:1rem 0;width:100%;padding:1.5rem;position:relative;overflow:hidden;">
        <div style="position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,#00ff88,#a786ff,#00ff88);animation:shimmer 2s linear infinite;"></div>
        
        <div style="text-align:center;margin-bottom:1.5rem;">
          <h3 style="color:#00ff88;font-size:1.2rem;font-weight:bold;margin:0;font-family:monospace;">IAMPHOENIX</h3>
        </div>
        
        <!-- User Info Section -->
        <div id="dashboard-user-info" style="background:rgba(0,255,136,0.1);border-radius:12px;padding:1rem;margin-bottom:1rem;border:1px solid rgba(0,255,136,0.2);display:none;">
          <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:0.5rem;">
            <div style="text-align:center;flex:1;min-width:120px;">
                                  <div style="color:#00ff88;font-size:0.8rem;font-weight:bold;margin-bottom:0.3rem;">ุงูุฏฺฉุณ</div>
              <div style="color:#fff;font-size:1rem;font-family:monospace;font-weight:bold;" id="dashboard-user-index">-</div>
            </div>
            <div style="text-align:center;flex:1;min-width:120px;">
              <div style="color:#00ff88;font-size:0.8rem;font-weight:bold;margin-bottom:0.3rem;">ุขุฏุฑุณ ฺฉู ูพูู</div>
              <div style="color:#fff;font-size:0.9rem;font-family:monospace;" id="dashboard-user-address">-</div>
            </div>
            <div style="text-align:center;flex:1;min-width:120px;">
              <div style="color:#00ff88;font-size:0.8rem;font-weight:bold;margin-bottom:0.3rem;">ูุถุนุช</div>
              <div style="color:#00ff88;font-size:0.9rem;font-weight:bold;" id="dashboard-user-status">-</div>
            </div>
          </div>
        </div>
        
        <div style="display:flex;flex-wrap:wrap;gap:0.5rem;margin-bottom:1rem;justify-content:center;">
          <!-- 1. ฺฉู ุนุฑุถู - ุงูููุช ุงูู -->
          <div style="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid rgba(0,255,136,0.2);text-align:center;min-width:140px;flex:1;max-width:180px;">
            <div style="color:#00ff88;font-size:1.2rem;margin-bottom:0.3rem;">๐ฐ</div>
            <div style="color:#fff;font-size:0.8rem;font-weight:bold;margin-bottom:0.2rem;">ฺฉู ุนุฑุถู</div>
            <div style="color:#00ff88;font-size:0.9rem;font-family:monospace;font-weight:bold;" id="circulating-supply" class="dashboard-value smooth-value-transition numeric-value">-</div>
            <div style="color:#888;font-size:0.7rem;margin-top:0.2rem;">IAM Tokens</div>
            <div style="color:#f7931e;font-size:0.7rem;font-family:monospace;font-weight:bold;margin-top:0.2rem;" id="circulating-supply-dai">-</div>
            <div style="color:#888;font-size:0.6rem;margin-top:0.1rem;">โ DAI</div>
          </div>
          
          <!-- 2. ููุฌูุฏ IAM ูุฑุงุฑุฏุงุฏ - ุงูููุช ุฏูู -->
          <div style="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid rgba(255,193,7,0.2);text-align:center;min-width:140px;flex:1;max-width:180px;">
            <div style="color:#ffc107;font-size:1.2rem;margin-bottom:0.3rem;">๐ฆ</div>
            <div style="color:#fff;font-size:0.8rem;font-weight:bold;margin-bottom:0.2rem;">ููุฌูุฏ ูุฑุงุฑุฏุงุฏ</div>
            <div style="color:#ffc107;font-size:0.9rem;font-family:monospace;font-weight:bold;" id="contract-token-balance" class="dashboard-value smooth-value-transition numeric-value">-</div>
            <div style="color:#888;font-size:0.7rem;margin-top:0.2rem;">IAM in Contract</div>
            <div style="color:#f7931e;font-size:0.7rem;font-family:monospace;font-weight:bold;margin-top:0.2rem;" id="contract-token-balance-dai">-</div>
            <div style="color:#888;font-size:0.6rem;margin-top:0.1rem;">โ DAI</div>
          </div>
          
          <!-- 3. ููุฌูุฏ ูุฑุงุฑุฏุงุฏ DAI - ุงูููุช ุณูู -->
          <div style="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid rgba(0,123,255,0.2);text-align:center;min-width:140px;flex:1;max-width:180px;">
            <div style="color:#007bff;font-size:1.2rem;margin-bottom:0.3rem;">๐ต</div>
            <div style="color:#fff;font-size:0.8rem;font-weight:bold;margin-bottom:0.2rem;">ููุฌูุฏ ูุฑุงุฑุฏุงุฏ</div>
            <div style="color:#007bff;font-size:0.9rem;font-family:monospace;font-weight:bold;" id="dashboard-dai-balance" class="dashboard-value smooth-value-transition numeric-value">-</div>
            <div style="color:#888;font-size:0.7rem;margin-top:0.2rem;">Contract Balance</div>
          </div>
          
          <!-- 4. ููุช ุชูฺฉู - ุงูููุช ฺูุงุฑู -->
          <div style="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid rgba(0,255,136,0.2);text-align:center;min-width:140px;flex:1;max-width:180px;">
            <div style="color:#00ff88;font-size:1.2rem;margin-bottom:0.3rem;">๐ฒ</div>
            <div style="color:#fff;font-size:0.8rem;font-weight:bold;margin-bottom:0.2rem;">ููุช ุชูฺฉู IAM</div>
            <div style="color:#00ff88;font-size:0.9rem;font-family:monospace;font-weight:bold;" id="dashboard-token-price" class="dashboard-value smooth-value-transition numeric-value">-</div>
            <div style="color:#888;font-size:0.7rem;margin-top:0.2rem;">DAI per IAM</div>
          </div>
          
          <!-- 5. ููุช ุซุจุชโูุงู - ุงูููุช ูพูุฌู -->
          <div style="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid rgba(138,43,226,0.2);text-align:center;min-width:140px;flex:1;max-width:180px;">
            <div style="color:#8a2be2;font-size:1.2rem;margin-bottom:0.3rem;">๐ซ</div>
            <div style="color:#fff;font-size:0.8rem;font-weight:bold;margin-bottom:0.2rem;">ููุช ุซุจุชโูุงู</div>
            <div style="color:#8a2be2;font-size:0.9rem;font-family:monospace;font-weight:bold;" id="dashboard-registration-price" class="dashboard-value smooth-value-transition numeric-value">-</div>
            <div style="color:#888;font-size:0.7rem;margin-top:0.2rem;">IAM per Registration</div>
            <div style="color:#f7931e;font-size:0.7rem;font-family:monospace;font-weight:bold;margin-top:0.2rem;" id="dashboard-registration-price-dai">-</div>
            <div style="color:#888;font-size:0.6rem;margin-top:0.1rem;">โ DAI</div>
          </div>
          
          <!-- ุจูู ฺฉุงุฑุชโูุง -->
          
          <!-- Total Points Card -->
          <div style="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid rgba(167,134,255,0.2);text-align:center;min-width:140px;flex:1;max-width:180px;">
            <div style="color:#a786ff;font-size:1.2rem;margin-bottom:0.3rem;">๐ฏ</div>
            <div style="color:#fff;font-size:0.8rem;font-weight:bold;margin-bottom:0.2rem;">ฺฉู ูพููุชโูุง</div>
            <div style="color:#a786ff;font-size:0.9rem;font-family:monospace;font-weight:bold;" id="total-points" class="dashboard-value smooth-value-transition numeric-value">-</div>
            <div style="color:#888;font-size:0.7rem;margin-top:0.2rem;">Binary Points</div>
          </div>
          
          <!-- Point Value Card -->
          <div style="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid rgba(0,255,136,0.2);text-align:center;min-width:140px;flex:1;max-width:180px;">
            <div style="color:#00ff88;font-size:1.2rem;margin-bottom:0.3rem;">๐</div>
            <div style="color:#fff;font-size:0.8rem;font-weight:bold;margin-bottom:0.2rem;">ุงุฑุฒุด ูุฑ ูพููุช</div>
            <div style="color:#00ff88;font-size:0.9rem;font-family:monospace;font-weight:bold;" id="dashboard-point-value" class="dashboard-value smooth-value-transition numeric-value">-</div>
            <div style="color:#888;font-size:0.7rem;margin-top:0.2rem;">IAM per Point</div>
            <div style="color:#f7931e;font-size:0.7rem;font-family:monospace;font-weight:bold;margin-top:0.2rem;" id="dashboard-point-value-dai">-</div>
            <div style="color:#888;font-size:0.6rem;margin-top:0.1rem;">โ DAI</div>
          </div>
          
          <!-- Help Fund Card -->
          <div style="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid rgba(220,53,69,0.2);text-align:center;min-width:140px;flex:1;max-width:180px;">
            <div style="color:#dc3545;font-size:1.2rem;margin-bottom:0.3rem;">๐</div>
            <div style="color:#fff;font-size:0.8rem;font-weight:bold;margin-bottom:0.2rem;">ุตูุฏูู ฺฉูฺฉ</div>
            <div style="color:#dc3545;font-size:0.9rem;font-family:monospace;font-weight:bold;" id="dashboard-cashback-value">-</div>
            <div style="color:#888;font-size:0.7rem;margin-top:0.2rem;">Cashback Pool</div>
            <div style="color:#f7931e;font-size:0.7rem;font-family:monospace;font-weight:bold;margin-top:0.2rem;" id="dashboard-cashback-value-dai">-</div>
            <div style="color:#888;font-size:0.6rem;margin-top:0.1rem;">โ DAI</div>
          </div>
          
          <!-- Wallet Count Card -->
          <div style="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid rgba(255,165,0,0.2);text-align:center;min-width:140px;flex:1;max-width:180px;">
            <div style="color:#ffa500;font-size:1.2rem;margin-bottom:0.3rem;">๐</div>
            <div style="color:#fff;font-size:0.8rem;font-weight:bold;margin-bottom:0.2rem;">ุชุนุฏุงุฏ ููุชโูุง</div>
            <div style="color:#ffa500;font-size:0.9rem;font-family:monospace;font-weight:bold;" id="dashboard-wallets-count" class="dashboard-value smooth-value-transition numeric-value">-</div>
            <div style="color:#888;font-size:0.7rem;margin-top:0.2rem;">Connected Wallets</div>
          </div>
          
          <!-- Network Status Card -->
          <div style="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid rgba(40,167,69,0.2);text-align:center;min-width:140px;flex:1;max-width:180px;">
            <div style="color:#28a745;font-size:1.2rem;margin-bottom:0.3rem;">๐</div>
            <div style="color:#fff;font-size:0.8rem;font-weight:bold;margin-bottom:0.2rem;">ูุถุนุช ุดุจฺฉู</div>
            <div style="color:#28a745;font-size:0.9rem;font-family:monospace;font-weight:bold;" id="network-status">Polygon</div>
            <div style="color:#888;font-size:0.7rem;margin-top:0.2rem;">Active</div>
          </div>
        </div>
        
        <!-- Last Update Info -->
        <div style="text-align:center;margin-top:1rem;padding-top:1rem;border-top:1px solid rgba(255,255,255,0.1);">
          <div style="color:#888;font-size:0.8rem;font-family:monospace;margin-bottom:0.5rem;">
            ุขุฎุฑู ุจุฑูุฒุฑุณุงู: <span id="blockchain-last-update">-</span>
          </div>
          <!-- ุฏฺฉูู ุจุฑูุฒุฑุณุงู ุญุฐู ุดุฏ -->
        </div>
        

      </div>

      <!-- ุฑูฺฉูฺฏ ฺฉุงุฑุจุฑุงู ุจุฑุชุฑ -->
      <div id="top-users-ranking" class="modern-card" style="margin-top: 2rem; padding: 1rem;">
        <!-- Ranking content is loaded by JavaScript -->
        <div style="text-align: center; padding: 1rem;">
          <div class="modern-heading-2" style="margin-bottom: 1rem;">๐ ุฑูฺฉูฺฏ ฺฉุงุฑุจุฑุงู ุจุฑุชุฑ</div>
          <div style="color: var(--modern-text-secondary); font-size: 0.9rem; margin-bottom: 1rem;">ุจุฑุง ูุดุงูุฏู 10 ฺฉุงุฑุจุฑ ุจุฑุชุฑ ุจุฑ ุงุณุงุณ ูุงฺฉโูุงุ ุฏฺฉูู ุฒุฑ ุฑุง ฺฉูฺฉ ฺฉูุฏ</div>
          <div class="modern-alert modern-alert-info" style="margin-bottom: 1rem;">
            ๐ก <strong>ูฺฉุชู:</strong> ูโุชูุงูุฏ ุจุฑุง ูุฑ ฺฉุงุฑุจุฑ ูุงฺฉ ุง ุฏุณูุงฺฉ ฺฉูุฏ ู ููฺูู ุจุง ูุงุฑุฏ ฺฉุฑุฏู ุงูุฏฺฉุณุ ุจุฑุง ูุฑ ฺฉุงุฑุจุฑ ุฑุง ุฏูุฏ
          </div>
          <button onclick="loadRanking()" class="modern-btn modern-btn-primary" style="font-size: 1rem;">
            ๐ Loading ranking
          </button>
        </div>
      </div>



      <script>
      document.addEventListener('DOMContentLoaded', function() {
        
        // ูพุงูพโุงูพ ููุงูู ุณูุงูพ ุญุฐู ุดุฏ
        
        // (swap pre-modal removed)
        // ููุงุด ูพุงูพ ุขูพ ุฎูุดุงูุฏฺฏู
        function showWelcomeModal() {
          console.log('๐ showWelcomeModal called');
          const modal = document.getElementById('welcome-modal');
          const closeBtn = document.getElementById('welcome-modal-close');
          const understandBtn = document.getElementById('welcome-understand-btn');
          console.log('Modal element found:', !!modal);
          
          // Always show the welcome modal on each visit
          
          // ููุงุด ููุฏุงู ุจุนุฏ ุงุฒ 1.5 ุซุงูู
          console.log('โฑ๏ธ Setting timeout for modal display');
          setTimeout(() => {
            console.log('โก Timeout reached, showing modal');
            if (modal) {
              modal.style.display = 'flex';
              document.body.style.overflow = 'hidden';
              console.log('โ Modal display set to flex');
              startWelcomeTypewriter();
            } else {
              console.error('โ Modal element not found!');
            }
          }, 1500);
          
          function closeModal() {
            modal.style.display = 'none';
            document.body.style.overflow = '';
            // Do not persist seen flag; always show on next visit
          }
          
          // ุชุงุจุน ุจุณุชู ูพุงูพ ุงูพ
          window.closeWelcomeModal = function() {
            // ูุชููู ฺฉุฑุฏู ุชุงูุฑ
            if (readingTimerInterval) {
              clearInterval(readingTimerInterval);
            }
            const modal = document.getElementById('welcome-modal');
            if (modal) {
              modal.style.display = 'none';
              document.body.style.overflow = '';
            }
          };
          
          if (closeBtn) closeBtn.onclick = function() {
            // ุจุฑุฑุณ ุงูฺฉู ุขุง ฺฺฉโุจุงฺฉุณโูุง ูุฌูุฏ ุฏุงุฑูุฏ ู ุขุง ููู ุชฺฉ ุฎูุฑุฏูโุงูุฏ
            const acceptButton = document.getElementById('acceptButton');
            if (acceptButton && acceptButton.disabled) {
              // ุงฺฏุฑ ุฏฺฉูู ูพุฐุฑุด ุบุฑูุนุงู ุงุณุชุ ุงุฌุงุฒู ุจุณุชู ูุฏู
              return;
            }
            closeModal();
          };
          if (understandBtn) understandBtn.onclick = closeModal;
          
          // ุจุณุชู ุจุง ฺฉูฺฉ ุฑู ุจฺฉโฺฏุฑุงูุฏ (ููุท ุงฺฏุฑ ุดุฑุงุท ูพุฐุฑูุชู ูุดุฏู ุจุงุดุฏ)
          modal.onclick = function(e) {
            if (e.target === modal) {
              // ุจุฑุฑุณ ุงูฺฉู ุขุง ฺฺฉโุจุงฺฉุณโูุง ูุฌูุฏ ุฏุงุฑูุฏ ู ุขุง ููู ุชฺฉ ุฎูุฑุฏูโุงูุฏ
              const acceptButton = document.getElementById('acceptButton');
              if (acceptButton && acceptButton.disabled) {
                // ุงฺฏุฑ ุฏฺฉูู ูพุฐุฑุด ุบุฑูุนุงู ุงุณุชุ ุงุฌุงุฒู ุจุณุชู ูุฏู
                return;
              }
              closeModal();
            }
          };
        }

        // ุจุฑุฑุณ ุชุนุฏุงุฏ ููุงุด ูพุงูพ ุขูพ ุฏุฑ ุญุงูุธู ฺฉุด
        function shouldShowWelcomeModal() {
          const showCount = localStorage.getItem('welcomeModalShowCount') || 0;
          return showCount < 3;
        }

        // ุงูุฒุงุด ุดูุงุฑูุฏู ููุงุด ูพุงูพ ุขูพ
        function incrementShowCount() {
          const currentCount = parseInt(localStorage.getItem('welcomeModalShowCount') || 0);
          localStorage.setItem('welcomeModalShowCount', currentCount + 1);
        }

        // ุชุงูุฑ ูุทุงูุนู
        let readingTimerInterval;
        let readingSeconds = 0;
        
        function startReadingTimer() {
          readingSeconds = 0;
          readingTimerInterval = setInterval(() => {
            readingSeconds++;
            const minutes = Math.floor(readingSeconds / 60);
            const seconds = readingSeconds % 60;
            const timerDisplay = document.getElementById('readingTimer');
            if (timerDisplay) {
              timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
            
            // ุจุนุฏ ุงุฒ 30 ุซุงูู ูุทุงูุนูุ ฺฺฉโุจุงฺฉุณโูุง ุฑุง ูุนุงู ฺฉู
            if (readingSeconds >= 30) {
              enableCheckboxes();
              clearInterval(readingTimerInterval);
            }
          }, 1000);
        }
        
        // ูุนุงูโุณุงุฒ ฺฺฉโุจุงฺฉุณโูุง ุจุนุฏ ุงุฒ ูุทุงูุนู
        function enableCheckboxes() {
          const condition1 = document.getElementById('condition1');
          const condition2 = document.getElementById('condition2');
          const condition3 = document.getElementById('condition3');
          const acceptButton = document.getElementById('acceptButton');
          
          if (condition1 && condition2 && condition3 && acceptButton) {
            // ูุนุงูโุณุงุฒ ฺฺฉโุจุงฺฉุณโูุง
            condition1.disabled = false;
            condition2.disabled = false;
            condition3.disabled = false;
            
            // ุชุบุฑ ูุชู ฺฺฉโุจุงฺฉุณโูุง
            const spans = document.querySelectorAll('#welcome-typewriter-content label span');
            if (spans.length >= 3) {
              spans[0].textContent = 'โ ูู ุดุฑุงุท ูพุฐุฑุด ุฑุง ูุทุงูุนู ฺฉุฑุฏู ู ูโูพุฐุฑู';
              spans[0].style.opacity = '1';
              spans[1].textContent = '๐ ูู ุฎูุงูุงู ุงุฏฺฏุฑ ุงู ุจุงุฒุงุฑ ูุณุชู';
              spans[1].style.opacity = '1';
              spans[2].textContent = '๐ ูู ุงุฒ ููุงุนุฏ ู ููุงูู ุงุฑุฒูุง ุฏุฌุชุงู ุขุดูุง ุฏุงุฑู';
              spans[2].style.opacity = '1';
            }
            
            // ุชุบุฑ ูุชู ุฏฺฉูู
            acceptButton.textContent = '๐ Enter Platform';
            acceptButton.style.background = 'linear-gradient(135deg,#00ff88,#00cc6a)';
            acceptButton.style.color = '#000';
            acceptButton.style.cursor = 'pointer';
            
            // ุชุบุฑ ูุชู ุชุงูุฑ
            const timerText = document.querySelector('#welcome-typewriter-content p strong');
            if (timerText) {
              timerText.textContent = 'โ ูุทุงูุนู ฺฉุงูู ุดุฏ!';
            }
          }
        }
        
        // ุชุงูพโุฑุงุชุฑ ูพุงูพ ุขูพ ุดุฑุงุท ู ููุงูู
        function startWelcomeTypewriter() {
          const container = document.getElementById('welcome-typewriter-content');
          if (!container) {
            console.error('Container not found');
            return;
          }
          
          console.log('Starting typewriter...');
          
          // ุดุฑูุน ุชุงูุฑ ูุทุงูุนู ุงุฒ ุงุจุชุฏุง ุชุงูพโุฑุงุชุฑ
          if (typeof startReadingTimer === 'function') {
            startReadingTimer();
          }
          
          const welcomeText = `<div style="background:rgba(255,193,7,0.08);padding:1.2em 1.4em;border-radius:12px;border-right:4px solid #ffc107;margin-bottom:1.2em;">
  <p style="margin:0;color:#e0e6f7;font-weight:500;">
    โ๏ธ <strong>Important Notice:</strong> Before entering the platform, please read and accept the following terms and conditions.
  </p>
</div>

<h3 style="color:#a786ff;font-size:1.25em;margin:0 0 0.8em 0;">ุดุฑุงุท ูพุฐุฑุด</h3>
<div style="background:rgba(0,255,136,0.05);padding:1em;border-radius:8px;border-right:3px solid #00ff88;margin-bottom:1em;">
  <p style="margin:0;color:#e0e6f7;line-height:1.6;">
    <strong>โ ูู ุดุฑุงุท ุฒุฑ ุฑุง ูโูพุฐุฑู:</strong><br>
    โข ุณุฑูุงูโฺฏุฐุงุฑ ุฏุฑ ุงุฑุฒูุง ุฏุฌุชุงู ุจุง ุฑุณฺฉ ููุฑุงู ุงุณุช<br>
    โข ุชูุงู ุชุฑุงฺฉูุดโูุง ุบุฑูุงุจู ุจุงุฒฺฏุดุช ู ุดูุงู ูุณุชูุฏ<br>
    โข ูุณุฆููุช ุชุตููุงุช ูุงู ุจุฑ ุนูุฏู ุฎูุฏู ุงุณุช<br>
    โข ููุงูู ู ููุฑุฑุงุช ูุญู ุฑุง ุฑุนุงุช ูโฺฉูู
  </p>
</div>

<h3 style="color:#a786ff;font-size:1.25em;margin:1.1em 0 0.6em 0;">ุชูุงู ุจู ุงุฏฺฏุฑ</h3>
<div style="background:rgba(138,43,226,0.05);padding:1em;border-radius:8px;border-right:3px solid #8a2be2;margin-bottom:1em;">
  <p style="margin:0;color:#e0e6f7;line-height:1.6;">
    <strong>๐ ูู ุฎูุงูุงู ุงุฏฺฏุฑ ุงู ุจุงุฒุงุฑ ูุณุชู:</strong><br>
    โข ูุทุงูุนู ูุณุชูุฑ ุฏุฑ ุฒููู ุงุฑุฒูุง ุฏุฌุชุงู<br>
    โข ุขุดูุง ุจุง ููุงูู ุจูุงฺฉฺู ู ูุฑุงุฑุฏุงุฏูุง ููุดููุฏ<br>
    โข ุงุฏฺฏุฑ ูุฏุฑุช ุฑุณฺฉ ู ุณุฑูุงู<br>
    
  </p>
</div>

<h3 style="color:#a786ff;font-size:1.25em;margin:1.1em 0 0.6em 0;">ุขุดูุง ุจุง ููุงุนุฏ ุงุฑุฒูุง ุฏุฌุชุงู</h3>
<div style="background:rgba(255,69,0,0.05);padding:1em;border-radius:8px;border-right:3px solid #ff4500;margin-bottom:1em;">
  <p style="margin:0;color:#e0e6f7;line-height:1.6;">
    <strong>๐ ูู ุงุฒ ููุงุนุฏ ู ููุงูู ุงุฑุฒูุง ุฏุฌุชุงู ุขุดูุง ุฏุงุฑู:</strong><br>
    โข ูุญูู ฺฉุงุฑฺฉุฑุฏ ฺฉู ูพููโูุง ุฏุฌุชุงู<br>
    โข ุงุตูู ุงููุช ู ุญูุงุธุช ุงุฒ ฺฉูุฏูุง ุฎุตูุต<br>
    โข ุขุดูุง ุจุง ุดุจฺฉูโูุง ูุฎุชูู (ุงุชุฑููุ ูพุงูฺฏุงู)<br>
    โข ุฏุฑฺฉ ููุงูู ฺฏุณ (Gas) ู ุชุงุฏ ุชุฑุงฺฉูุดโูุง
  </p>
</div>

<h3 style="color:#a786ff;font-size:1.25em;margin:1.1em 0 0.6em 0;">ูุดุฎุตุงุช ูุฑุงุฑุฏุงุฏ ููุดููุฏ</h3>
<p style="margin-top:0;">
  <strong>ุขุฏุฑุณ ูุฑุงุฑุฏุงุฏ:</strong> 0xA3d5445e3e57dDA57C69184e88A93C9f6f7f9aA6<br>
  <strong>ุดุจฺฉู:</strong> Polygon (MATIC)<br>
  <strong>ุงุณุชุงูุฏุงุฑุฏ:</strong> ERC-20<br>
  <strong>ูุงู ุชูฺฉู:</strong> IAM Token<br>
  <strong>ููุงุฏ:</strong> IAM<br>
  <strong>ุชุนุฏุงุฏ ุงุนุดุงุฑ:</strong> 18
</p>

<h3 style="color:#a786ff;font-size:1.25em;margin:1.1em 0 0.6em 0;">ุชูุงุจุน ุงุตู ูุฑุงุฑุฏุงุฏ</h3>
<ul style="list-style:none;padding:0;margin:0;">
  <li style="margin-bottom:0.65em;padding-right:1.5em;position:relative;">
    <span style="position:absolute;right:0;color:#00ff88;">๐น</span>
    <strong>register()</strong> - ุซุจุชโูุงู ฺฉุงุฑุจุฑ ุฌุฏุฏ
  </li>
  <li style="margin-bottom:0.65em;padding-right:1.5em;position:relative;">
    <span style="position:absolute;right:0;color:#00ff88;">๐น</span>
    <strong>transfer()</strong> - ุงูุชูุงู ุชูฺฉู ุจู ฺฉู ูพููโูุง
  </li>
  <li style="margin-bottom:0.65em;padding-right:1.5em;position:relative;">
    <span style="position:absolute;right:0;color:#00ff88;">๐น</span>
    <strong>getTokenPrice()</strong> - Get current token price
  </li>
  <li style="margin-bottom:0.65em;padding-right:1.5em;position:relative;">
    <span style="position:absolute;right:0;color:#00ff88;">๐น</span>
    <strong>getPointValue()</strong> - Get value of each point
  </li>
  <li style="margin-bottom:0.65em;padding-right:1.5em;position:relative;">
    <span style="position:absolute;right:0;color:#00ff88;">๐น</span>
    <strong>buyTokens()</strong> - ุฎุฑุฏ ุชูฺฉู ุจุง DAI
  </li>
  <li style="margin-bottom:0.65em;padding-right:1.5em;position:relative;">
    <span style="position:absolute;right:0;color:#00ff88;">๐น</span>
    <strong>sellTokens()</strong> - Sell tokens and receive DAI
  </li>
</ul>

<h3 style="color:#a786ff;font-size:1.25em;margin:1.1em 0 0.6em 0;">ุณุงุฎุชุงุฑ ุฏุงุฏูโูุง</h3>
<p style="margin-top:0;">
  <strong>User Struct:</strong><br>
  - address: ุขุฏุฑุณ ฺฉู ูพูู ฺฉุงุฑุจุฑ<br>
  - uint256 index: ุดูุงุฑู ุงูุฏฺฉุณ ฺฉุงุฑุจุฑ<br>
  - bool activated: ูุถุนุช ูุนุงู ุจูุฏู<br>
  - uint256 registrationTime: ุฒูุงู ุซุจุชโูุงู<br>
  - address referrer: ูุนุฑู ฺฉุงุฑุจุฑ<br>
  - uint256 totalPoints: ฺฉู ูพููุชโูุง ฺฉุณุจ ุดุฏู
</p>

<h3 style="color:#a786ff;font-size:1.25em;margin:1.1em 0 0.6em 0;">ูุชุบุฑูุง ููู</h3>
<ul style="list-style:none;padding:0;margin:0;">
  <li style="margin-bottom:0.65em;padding-right:1.5em;position:relative;">
    <span style="position:absolute;right:0;color:#00ff88;">โ</span>
    <strong>totalSupply:</strong> ฺฉู ุนุฑุถู ุชูฺฉู IAM
  </li>
  <li style="margin-bottom:0.65em;padding-right:1.5em;position:relative;">
    <span style="position:absolute;right:0;color:#00ff88;">โ</span>
    <strong>registrationPrice:</strong> ููุช ุซุจุชโูุงู (ุจู IAM)
  </li>
  <li style="margin-bottom:0.65em;padding-right:1.5em;position:relative;">
    <span style="position:absolute;right:0;color:#00ff88;">โ</span>
    <strong>tokenPrice:</strong> ููุช ูุนู ุชูฺฉู (ุจู DAI)
  </li>
  <li style="margin-bottom:0.65em;padding-right:1.5em;position:relative;">
    <span style="position:absolute;right:0;color:#00ff88;">โ</span>
    <strong>pointValue:</strong> ุงุฑุฒุด ูุฑ ูพููุช (ุจู IAM)
  </li>
</ul>

<div style="margin-top:1.2em;background:rgba(167,134,255,0.08);padding:1em;border-radius:10px;border-right:4px solid #a786ff;">
  <p style="margin:0;">ุชูุงู ุชุฑุงฺฉูุดโูุง ุฏุฑ <strong>PolygonScan</strong> ูุงุจู ุฑุฏุงุจ ูุณุชูุฏ ู ฺฉุฏ ูุฑุงุฑุฏุงุฏ <strong>ุจุงุฒ ู ูุงุจู ุจุฑุฑุณ</strong> ุงุณุช.</p>
</div>`;
          
          let i = 0;
          const speed = 15; // ุณุฑุนุช ุชุงูพโุฑุงุชุฑ (ููโุซุงูู)
          
          function typeWriter() {
            if (i < welcomeText.length) {
              let char = welcomeText.charAt(i);
              
              // ุงฺฏุฑ ฺฉุงุฑุงฺฉุชุฑ < ุจุงุดุฏุ ฺฉู ุชฺฏ HTML ุฑุง ฺฉุฌุง ุงุถุงูู ฺฉู
              if (char === '<') {
                let tagEnd = welcomeText.indexOf('>', i);
                if (tagEnd !== -1) {
                  container.innerHTML += welcomeText.substring(i, tagEnd + 1);
                  i = tagEnd + 1;
                  // auto-scroll as content grows
                  container.scrollTop = container.scrollHeight;
                  setTimeout(typeWriter, 5); // ุชฺฏโูุง ุณุฑุน ุงุถุงูู ุดููุฏ
                  return;
                }
              }
              
              container.innerHTML += char;
              i++;
              // auto-scroll as content grows
              container.scrollTop = container.scrollHeight;
              const delay = (char === '.' || char === '!' || char === 'ุ' || char === 'ุ') ? speed * 3 : speed;
              setTimeout(typeWriter, delay);
            } else {
              // ุชุงูพโุฑุงุชุฑ ุชูุงู ุดุฏุ ุญุงูุง ฺฺฉโุจุงฺฉุณโูุง ุฑุง ููุงุด ุจุฏู
              if (typeof showCheckboxes === 'function') {
                showCheckboxes();
              }
            }
          }
          
          typeWriter();
        }
        
        // ุชุงุจุน ุชุณุช ุจุฑุง ุชุงูพโุฑุงุชุฑ
        function testTypewriter() {
          console.log('Testing typewriter...');
          const container = document.getElementById('welcome-typewriter-content');
          if (container) {
            container.innerHTML = 'ุชุณุช ุชุงูพโุฑุงุชุฑ...';
            setTimeout(() => {
              startWelcomeTypewriter();
            }, 1000);
          }
        }

        // ููุงุด ฺฺฉโุจุงฺฉุณโูุง ุดุฑุงุท
        function showCheckboxes() {
          const container = document.getElementById('welcome-typewriter-content');
          if (!container) return;

          const checkboxesHTML = `
            <div style="margin-top:2em;background:rgba(255,193,7,0.1);padding:1.5em;border-radius:12px;border:2px solid #ffc107;">
              <h3 style="color:#ffc107;margin-bottom:1em;text-align:center;">โ ุชุงุฏ ุดุฑุงุท ู ููุงูู</h3>
              
              <div style="margin-bottom:1em;">
                <label style="display:flex;align-items:center;cursor:pointer;color:#e0e6f7;">
                  <input type="checkbox" id="condition1" style="margin-left:0.5em;transform:scale(1.2);" onchange="checkAllConditions()" disabled>
                  <span style="opacity:0.6;">โณ ูู ุดุฑุงุท ูพุฐุฑุด ุฑุง ูุทุงูุนู ฺฉุฑุฏู ู ูโูพุฐุฑู</span>
                </label>
              </div>
              
              <div style="margin-bottom:1em;">
                <label style="display:flex;align-items:center;cursor:pointer;color:#e0e6f7;">
                  <input type="checkbox" id="condition2" style="margin-left:0.5em;transform:scale(1.2);" onchange="checkAllConditions()" disabled>
                  <span style="opacity:0.6;">โณ ูู ุฎูุงูุงู ุงุฏฺฏุฑ ุงู ุจุงุฒุงุฑ ูุณุชู</span>
                </label>
              </div>
              
              <div style="margin-bottom:1em;">
                <label style="display:flex;align-items:center;cursor:pointer;color:#e0e6f7;">
                  <input type="checkbox" id="condition3" style="margin-left:0.5em;transform:scale(1.2);" onchange="checkAllConditions()" disabled>
                  <span style="opacity:0.6;">โณ ูู ุงุฒ ููุงุนุฏ ู ููุงูู ุงุฑุฒูุง ุฏุฌุชุงู ุขุดูุง ุฏุงุฑู</span>
                </label>
              </div>
              
              <div style="text-align:center;margin-top:1.5em;">
                <button id="acceptButton" onclick="acceptConditions()" style="background:linear-gradient(135deg,#666,#444);color:#999;border:none;padding:0.8em 2em;border-radius:8px;font-weight:bold;cursor:not-allowed;opacity:0.5;pointer-events:none;" disabled>
                  โณ ูุทูุงู ุงุจุชุฏุง ููุงุฏ ุฑุง ูุทุงูุนู ฺฉูุฏ
                </button>
              </div>
            </div>
          `;
          
          container.innerHTML += checkboxesHTML;
          container.scrollTop = container.scrollHeight;
        }

        // ุชุงูุฑ ูุทุงูุนู
        // ุชฺฉุฑุงุฑ ุญุฐู ุดุฏ
        
        function startReadingTimer() {
          readingSeconds = 0;
          readingTimerInterval = setInterval(() => {
            readingSeconds++;
            const minutes = Math.floor(readingSeconds / 60);
            const seconds = readingSeconds % 60;
            const timerDisplay = document.getElementById('readingTimer');
            if (timerDisplay) {
              timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
            
            // ุจุนุฏ ุงุฒ 30 ุซุงูู ูุทุงูุนูุ ฺฺฉโุจุงฺฉุณโูุง ุฑุง ูุนุงู ฺฉู
            if (readingSeconds >= 30) {
              enableCheckboxes();
              clearInterval(readingTimerInterval);
            }
          }, 1000);
        }
        
        // ูุนุงูโุณุงุฒ ฺฺฉโุจุงฺฉุณโูุง ุจุนุฏ ุงุฒ ูุทุงูุนู
        function enableCheckboxes() {
          const condition1 = document.getElementById('condition1');
          const condition2 = document.getElementById('condition2');
          const condition3 = document.getElementById('condition3');
          const acceptButton = document.getElementById('acceptButton');
          
          if (condition1 && condition2 && condition3 && acceptButton) {
            // ูุนุงูโุณุงุฒ ฺฺฉโุจุงฺฉุณโูุง
            condition1.disabled = false;
            condition2.disabled = false;
            condition3.disabled = false;
            
            // ุชุบุฑ ูุชู ฺฺฉโุจุงฺฉุณโูุง
            const spans = document.querySelectorAll('#welcome-typewriter-content label span');
            if (spans.length >= 3) {
              spans[0].textContent = 'โ ูู ุดุฑุงุท ูพุฐุฑุด ุฑุง ูุทุงูุนู ฺฉุฑุฏู ู ูโูพุฐุฑู';
              spans[0].style.opacity = '1';
              spans[1].textContent = '๐ ูู ุฎูุงูุงู ุงุฏฺฏุฑ ุงู ุจุงุฒุงุฑ ูุณุชู';
              spans[1].style.opacity = '1';
              spans[2].textContent = '๐ ูู ุงุฒ ููุงุนุฏ ู ููุงูู ุงุฑุฒูุง ุฏุฌุชุงู ุขุดูุง ุฏุงุฑู';
              spans[2].style.opacity = '1';
            }
            
            // ุชุบุฑ ูุชู ุฏฺฉูู
            acceptButton.textContent = '๐ Enter Platform';
            acceptButton.style.background = 'linear-gradient(135deg,#00ff88,#00cc6a)';
            acceptButton.style.color = '#000';
            acceptButton.style.cursor = 'pointer';
            
            // ุชุบุฑ ูุชู ุชุงูุฑ
            const timerText = document.querySelector('#welcome-typewriter-content p strong');
            if (timerText) {
              timerText.textContent = 'โ ูุทุงูุนู ฺฉุงูู ุดุฏ!';
            }
          }
        }
        
        // ุจุฑุฑุณ ูุถุนุช ุชูุงู ฺฺฉโุจุงฺฉุณโูุง
        function checkAllConditions() {
          const condition1 = document.getElementById('condition1');
          const condition2 = document.getElementById('condition2');
          const condition3 = document.getElementById('condition3');
          const acceptButton = document.getElementById('acceptButton');
          
          if (condition1 && condition2 && condition3 && acceptButton) {
            if (condition1.checked && condition2.checked && condition3.checked) {
              acceptButton.style.opacity = '1';
              acceptButton.style.pointerEvents = 'auto';
              acceptButton.disabled = false;
            } else {
              acceptButton.style.opacity = '0.5';
              acceptButton.style.pointerEvents = 'none';
              acceptButton.disabled = true;
            }
          }
        }

        // Accept terms and enter platform
        function acceptConditions() {
          // Stop timer
          if (readingTimerInterval) {
            clearInterval(readingTimerInterval);
          }
          incrementShowCount();
          closeWelcomeModal();
        }
        
        
        const text = `The IAM Continuous Profit Academy is an innovative, people-centric ecosystem established to provide fully decentralized and transparent financial, educational, and trading services. In this collection, your capital always remains under your control, whether in your personal exchange account, with a broker, or in a smart wallet connected to a decentralized contract.

Our Services:
โข Providing specialized signals and auto-trading robots for financial markets
โข Opportunity to act as an agent for individuals and IBs in brokerages
โข Network marketing opportunities for friends who want to promote this collection
โข You can benefit from Referral Shares.
โข You can also achieve guaranteed profit by investing in the IAM fund and its incremental token.
โข Comprehensive Forex and Cryptocurrency training
โข Support for the decentralized IAM fund and IAM token
โข Copy-trading services: If the IAM robot profits, you profit, and if it incurs a loss, you also incur a loss; no profit is withdrawn from your account during a loss, and IAM receives no share until the loss is recovered.
โข Our motto: Your capital in your own account, your profit with us.`;
        const container = document.getElementById('IAM-typewriter');
        if (container) {
          let i = 0;
          const speed = 40; // ms per character (slower)
          function typeWriter() {
            if (i < text.length) {
              const char = text.charAt(i);
              if (char === '\\n' || char === '\n') {
                container.innerHTML += '<br>';
                i++;
                setTimeout(typeWriter, 350);
              } else {
                container.innerHTML += char;
                i++;
                setTimeout(typeWriter, speed);
              }
            }
          }
          typeWriter();
        }

        // Expand/collapse logic
        const wrapper = document.getElementById('IAM-typewriter-wrapper');
        const fade = document.getElementById('IAM-fade');
        const btn = document.getElementById('IAM-expand-btn');
        if (wrapper && fade && btn) {
          let expanded = false;
          btn.addEventListener('click', function() {
            expanded = !expanded;
            if (expanded) {
              wrapper.style.maxHeight = '2000px';
              fade.style.opacity = '0';
              btn.textContent = 'ููุงุด ฺฉูุชุฑ';
            } else {
              wrapper.style.maxHeight = '2.1em';
              fade.style.opacity = '1';
              btn.textContent = 'ููุงุด ุจุดุชุฑ';
            }
          });
        }
      });
      </script>

  <!-- Swap Section -->
  <div id="main-swap" class="page-section expandable-container" style="width:100vw;max-width:none;margin:0;left:0;right:0;padding:0.5rem 0;">
    
    <div id="swap-main-content" style="display:block;">
    <div class="expand-header" style="padding:0 1.5rem;">
      <h2 style="margin:0 0 0.5rem 0;">๐ ุชุจุฏู ุงุฑุฒ</h2>
      <p style="margin:0 0 0.5rem 0;">ุชุจุฏู ุจู ุชูฺฉูโูุง DAI ู IAM</p>
    </div>
    <div class="expand-content" style="padding:0;">
      <div class="swap-container" style="max-width:600px;margin:0 auto;padding:1.5rem;">
        
        <!-- Swap Rules and Information -->
        <div class="swap-rules" style="background:linear-gradient(135deg,#232946,#181c2a);border-radius:12px;padding:1.5rem;margin-bottom:1.5rem;border:2px solid #00ff88;">
          <h3 style="color:#00ff88;margin-bottom:1rem;font-size:1.2rem;">๐ ููุงูู ู ุฑุงูููุง ุชุจุฏู</h3>
          
          <div style="margin-bottom:1rem;">
            <h4 style="color:#00ff88;margin-bottom:0.5rem;">๐ ูุญูู ุชุจุฏู:</h4>
            <ul style="color:#b8c1ec;line-height:1.6;margin:0;padding-right:1rem;">
              <li>โ <strong style="color:#00ff88;">DAI โ IAM:</strong> ุฎุฑุฏ ุชูฺฉู IAM ุจุง DAI (ูุฑุฎ ูุชุบุฑ)</li>
              <li>โ <strong style="color:#00ff88;">IAM โ DAI:</strong> Sell IAM tokens and receive DAI</li>
              <li>โ ฺฉุงุฑูุฒุฏ ุชุจุฏู: ูพูุง (ฒูชุ ฒ.ตูช ุง ณูช ุจุฑ ุงุณุงุณ ููุฌูุฏ DAI ูุฑุงุฑุฏุงุฏ)</li>
              <li>โ ุญุฏุงูู ููุฏุงุฑ ุชุจุฏู: ุจุด ุงุฒ 1 DAI ุง ุจุด ุงุฒ 1 IAM</li>
            </ul>
          </div>
          
          <div style="margin-bottom:1rem;">
            <h4 style="color:#00ff88;margin-bottom:0.5rem;">๐ฐ ูุฒุงุง ุชุจุฏู:</h4>
            <ul style="color:#b8c1ec;line-height:1.6;margin:0;padding-right:1rem;">
              <li><strong style="color:#00ff88;">IAM:</strong> ุชูฺฉู ุงุตู ูพูุชูุฑู - ุจุฑุง ุณุฑูุงูโฺฏุฐุงุฑ ู ฺฉุณุจ ุฏุฑุขูุฏ</li>
              <li><strong style="color:#00ccff;">DAI:</strong> ุชูฺฉู ุงุณุชุจู - ุจุฑุง ุญูุธ ุงุฑุฒุด ู ูุนุงููุงุช ุฑูุฒุงูู</li>
              <li>๐ ุชุจุฏู ููุฑ ู ุจุฏูู ูุงุฒ ุจู ุชุงุฏ ุงุถุงู</li>
              <li>๐ ูุฑุฎ ุชุจุฏู ุจุฑ ุงุณุงุณ ุนุฑุถู ู ุชูุงุถุง ูุญุงุณุจู ูโุดูุฏ</li>
            </ul>
          </div>
          
          <div>
            <h4 style="color:#00ff88;margin-bottom:0.5rem;">โ๏ธ ูฺฉุงุช ููู:</h4>
            <ul style="color:#b8c1ec;line-height:1.6;margin:0;padding-right:1rem;">
              <li>๐ ูุจู ุงุฒ ุชุจุฏูุ ูุฑุฎ ูุนู ุฑุง ุจุฑุฑุณ ฺฉูุฏ</li>
              <li>๐ฐ ููุฌูุฏ ฺฉุงู ุจุฑุง ุชุจุฏู + ฺฉุงุฑูุฒุฏ ุฏุงุดุชู ุจุงุดุฏ</li>
              <li>โฑ๏ธ ุชุจุฏูโูุง ููุฑ ุงูุฌุงู ูโุดููุฏ</li>
              <li>๐ ุฏุฑ ุตูุฑุช ูุดฺฉู ุจุง ูพุดุชุจุงู ุชูุงุณ ุจฺฏุฑุฏ</li>
            </ul>
          </div>
        </div>
        <!-- Blockchain Information Dashboard (added to prevent not found errors) -->

        <form id="swapForm" class="swap-form">
          <div class="swap-row">
            <label for="swapDirection">ููุน ุชุจุฏู:</label>
            <select id="swapDirection" required>
              <option value="dai-to-IAM">DAI โ IAM</option>
              <option value="IAM-to-dai">IAM โ DAI</option>
            </select>
            <small style="color:#b8c1ec;font-size:0.85rem;margin-top:0.3rem;display:block;">ููุน ุชุจุฏู ููุฑุฏ ูุธุฑ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ</small>
          </div>
          
          <div class="swap-row">
            <label for="swapAmount">ููุฏุงุฑ:</label>
            <div class="amount-input-group">
              <input type="number" id="swapAmount" placeholder="ููุฏุงุฑ ุฑุง ูุงุฑุฏ ฺฉูุฏ" min="0" step="any" required>
              <button type="button" id="maxBtn" class="max-btn">ุญุฏุงฺฉุซุฑ</button>
            </div>
            <small style="color:#b8c1ec;font-size:0.85rem;margin-top:0.3rem;display:block;">ููุฏุงุฑ ููุฑุฏ ูุธุฑ ุจุฑุง ุชุจุฏู ุฑุง ูุงุฑุฏ ฺฉูุฏ</small>
          </div>
          
          <div class="swap-row" id="swap-usd-converter-row" style="display:none;">
            <label for="swapUsdAmount">๐ฐ ูุนุงุฏู ุฏูุงุฑ:</label>
            <div class="usd-converter-container" style="display:flex;gap:0.5rem;align-items:center;">
              <span style="color:#00ff88;font-weight:bold;">$</span>
              <input type="number" id="swapUsdAmount" placeholder="5.00" min="0" step="0.01" style="flex:1;">
              <button type="button" id="swapUsdToTokenBtn" style="
                background: linear-gradient(90deg,#00ff88,#a786ff);
                color: #181c2a;
                border: none;
                border-radius: 6px;
                padding: 0.4rem 0.8rem;
                font-size: 0.8rem;
                cursor: pointer;
                transition: all 0.3s ease;
                font-weight: bold;
              ">๐ ุชุจุฏู</button>
            </div>
            <small style="color:#b8c1ec;font-size:0.85rem;margin-top:0.3rem;display:block;">ููุฏุงุฑ ุฏูุงุฑ ูุงุฑุฏ ฺฉูุฏ ุชุง ุจู ุชูฺฉู ุชุจุฏู ุดูุฏ (ูุซู: 5 ุจุฑุง $5)</small>
          </div>
          
          <div id="swapRate" class="swap-rate">Exchange rate: Loading...</div>
          <div id="swapPreview" class="swap-preview"></div>
          <div id="swapLimitInfo" class="swap-limit-info" style="margin-top:0.5rem;color:#555;font-size:0.98em;"></div>
          
          <button type="submit" class="swap-btn">ุชุจุฏู</button>
          <div id="swapStatus" class="swap-status"></div>
        </form>
        
        <!-- Balance Check -->
        <div class="swap-balance-check" style="background:rgba(0,255,136,0.1);border-radius:8px;padding:1rem;margin-top:1.5rem;">
          <h4 style="color:#00ff88;margin-bottom:0.8rem;">๐ฐ ููุฌูุฏ ูุนู ุดูุง:</h4>
          <div class="swap-balance-grid" style="display:grid;grid-template-columns:1fr 1fr;gap:1rem;">
            <div style="text-align:center;">
              <div style="color:#00ff88;font-weight:bold;">DAI</div>
              <div id="daiBalance" style="color:#b8c1ec;font-family:monospace;">-</div>
            </div>
            <div style="text-align:center;">
              <div style="color:#00ccff;font-weight:bold;">IAM</div>
              <div id="IAMBalance" style="color:#b8c1ec;font-family:monospace;">-</div>
              <div id="IAMUsdValue" style="color:#a786ff;font-size:0.8rem;margin-top:2px;">-</div>
            </div>
          </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Transfer Section -->
  <div id="main-transfer" class="page-section expandable-container" style="width:100vw;max-width:none;margin:0;left:0;right:0;padding:0.5rem 0;display:none;">
    <div class="expand-header">
      <h2 style="margin:0 0 0.5rem 0;">๐ธ ุชุฑุงูุณูุฑ</h2>
      <p style="margin:0 0 0.5rem 0;">ุงูุชูุงู ุชูฺฉู ุจู ฺฉู ูพูู ุฏฺฏุฑ</p>
    </div>
    <div class="expand-content" style="padding:0;">
      <div class="transfer-container" style="max-width:600px;margin:0;padding:1.5rem;">
        
        <!-- Transfer Rules and Information -->
        <div class="transfer-rules" style="background:linear-gradient(135deg,#232946,#181c2a);border-radius:12px;padding:1.5rem;margin-bottom:1.5rem;border:2px solid #a786ff;">
          <h3 style="color:#00ff88;margin-bottom:1rem;font-size:1.2rem;">๐ ููุงูู ู ุฑุงูููุง ุงูุชูุงู</h3>
          
          <div style="margin-bottom:1rem;">
            <h4 style="color:#a786ff;margin-bottom:0.5rem;">๐ ุงููุช ุงูุชูุงู:</h4>
            <ul style="color:#b8c1ec;line-height:1.6;margin:0;padding-right:1rem;">
              <li>โ ุงูุชูุงูโูุง ุบุฑูุงุจู ุจุงุฒฺฏุดุช ูุณุชูุฏ - ูุจู ุงุฒ ุงุฑุณุงู ุฏูุจุงุฑู ุจุฑุฑุณ ฺฉูุฏ</li>
              <li>โ ุขุฏุฑุณ ููุตุฏ ุฑุง ุจุง ุฏูุช ูุงุฑุฏ ฺฉูุฏ - ฺฉ ฺฉุงุฑุงฺฉุชุฑ ุงุดุชุจุงู ุจุงุนุซ ุงุฒ ุฏุณุช ุฑูุชู ุฏุงุฑุง ูโุดูุฏ</li>
              <li>โ ุงุจุชุฏุง ููุฏุงุฑ ฺฉู ุงุฑุณุงู ฺฉูุฏ ุชุง ุงุฒ ุตุญุช ุขุฏุฑุณ ูุทูุฆู ุดูุฏ</li>
              <li>โ ุงุฒ ฺฉู ูพููโูุง ูุนุชุจุฑ ู ุงูู ุงุณุชูุงุฏู ฺฉูุฏ</li>
            </ul>
          </div>
          
          <div style="margin-bottom:1rem;">
            <h4 style="color:#a786ff;margin-bottom:0.5rem;">๐ฐ ุงููุงุน ุชูฺฉู ูุงุจู ุงูุชูุงู:</h4>
            <ul style="color:#b8c1ec;line-height:1.6;margin:0;padding-right:1rem;">
              <li><strong style="color:#00ff88;">DAI:</strong> ุชูฺฉู ุงุณุชุจู ุจุง ุงุฑุฒุด 1 ุฏูุงุฑ - ุจุฑุง ูุนุงููุงุช ุฑูุฒุงูู</li>
              <li><strong style="color:#a786ff;">POL (MATIC):</strong> ุชูฺฉู ุดุจฺฉู Polygon - ุจุฑุง ูพุฑุฏุงุฎุช ฺฉุงุฑูุฒุฏ ุชุฑุงฺฉูุดโูุง</li>
              <li><strong style="color:#00ccff;">IAM:</strong> ุชูฺฉู ุงุตู ูพูุชูุฑู - ุจุฑุง ุณุฑูุงูโฺฏุฐุงุฑ ู ฺฉุณุจ ุฏุฑุขูุฏ</li>
            </ul>
          </div>
          
          <div style="margin-bottom:1rem;">
            <h4 style="color:#a786ff;margin-bottom:0.5rem;">โก ฺฉุงุฑูุฒุฏ ุชุฑุงฺฉูุด:</h4>
            <ul style="color:#b8c1ec;line-height:1.6;margin:0;padding-right:1rem;">
              <li>๐ธ ฺฉุงุฑูุฒุฏ ุดุจฺฉู Polygon: ~0.001-0.01 MATIC (ุจุณุชู ุจู ุชุฑุงูฺฉ ุดุจฺฉู)</li>
              <li>โฑ๏ธ ุฒูุงู ุชุงุฏ: 2-5 ุซุงูู (ูุนูููุงู)</li>
              <li>๐ ุชุฑุงฺฉูุดโูุง ุฏุฑ PolygonScan ูุงุจู ุฑุฏุงุจ ูุณุชูุฏ</li>
            </ul>
          </div>
          
          <div>
            <h4 style="color:#a786ff;margin-bottom:0.5rem;">๐ฏ ูฺฉุงุช ููู:</h4>
            <ul style="color:#b8c1ec;line-height:1.6;margin:0;padding-right:1rem;">
              <li>๐ฑ ูโุชูุงูุฏ ุจุง ุงูุฏฺฉุณ ฺฉุงุฑุจุฑ ุฌุณุชุฌู ฺฉูุฏ ุชุง ุขุฏุฑุณ ุฑุง ูพุฏุง ฺฉูุฏ</li>
              <li>๐ ูุจู ุงุฒ ุงูุชูุงูุ ููุฌูุฏ ุฎูุฏ ุฑุง ุจุฑุฑุณ ฺฉูุฏ</li>
              <li>โ๏ธ ููุฏุงุฑ ุงูุชูุงู + ฺฉุงุฑูุฒุฏ ุดุจฺฉู ุจุงุฏ ฺฉูุชุฑ ุงุฒ ููุฌูุฏ ุจุงุดุฏ</li>
              <li>๐ ุฏุฑ ุตูุฑุช ูุดฺฉู ุจุง ูพุดุชุจุงู ุชูุงุณ ุจฺฏุฑุฏ</li>
            </ul>
          </div>
        </div>
        
        <form id="transferForm" class="transfer-form">
          <div class="transfer-row">
            <label for="transferTo">ุขุฏุฑุณ ููุตุฏ:</label>
            <input type="text" id="transferTo" placeholder="0x..." required style="direction:ltr;">
            <small style="color:#b8c1ec;font-size:0.85rem;margin-top:0.3rem;display:block;">ุขุฏุฑุณ ฺฉู ูพูู ููุตุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ (42 ฺฉุงุฑุงฺฉุชุฑ)</small>
          </div>
          <div class="transfer-row" style="margin-bottom:0.5rem;">
            <label for="searchIndex">ุฌุณุชุฌู ุจุง ุงูุฏฺฉุณ:</label>
            <div class="search-index-container" style="display:flex;gap:0.5rem;align-items:center;">
              <input type="number" id="searchIndex" placeholder="ุงูุฏฺฉุณ ฺฉุงุฑุจุฑ" min="0" style="width:120px;direction:ltr;">
              <button type="button" id="searchIndexBtn" class="transfer-btn" style="padding:0.5rem 1.2rem;font-size:1rem;min-width:80px;">ุฌุณุชุฌู</button>
            </div>
            <div id="searchIndexStatus" class="transfer-status" style="margin-top:0.3rem;"></div>
            <small style="color:#b8c1ec;font-size:0.85rem;margin-top:0.3rem;display:block;">ุงูุฏฺฉุณ ฺฉุงุฑุจุฑ ุฑุง ูุงุฑุฏ ฺฉูุฏ ุชุง ุขุฏุฑุณ ุจู ุทูุฑ ุฎูุฏฺฉุงุฑ ูพุฑ ุดูุฏ</small>
          </div>
          <div class="transfer-row">
            <label for="transferAmount">ููุฏุงุฑ:</label>
            <input type="number" id="transferAmount" placeholder="ููุฏุงุฑ ุฑุง ูุงุฑุฏ ฺฉูุฏ" min="0" step="any" required>
            <button type="button" id="maxAmountBtn" style="
              background: linear-gradient(90deg,#ff6b6b,#ee5a52);
              color: #fff;
              border: none;
              border-radius: 6px;
              padding: 0.4rem 0.8rem;
              font-size: 0.8rem;
              cursor: pointer;
              margin-top: 0.5rem;
              transition: all 0.3s ease;
              width: auto;
              display: inline-block;
            ">๐ฅ ุญุฏุงฺฉุซุฑ ููุฌูุฏ</button>
            <small style="color:#b8c1ec;font-size:0.85rem;margin-top:0.3rem;display:block;">ููุฏุงุฑ ุงูุชูุงู ุฑุง ูุงุฑุฏ ฺฉูุฏ ุง ุฑู "ุญุฏุงฺฉุซุฑ" ฺฉูฺฉ ฺฉูุฏ</small>
          </div>
          <div class="transfer-row" id="usd-converter-row" style="display:none;">
            <label for="transferUsdAmount">๐ฐ ูุนุงุฏู ุฏูุงุฑ (ููุท ุจุฑุง IAM):</label>
            <div class="usd-converter-container" style="display:flex;gap:0.5rem;align-items:center;">
              <span style="color:#00ff88;font-weight:bold;">$</span>
              <input type="number" id="transferUsdAmount" placeholder="5.00" min="0" step="0.01" style="flex:1;">
              <button type="button" id="usdToIAMBtn" style="
                background: linear-gradient(90deg,#00ff88,#a786ff);
                color: #181c2a;
                border: none;
                border-radius: 6px;
                padding: 0.4rem 0.8rem;
                font-size: 0.8rem;
                cursor: pointer;
                transition: all 0.3s ease;
                font-weight: bold;
              ">๐ ุชุจุฏู</button>
            </div>
            <small style="color:#b8c1ec;font-size:0.85rem;margin-top:0.3rem;display:block;">ููุฏุงุฑ ุฏูุงุฑ ูุงุฑุฏ ฺฉูุฏ ุชุง ุจู IAM ุชุจุฏู ุดูุฏ (ูุซู: 5 ุจุฑุง $5)</small>
          </div>
          <div class="transfer-row">
            <label for="transferToken">ููุน ุชูฺฉู:</label>
            <select id="transferToken" required>
              <option value="dai" selected>DAI</option>
              <option value="pol">POL</option>
              <option value="IAM">IAM</option>
            </select>
            <small style="color:#b8c1ec;font-size:0.85rem;margin-top:0.3rem;display:block;">ููุน ุชูฺฉู ููุฑุฏ ูุธุฑ ุจุฑุง ุงูุชูุงู ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ</small>
          </div>
          
          <!-- Balance Check -->
          <div style="background:rgba(167,134,255,0.1);border-radius:8px;padding:1rem;margin-bottom:1rem;" class="balance-check">
            <h4 style="color:#a786ff;margin-bottom:0.8rem;">๐ฐ ููุฌูุฏ ูุนู ุดูุง:</h4>
            <div class="balance-check-grid" style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:1rem;">
              <div style="text-align:center;">
                <div style="color:#00ff88;font-weight:bold;">DAI</div>
                <div id="transfer-dai-balance" style="color:#b8c1ec;font-family:monospace;">-</div>
              </div>
              <div style="text-align:center;">
                <div style="color:#a786ff;font-weight:bold;">POL</div>
                <div id="transfer-poly-balance" style="color:#b8c1ec;font-family:monospace;">-</div>
              </div>
              <div style="text-align:center;">
                <div style="color:#00ccff;font-weight:bold;">IAM</div>
                <div id="transfer-IAM-balance" style="color:#b8c1ec;font-family:monospace;">-</div>
                <div id="transfer-IAM-usd" style="color:#a786ff;font-size:0.8rem;margin-top:2px;">-</div>
              </div>
            </div>
          </div>
          
          <button type="submit" class="transfer-btn">ุงูุชูุงู</button>
          <div id="transferStatus" class="transfer-status"></div>
        </form>
      </div>
    </div>
  </div>

  




    
    <script src="js/smooth-value-updater.js"></script>
    <script src="js/smart-dashboard-updater.js"></script>
    <script src="js/central-dashboard-updater.js"></script>
    <script src="js/test-address-config.js"></script>
    <script src="js/config.js"></script>
    <script>
      // ุจุฑุฑุณ ููุฏ ุดุฏู config.js
      console.log('๐ ุจุฑุฑุณ ููุฏ ุดุฏู config.js...');
      setTimeout(() => {
        console.log('displayTopUsersRanking ููุฌูุฏ:', typeof window.displayTopUsersRanking);
        console.log('voteForIndex ููุฌูุฏ:', typeof window.voteForIndex);
        if (typeof window.displayTopUsersRanking !== 'function') {
          console.error('โ config.js ุฏุฑุณุช ููุฏ ูุดุฏู ุงุณุช!');
        } else {
          console.log('โ config.js ุจุง ููููุช ููุฏ ุดุฏ');
        }
      }, 1000);
    </script>
  <script src="js/reports.js"></script>
  <script src="js/web3-interactions.js"></script>
  <script src="js/main.js"></script>
  <script src="js/network.js?v=5.7"></script>
  <script src="js/network-database.js?v=5.8"></script>
  <script src="js/mobile-user-popup.js"></script>
  <script src="js/profile.js?v=5.7"></script>
  
  <script src="js/homepage.js?v=5.8"></script>

  <style>
    /* Fix for chart width issues */
    #price-chart-section {
      width: 100% !important;
      max-width: 100% !important;
      overflow-x: hidden !important;
    }
    
    #price-chart-canvas,
    #point-chart-canvas {
      width: 100% !important;
      max-width: 100% !important;
      height: 150px !important;
      box-sizing: border-box !important;
    }
    
    @media (max-width: 768px) {
      #price-chart-canvas,
      #point-chart-canvas {
        height: 120px !important;
      }
    }
    
    /* Transfer Status Styles */
    .transfer-status {
      margin-top: 1rem;
      padding: 0.8rem;
      border-radius: 8px;
      font-size: 0.9rem;
      text-align: center;
      font-weight: 500;
      transition: all 0.3s ease;
    }
    
    .transfer-status.success {
      background: rgba(0, 255, 136, 0.1);
      color: #00ff88;
      border: 1px solid rgba(0, 255, 136, 0.3);
    }
    
    .transfer-status.error {
      background: rgba(255, 68, 68, 0.1);
      color: #ff4444;
      border: 1px solid rgba(255, 68, 68, 0.3);
    }
    
    .transfer-status.loading {
      background: rgba(167, 134, 255, 0.1);
      color: #a786ff;
      border: 1px solid rgba(167, 134, 255, 0.3);
    }
    
    /* Transfer Form Improvements */
    .transfer-form {
      background: linear-gradient(135deg, #232946, #181c2a);
      border-radius: 12px;
      padding: 1.5rem;
      border: 2px solid #a786ff;
    }
    
    .transfer-row {
      margin-bottom: 1.5rem;
    }
    
    .transfer-row label {
      display: block;
      color: #a786ff;
      font-weight: bold;
      margin-bottom: 0.5rem;
      font-size: 0.95rem;
    }
    
    .transfer-row input,
    .transfer-row select {
      width: 100%;
      padding: 0.8rem;
      border-radius: 8px;
      border: 2px solid #a786ff;
      background: rgba(0, 0, 0, 0.2);
      color: #fff;
      font-size: 0.95rem;
      transition: border-color 0.3s ease;
      box-sizing: border-box;
    }
    
    .transfer-row input:focus,
    .transfer-row select:focus {
      outline: none;
      border-color: #00ff88;
    }
    
    .transfer-btn {
      background: linear-gradient(90deg, #00ff88, #a786ff);
      color: #181c2a;
      font-weight: bold;
      border: none;
      border-radius: 8px;
      padding: 1rem 2rem;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      width: 100%;
      margin-top: 1rem;
    }
    
    .transfer-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 255, 136, 0.3);
    }
    
    .transfer-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }
    
    /* Responsive Design for Transfer Section */
    @media (max-width: 768px) {
      #main-transfer {
        width: 100% !important;
        max-width: 100% !important;
        margin: 0 !important;
        left: 0 !important;
        right: 0 !important;
        padding: 0.5rem !important;
      }
      

      
      .transfer-container {
        max-width: 100% !important;
        padding: 0.8rem !important;
        margin: 0 !important;
        width: 100% !important;
      }
      
      .transfer-form {
        padding: 0.8rem !important;
        border-radius: 8px !important;
      }
      
      .transfer-row {
        margin-bottom: 0.8rem !important;
      }
      
      .transfer-row label {
        font-size: 0.9rem !important;
        margin-bottom: 0.3rem !important;
      }
      
      .transfer-row input,
      .transfer-row select {
        padding: 0.6rem !important;
        font-size: 0.9rem !important;
        border-radius: 6px !important;
      }
      
      .transfer-btn {
        padding: 0.7rem 1.2rem !important;
        font-size: 0.9rem !important;
        border-radius: 6px !important;
      }
      
      /* Balance grid responsive */
      .balance-check {
        padding: 0.8rem !important;
        border-radius: 6px !important;
      }
      
      .balance-check .balance-check-grid {
        grid-template-columns: 1fr !important;
        gap: 0.6rem !important;
      }
      
      .balance-check h4 {
        font-size: 1rem !important;
        margin-bottom: 0.6rem !important;
      }
      
      /* Search index row responsive */
      .search-index-container {
        flex-direction: column !important;
        gap: 0.4rem !important;
      }
      
      .search-index-container input {
        width: 100% !important;
        min-width: auto !important;
      }
      
      .search-index-container button {
        width: 100% !important;
        min-width: auto !important;
        padding: 0.5rem !important;
      }
      
      /* USD converter row responsive */
      .usd-converter-container {
        flex-direction: column !important;
        gap: 0.4rem !important;
      }
      
      .usd-converter-container input {
        width: 100% !important;
      }
      
      .usd-converter-container button {
        width: 100% !important;
        padding: 0.5rem !important;
      }
      
      /* Rules section responsive */
      .transfer-rules {
        padding: 0.8rem !important;
        border-radius: 8px !important;
        margin-bottom: 1rem !important;
      }
      
      .transfer-rules h3 {
        font-size: 1.1rem !important;
        margin-bottom: 0.8rem !important;
      }
      
      .transfer-rules h4 {
        font-size: 0.95rem !important;
        margin-bottom: 0.4rem !important;
      }
      
      .transfer-rules ul {
        font-size: 0.8rem !important;
        line-height: 1.4 !important;
        padding-right: 0.8rem !important;
      }
      
      .transfer-rules li {
        margin-bottom: 0.3rem !important;
      }
      
      /* Small text responsive */
      .transfer-row small {
        font-size: 0.75rem !important;
        margin-top: 0.2rem !important;
      }
      
      /* Max amount button responsive */
      #maxAmountBtn {
        padding: 0.4rem 0.8rem !important;
        font-size: 0.8rem !important;
        margin-top: 0.4rem !important;
        width: 100% !important;
      }
    }
    
    @media (max-width: 480px) {
      #main-transfer {
        padding: 0.3rem !important;
      }
      

      
      .transfer-container {
        padding: 0.6rem !important;
        margin: 0 !important;
        width: 100% !important;
      }
      
      .transfer-form {
        padding: 0.6rem !important;
      }
      
      .transfer-row {
        margin-bottom: 0.6rem !important;
      }
      
      .transfer-row label {
        font-size: 0.85rem !important;
      }
      
      .transfer-row input,
      .transfer-row select {
        padding: 0.5rem !important;
        font-size: 0.85rem !important;
      }
      
      .transfer-btn {
        padding: 0.6rem 1rem !important;
        font-size: 0.85rem !important;
      }
      
      .balance-check {
        padding: 0.6rem !important;
      }
      
      .transfer-rules {
        padding: 0.6rem !important;
      }
      
      .transfer-rules h3 {
        font-size: 1rem !important;
      }
      
      .transfer-rules h4 {
        font-size: 0.9rem !important;
      }
      
      .transfer-rules ul {
        font-size: 0.75rem !important;
      }
    }
    
    @media (min-width: 769px) and (max-width: 1024px) {

      
      .transfer-container {
        max-width: 90% !important;
        padding: 1.2rem !important;
        margin: 0 auto !important;
      }
      
      .transfer-form {
        padding: 1.2rem !important;
      }
      
      .balance-check .balance-check-grid {
        grid-template-columns: 1fr 1fr !important;
        gap: 1rem !important;
      }
    }
    
    @media (min-width: 1025px) {

      
      .transfer-container {
        max-width: 700px !important;
        padding: 1.5rem !important;
        margin: 0 auto !important;
      }
      
      .transfer-form {
        padding: 1.5rem !important;
      }
      
      .transfer-row {
        margin-bottom: 1.5rem !important;
      }
      
      .balance-check .balance-check-grid {
        grid-template-columns: 1fr 1fr 1fr !important;
        gap: 1rem !important;
      }
    }
    
    /* Responsive Design for Swap Section */
    @media (max-width: 768px) {
      #main-swap {
        width: 100% !important;
        max-width: 100% !important;
        margin: 0 !important;
        left: 0 !important;
        right: 0 !important;
        padding: 0.5rem !important;
      }
      
      .swap-container {
        max-width: 100% !important;
        padding: 0.8rem !important;
        margin: 0 !important;
        width: 100% !important;
      }
      
      .swap-form {
        padding: 0.8rem !important;
        border-radius: 8px !important;
      }
      
      .swap-row {
        margin-bottom: 0.8rem !important;
      }
      
      .swap-row label {
        font-size: 0.9rem !important;
        margin-bottom: 0.3rem !important;
      }
      
      .swap-row input,
      .swap-row select {
        padding: 0.6rem !important;
        font-size: 0.9rem !important;
        border-radius: 6px !important;
      }
      
      .swap-btn {
        padding: 0.7rem 1.2rem !important;
        font-size: 0.9rem !important;
        border-radius: 6px !important;
      }
      
      /* Swap rules responsive */
      .swap-rules {
        padding: 0.8rem !important;
        border-radius: 8px !important;
        margin-bottom: 1rem !important;
      }
      
      .swap-rules h3 {
        font-size: 1.1rem !important;
        margin-bottom: 0.8rem !important;
      }
      
      .swap-rules h4 {
        font-size: 0.95rem !important;
        margin-bottom: 0.4rem !important;
      }
      
      .swap-rules ul {
        font-size: 0.8rem !important;
        line-height: 1.4 !important;
        padding-right: 0.8rem !important;
      }
      
      .swap-rules li {
        margin-bottom: 0.3rem !important;
      }
      
      /* Amount input group responsive */
      .amount-input-group {
        flex-direction: column !important;
        gap: 0.4rem !important;
      }
      
      .amount-input-group input {
        width: 100% !important;
      }
      
      .amount-input-group .max-btn {
        width: 100% !important;
        padding: 0.5rem !important;
      }
      
      /* USD converter responsive */
      .swap-row .usd-converter-container {
        flex-direction: column !important;
        gap: 0.4rem !important;
      }
      
      .swap-row .usd-converter-container input {
        width: 100% !important;
      }
      
      .swap-row .usd-converter-container button {
        width: 100% !important;
        padding: 0.5rem !important;
      }
      
      /* Balance check responsive */
      .swap-balance-check {
        padding: 0.8rem !important;
        border-radius: 6px !important;
      }
      
      .swap-balance-check .swap-balance-grid {
        grid-template-columns: 1fr !important;
        gap: 0.6rem !important;
      }
      
      .swap-balance-check h4 {
        font-size: 1rem !important;
        margin-bottom: 0.6rem !important;
      }
      
      /* Small text responsive */
      .swap-row small {
        font-size: 0.75rem !important;
        margin-top: 0.2rem !important;
      }
    }
    
    @media (max-width: 480px) {
      #main-swap {
        padding: 0.3rem !important;
      }
      
      .swap-container {
        padding: 0.6rem !important;
      }
      
      .swap-form {
        padding: 0.6rem !important;
      }
      
      .swap-row {
        margin-bottom: 0.6rem !important;
      }
      
      .swap-row label {
        font-size: 0.85rem !important;
      }
      
      .swap-row input,
      .swap-row select {
        padding: 0.5rem !important;
        font-size: 0.85rem !important;
      }
      
      .swap-btn {
        padding: 0.6rem 1rem !important;
        font-size: 0.85rem !important;
      }
      
      .swap-balance-check {
        padding: 0.6rem !important;
      }
      
      .swap-rules {
        padding: 0.6rem !important;
      }
      
      .swap-rules h3 {
        font-size: 1rem !important;
      }
      
      .swap-rules h4 {
        font-size: 0.9rem !important;
      }
      
      .swap-rules ul {
        font-size: 0.75rem !important;
      }
    }
    
    @media (min-width: 769px) and (max-width: 1024px) {
      .swap-container {
        max-width: 90% !important;
        padding: 1.2rem !important;
        margin: 0 auto !important;
      }
      
      .swap-form {
        padding: 1.2rem !important;
      }
      
      .swap-balance-check .swap-balance-grid {
        grid-template-columns: 1fr 1fr !important;
        gap: 1rem !important;
      }
    }
    
    @media (min-width: 1025px) {
      .swap-container {
        max-width: 700px !important;
        padding: 1.5rem !important;
        margin: 0 auto !important;
      }
      
      .swap-form {
        padding: 1.5rem !important;
      }
      
      .swap-row {
        margin-bottom: 1.5rem !important;
      }
      
      .swap-balance-check .swap-balance-grid {
        grid-template-columns: 1fr 1fr !important;
        gap: 1rem !important;
      }
    }
  </style>
  
  <!-- ุชุนุฑู ูุชุบุฑูุง ููุฑุฏ ูุงุฒ ุจุฑุง ุณูุงูพ -->
  <script>
    // ุขุฏุฑุณ ูุฑุงุฑุฏุงุฏ DAI (DAI) ุฏุฑ ุดุจฺฉู Polygon
    window.DAI_ADDRESS = '0x8f3Cf7ad23Cd3CaDbD9735AFf958023239c6A063';
    
    // ABI ุณุงุฏู ุจุฑุง DAI (DAI)
    window.DAI_ABI = [
      {
        "inputs": [
          {
            "internalType": "address",
            "name": "spender",
            "type": "address"
          },
          {
            "internalType": "uint256",
            "name": "value",
            "type": "uint256"
          }
        ],
        "name": "approve",
        "outputs": [
          {
            "internalType": "bool",
            "name": "",
            "type": "bool"
          }
        ],
        "stateMutability": "nonpayable",
        "type": "function"
      },
      {
        "inputs": [
          {
            "internalType": "address",
            "name": "owner",
            "type": "address"
          },
          {
            "internalType": "address",
            "name": "spender",
            "type": "address"
          }
        ],
        "name": "allowance",
        "outputs": [
          {
            "internalType": "uint256",
            "name": "",
            "type": "uint256"
          }
        ],
        "stateMutability": "view",
        "type": "function"
      },
      {
        "inputs": [
          {
            "internalType": "address",
            "name": "account",
            "type": "address"
          }
        ],
        "name": "balanceOf",
        "outputs": [
          {
            "internalType": "uint256",
            "name": "",
            "type": "uint256"
          }
        ],
        "stateMutability": "view",
        "type": "function"
      }
    ];
  </script>
  
  <script src="js/swap.js?v=5.7"></script>
  

 
  <!-- Charts removed -->
  
  <script>
    // Safe, no-op placeholder to avoid unhandled users(address) calls
    (async () => {
      try {
        await window.connectWallet();
        // Intentionally skip direct contract.users(address) call to avoid provider decode issues
      } catch (e) {
        // ignore
      }
    })();
  </script>

  <script>
    async function updateAboutWalletsCount() {
      try {
        if (!window.contractConfig || !window.contractConfig.contract) {
          await window.connectWallet();
        }
        const contract = window.contractConfig.contract;
        if (contract && contract.wallets) {
          const walletsCount = await contract.wallets();
          document.getElementById('about-wallets-count').innerText = walletsCount.toString();
        } else {
          document.getElementById('about-wallets-count').innerText = '-';
        }
      } catch (e) {
        document.getElementById('about-wallets-count').innerText = '-';
      }
    }
    // Hook into tab switching
    const aboutBtn = document.getElementById('tab-about-btn');
    if (aboutBtn) {
      aboutBtn.addEventListener('click', updateAboutWalletsCount);
    }
  </script>

  <script>
    function toggleDashboardChart(chartId, btn) {
      const chartDiv = document.getElementById(chartId);
      if (!chartDiv) return;
      const isOpen = chartDiv.style.display === 'block';
      chartDiv.style.display = isOpen ? 'none' : 'block';
      btn.textContent = isOpen ? 'โผ' : 'โฒ';
      // Placeholder: Here you can load/render the chart if needed
    }
  </script>
  <!-- ููุฏุงู ุงูุฒูุฏู/ูุฑุงุด ุณุงุจ ุงุฏูู -->
  <div class="sub-admin-modal" id="sub-admin-modal">
    <div class="sub-admin-modal-content">
      <h3 id="modal-title">ุงูุฒูุฏู ุณุงุจ ุงุฏูู ุฌุฏุฏ</h3>
      <form class="sub-admin-form" id="sub-admin-form">
        <div class="form-group">
          <label for="sub-admin-name">ูุงู ุณุงุจ ุงุฏูู:</label>
          <input type="text" id="sub-admin-name" placeholder="ูุงู ฺฉุงูู ุณุงุจ ุงุฏูู" required>
        </div>
        
        <div class="form-group">
          <label for="sub-admin-address">ุขุฏุฑุณ ฺฉู ูพูู:</label>
          <input type="text" id="sub-admin-address" placeholder="0x..." required>
        </div>
        
        <div class="form-group">
          <label for="sub-admin-role">ููุด:</label>
          <select id="sub-admin-role" required>
            <option value="">ุงูุชุฎุงุจ ููุด</option>
            <option value="moderator">ูุฏุฑ ูุญุชูุง</option>
            <option value="support">ูพุดุชุจุงู</option>
            <option value="analyst">ุชุญููฺฏุฑ</option>
            <option value="teacher">ูุฏุฑุณ</option>
            <option value="custom">ุณูุงุฑุด</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="sub-admin-description">ุชูุถุญุงุช:</label>
          <textarea id="sub-admin-description" placeholder="ุชูุถุญุงุช ุงุถุงู..." rows="3"></textarea>
        </div>
        
        <div class="permissions-group">
          <h5>๐ ุฏุณุชุฑุณโูุง ุณุงุจ ุงุฏูู</h5>
          
          <div class="permission-item">
            <input type="checkbox" id="perm-stream-control" name="permissions">
            <label for="perm-stream-control">ฺฉูุชุฑู ูุงู ุงุณุชุฑู</label>
          </div>
          
          <div class="permission-item">
            <input type="checkbox" id="perm-chat-moderate" name="permissions">
            <label for="perm-chat-moderate">ูุฏุฑุช ฺุช</label>
          </div>
          
          <div class="permission-item">
            <input type="checkbox" id="perm-ban-users" name="permissions">
            <label for="perm-ban-users">ูุณุฏูุฏ ฺฉุฑุฏู ฺฉุงุฑุจุฑุงู</label>
          </div>
          
          <div class="permission-item">
            <input type="checkbox" id="perm-view-reports" name="permissions">
            <label for="perm-view-reports">ูุดุงูุฏู ฺฏุฒุงุฑุดโูุง</label>
          </div>
          
          <div class="permission-item">
            <input type="checkbox" id="perm-manage-content" name="permissions">
            <label for="perm-manage-content">ูุฏุฑุช ูุญุชูุง</label>
          </div>
          
          <div class="permission-item">
            <input type="checkbox" id="perm-view-analytics" name="permissions">
            <label for="perm-view-analytics">ูุดุงูุฏู ุขูุงุฑ</label>
          </div>
          
          <div class="permission-item">
            <input type="checkbox" id="perm-edit-products" name="permissions">
            <label for="perm-edit-products">ูุฑุงุด ูุญุตููุงุช</label>
          </div>
          
          <div class="permission-item">
            <input type="checkbox" id="perm-view-orders" name="permissions">
            <label for="perm-view-orders">ูุดุงูุฏู ุณูุงุฑุดุงุช</label>
          </div>
        </div>
        
        <div class="modal-buttons">
          <button type="submit" class="modal-btn primary" id="save-sub-admin-btn">๐พ ุฐุฎุฑู</button>
          <button type="button" class="modal-btn secondary" id="cancel-sub-admin-btn">โ ุงูุตุฑุงู</button>
        </div>
      </form>
    </div>
  </div>

  <!-- ููุฏุงู ุชุฃุฏ ุญุฐู -->
  <div class="sub-admin-modal" id="delete-confirm-modal">
    <div class="sub-admin-modal-content">
      <h3>โ๏ธ ุชุฃุฏ ุญุฐู</h3>
      <p style="color: #ccc; text-align: center; margin-bottom: 1.5rem;">
        ุขุง ูุทูุฆู ูุณุชุฏ ฺฉู ูโุฎูุงูุฏ ุงู ุณุงุจ ุงุฏูู ุฑุง ุญุฐู ฺฉูุฏุ
      </p>
      <div style="background: #181c2a; padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem;">
        <p style="color: #fff; margin: 0;"><strong>ูุงู:</strong> <span id="delete-admin-name"></span></p>
        <p style="color: #888; margin: 0.5rem 0 0 0;"><strong>ุขุฏุฑุณ:</strong> <span id="delete-admin-address"></span></p>
      </div>
      <div class="modal-buttons">
        <button class="modal-btn danger" id="confirm-delete-btn">๐๏ธ ุญุฐู</button>
        <button class="modal-btn secondary" id="cancel-delete-btn">โ ุงูุตุฑุงู</button>
      </div>
    </div>
  </div>



  <div id="custom-footer-div" style="text-align:center; padding:2rem; color:#00ff88; font-size:1.2rem;">
  <br>  <br>  <br>  <br>  <br>  <br>  <br>
  </div>


  <script>
    document.addEventListener('DOMContentLoaded', function() {
      var archiveBtn = Array.from(document.querySelectorAll('button, a')).find(el => el.textContent.includes('ุขุฑุดู ุจุงุฒุงุฑูุง ูุงู'));
      if (archiveBtn) archiveBtn.remove();
      
      // ุจุงุฒุงุจ ุชุจ ูุนุงู ุงุฒ localStorage
      const savedTab = localStorage.getItem('currentActiveTab');
      if (savedTab && savedTab !== 'network' && typeof window.showTab === 'function') {
        // Wait a bit for the page to fully load
        setTimeout(() => {
          window.showTab(savedTab);
        }, 1000);
      }
    });
  </script>

  <script>
  (async function() {
    if (window.getUserProfile) {
      const profile = await window.getUserProfile();
      if (!(profile.index && BigInt(profile.index) > 0n)) {
        // ููู ฺฉุฑุฏู ููุท ุจุฎุด ุฑูพูุฑุช
        const reportsSection = document.getElementById('main-reports');
        if (reportsSection) {
          reportsSection.innerHTML = '<div style="color:#ff6b6b;text-align:center;padding:3rem;font-size:1.5rem;">ุฏุณุชุฑุณ ุจู ุงู ุจุฎุด ููุท ุจุฑุง ฺฉุงุฑุจุฑุงู ูุนุงู ูุฌุงุฒ ุงุณุช.<br>๐</div>';
          reportsSection.style.background = '#181c2a';
        }
      }
    }
  })();
  </script>

  <!-- Control display of destination address input -->
  <script>
    // ุชุงุจุน ุจุฑูุฒุฑุณุงู ุฎูุฏฺฉุงุฑ ููุฌูุฏโูุง ุชุฑูุณูุฑ
    async function autoRefreshTransferBalances() {
      try {
        if (window.updateTransferBalancesOnConnect) {
          await window.updateTransferBalancesOnConnect();
          console.log('โ ููุฌูุฏโูุง ุชุฑูุณูุฑ ุฎูุฏฺฉุงุฑ ุจุฑูุฒุฑุณุงู ุดุฏ');
        }
      } catch (error) {
        console.warn('ุฎุทุง ุฏุฑ ุจุฑูุฒุฑุณุงู ุฎูุฏฺฉุงุฑ ููุฌูุฏโูุง ุชุฑูุณูุฑ:', error);
      }
    }

    document.addEventListener('DOMContentLoaded', function() {
      const transferForm = document.getElementById('transferForm');
      if (!transferForm) return;

              // Auto-update balances when page loads
      const initTransferBalances = () => {
        if (window.contractConfig && window.contractConfig.contract) {
          autoRefreshTransferBalances();
        } else {
          // ุงูุชุธุงุฑ ุจุฑุง ุงุชุตุงู ฺฉู ูพูู
          const checkConnection = setInterval(() => {
            if (window.contractConfig && window.contractConfig.contract) {
              autoRefreshTransferBalances();
              clearInterval(checkConnection);
            }
          }, 1000);
          
          // ูุชููู ฺฉุฑุฏู ุจุฑุฑุณ ุจุนุฏ ุงุฒ 15 ุซุงูู
          setTimeout(() => clearInterval(checkConnection), 15000);
        }
      };

      // ุดุฑูุน ุจุฑูุฒุฑุณุงู
      initTransferBalances();

      // USD Converter functionality
      const usdConverterRow = document.getElementById('usd-converter-row');
      const transferUsdAmount = document.getElementById('transferUsdAmount');
      const usdToIAMBtn = document.getElementById('usdToIAMBtn');
      
      // ููุงุด/ูุฎู ฺฉุฑุฏู ููุฏ USD ุจุฑ ุงุณุงุณ ููุน ุชูฺฉู
      function toggleUsdConverter() {
        const selectedToken = transferTokenSelect.value;
        if (selectedToken === 'IAM') {
          usdConverterRow.style.display = 'block';
        } else {
          usdConverterRow.style.display = 'none';
          transferUsdAmount.value = '';
        }
      }
      
      // ุชุจุฏู USD ุจู IAM
      async function convertUsdToIAM() {
        const usdAmount = parseFloat(transferUsdAmount.value);
        if (isNaN(usdAmount) || usdAmount <= 0) {
          alert('ูุทูุงู ููุฏุงุฑ ูุนุชุจุฑ ุจุฑุง ุฏูุงุฑ ูุงุฑุฏ ฺฉูุฏ');
          return;
        }
        
        try {
          // Get token price from smart contract
          const connection = await window.connectWallet();
          if (!connection || !connection.contract) {
            alert('ุงุจุชุฏุง ฺฉู ูพูู ุฎูุฏ ุฑุง ูุชุตู ฺฉูุฏ');
            return;
          }
          
          usdToIAMBtn.textContent = 'โณ ุฏุฑ ุญุงู ูุญุงุณุจู...';
          usdToIAMBtn.disabled = true;
          
          const tokenPriceRaw = await connection.contract.getTokenPrice();
          const tokenPrice = Number(ethers.formatUnits(tokenPriceRaw, 18));
          
          // ูุญุงุณุจู ููุฏุงุฑ IAM ููุฑุฏ ูุงุฒ
          const IAMAmount = (usdAmount / tokenPrice).toFixed(6);
          
          // ูุฑุงุฑ ุฏุงุฏู ููุฏุงุฑ ุฏุฑ ููุฏ ุงุตู
          transferAmountInput.value = IAMAmount;
          
          // ููุงุด ูพุงู ููููุช
          const statusDiv = document.getElementById('transferStatus');
          if (statusDiv) {
            statusDiv.innerHTML = `โ $${usdAmount} ูุนุงุฏู ${parseFloat(IAMAmount).toLocaleString('en-US', {maximumFractionDigits: 6})} IAM ุงุณุช`;
            statusDiv.style.color = '#00ff88';
            setTimeout(() => {
              statusDiv.innerHTML = '';
            }, 3000);
          }
          
        } catch (error) {
          console.error('ุฎุทุง ุฏุฑ ุชุจุฏู USD ุจู IAM:', error);
          alert('ุฎุทุง ุฏุฑ ุชุจุฏู. ูุทูุงู ุฏูุจุงุฑู ุชูุงุด ฺฉูุฏ.');
        } finally {
          usdToIAMBtn.textContent = '๐ ุชุจุฏู';
          usdToIAMBtn.disabled = false;
        }
      }
      
      // ุฏฺฉูู ุญุฏุงฺฉุซุฑ
      const maxAmountBtn = document.getElementById('maxAmountBtn');
      const transferAmountInput = document.getElementById('transferAmount');
      const transferTokenSelect = document.getElementById('transferToken');

      if (maxAmountBtn && transferAmountInput && transferTokenSelect) {
        maxAmountBtn.addEventListener('click', function() {
          const selectedToken = transferTokenSelect.value;
          let maxAmount = '0';
          
          // Get balance based on selected token
          if (selectedToken === 'dai') {
            const daiBalanceEl = document.getElementById('transfer-dai-balance');
            if (daiBalanceEl) {
              const raw = parseFloat(daiBalanceEl.dataset.value || daiBalanceEl.textContent);
              if (!isNaN(raw) && raw > 0) maxAmount = raw.toString();
            }
          } else if (selectedToken === 'pol') {
            const polBalanceEl = document.getElementById('transfer-poly-balance');
            if (polBalanceEl) {
              const raw = parseFloat(polBalanceEl.dataset.value || polBalanceEl.textContent);
              if (!isNaN(raw)) {
                maxAmount = Math.max(0, raw - 0.01).toString();
              }
            }
          } else if (selectedToken === 'IAM') {
            const IAMBalanceEl = document.getElementById('transfer-IAM-balance');
            if (IAMBalanceEl) {
              const raw = parseFloat(IAMBalanceEl.dataset.value || IAMBalanceEl.textContent);
              if (!isNaN(raw) && raw > 0) maxAmount = raw.toString();
            }
          }
          
          // Set value in input field
          if (parseFloat(maxAmount) > 0) {
            const decimals = (transferTokenSelect.value === 'IAM') ? 6 : 18;
            // ุจุฑุง DAI ู POL ุจูุชุฑ ุงุณุช 2 ุง 4 ุฑูู ุงุณุชูุงุฏู ฺฉููุ ุจุฑุง IAM ุชุง 6 ุฑูู
            const floorToDecimals = (val, d) => { const m = Math.pow(10, d); return Math.floor(Number(val) * m) / m; };
            const d = (transferTokenSelect.value === 'IAM') ? 6 : 4;
            const floored = floorToDecimals(maxAmount, d);
            transferAmountInput.value = floored.toFixed(d);
            // ุชุบุฑ ูุชู ุฏฺฉูู ุจู ุตูุฑุช ูููุช
            const originalText = maxAmountBtn.textContent;
            maxAmountBtn.textContent = 'โ ุชูุธู ุดุฏ';
            maxAmountBtn.style.background = 'linear-gradient(90deg,#00ff88,#00cc66)';
            setTimeout(() => {
              maxAmountBtn.textContent = originalText;
              maxAmountBtn.style.background = 'linear-gradient(90deg,#ff6b6b,#ee5a52)';
            }, 1500);
          } else {
            // ููุงุด ูพุงู ุฎุทุง
            maxAmountBtn.textContent = 'โ ููุฌูุฏ ฺฉุงู ูุณุช';
            maxAmountBtn.style.background = 'linear-gradient(90deg,#666,#555)';
            setTimeout(() => {
              maxAmountBtn.textContent = 'ุญุฏุงฺฉุซุฑ';
              maxAmountBtn.style.background = 'linear-gradient(90deg,#ff6b6b,#ee5a52)';
            }, 2000);
          }
        });
      }
      
      // Event listeners ุจุฑุง USD converter
      if (transferTokenSelect) {
        // ุชุบุฑ ููุน ุชูฺฉู
        transferTokenSelect.addEventListener('change', toggleUsdConverter);
        
        // ุงุฌุฑุง ุงููู ุจุฑุง ุชูุธู ูุถุนุช ุงููู
        toggleUsdConverter();
      }
      
      if (usdToIAMBtn) {
        // ฺฉูฺฉ ุฏฺฉูู ุชุจุฏู
        usdToIAMBtn.addEventListener('click', convertUsdToIAM);
      }
      
      if (transferUsdAmount) {
        // Enter key ุฏุฑ ููุฏ USD
        transferUsdAmount.addEventListener('keypress', function(e) {
          if (e.key === 'Enter') {
            e.preventDefault();
            convertUsdToIAM();
          }
        });
        
        // Real-time ูุญุงุณุจู ููุช ฺฉุงุฑุจุฑ ุชุงูพ ูโฺฉูู
        let usdTimeout;
        transferUsdAmount.addEventListener('input', function() {
          clearTimeout(usdTimeout);
          usdTimeout = setTimeout(async () => {
            const usdAmount = parseFloat(transferUsdAmount.value);
            if (!isNaN(usdAmount) && usdAmount > 0) {
              try {
                const connection = await window.connectWallet();
                if (connection && connection.contract) {
                  const tokenPriceRaw = await connection.contract.getTokenPrice();
                  const tokenPrice = Number(ethers.formatUnits(tokenPriceRaw, 18));
                  const IAMAmount = (usdAmount / tokenPrice).toFixed(6);
                  
                  // ููุงุด preview ุฏุฑ placeholder
                  transferAmountInput.placeholder = `โ ${parseFloat(IAMAmount).toLocaleString('en-US', {maximumFractionDigits: 6})} IAM`;
                }
              } catch (e) {
                // ุฎุทุง ุฏุฑ real-time - ูุงุฏุฏู ุจฺฏุฑ
              }
            } else {
              transferAmountInput.placeholder = 'ููุฏุงุฑ ุฑุง ูุงุฑุฏ ฺฉูุฏ';
            }
          }, 500); // 500ms delay ุจุฑุง ุฌููฺฏุฑ ุงุฒ ฺฉุงูโูุง ุฒุงุฏ
        });
      }
      
      // Real-time ูุญุงุณุจู ูุนุงุฏู ุฏูุงุฑ ููุช ููุฏุงุฑ IAM ุชุบุฑ ูฺฉูู
      if (transferAmountInput) {
        let IAMTimeout;
        transferAmountInput.addEventListener('input', function() {
          if (transferTokenSelect.value === 'IAM') {
            clearTimeout(IAMTimeout);
            IAMTimeout = setTimeout(async () => {
              const IAMAmount = parseFloat(transferAmountInput.value);
              if (!isNaN(IAMAmount) && IAMAmount > 0) {
                try {
                  const connection = await window.connectWallet();
                  if (connection && connection.contract) {
                    const tokenPriceRaw = await connection.contract.getTokenPrice();
                    const tokenPrice = Number(ethers.formatUnits(tokenPriceRaw, 18));
                    const usdValue = (IAMAmount * tokenPrice).toFixed(2);
                    
                    // ููุงุด ูุนุงุฏู ุฏูุงุฑ ุฏุฑ ููุฏ USD
                    if (transferUsdAmount) {
                      transferUsdAmount.placeholder = `โ $${parseFloat(usdValue).toLocaleString('en-US', {maximumFractionDigits: 2})}`;
                    }
                  }
                } catch (e) {
                  // ุฎุทุง ุฏุฑ real-time - ูุงุฏุฏู ุจฺฏุฑ
                }
              } else {
                if (transferUsdAmount) {
                  transferUsdAmount.placeholder = '5.00';
                }
              }
            }, 500);
          }
        });
      }

      transferForm.addEventListener('submit', async function(e) {
        e.preventDefault();
        const transferBtn = transferForm.querySelector('button[type="submit"]');
        if (transferBtn) {
          transferBtn.disabled = true;
          var oldText = transferBtn.textContent;
          transferBtn.textContent = 'ุฏุฑ ุญุงู ูพุฑุฏุงุฒุด...';
        }
        const to = document.getElementById('transferTo').value.trim();
        const amount = parseFloat(document.getElementById('transferAmount').value);
        const token = document.getElementById('transferToken').value;
        const status = document.getElementById('transferStatus');
        status.textContent = '';
        status.className = 'transfer-status';
        if (!to || !amount || amount <= 0) {
          status.textContent = 'ุขุฏุฑุณ ููุตุฏ ู ููุฏุงุฑ ูุนุชุจุฑ ูุงุฑุฏ ฺฉูุฏ';
          status.className = 'transfer-status error';
          if (transferBtn) { transferBtn.disabled = false; transferBtn.textContent = oldText; }
          return;
        }
        if (!window.contractConfig || !window.contractConfig.contract || !window.contractConfig.signer) {
          status.textContent = 'ุงุชุตุงู ฺฉู ูพูู ุจุฑูุฑุงุฑ ูุณุช';
          status.className = 'transfer-status error';
          if (transferBtn) { transferBtn.disabled = false; transferBtn.textContent = oldText; }
          return;
        }
        try {
          status.textContent = 'ุฏุฑ ุญุงู ุงุฑุณุงู...';
          status.className = 'transfer-status loading';
          if (token === 'pol') {
            // ุงูุชูุงู MATIC/POL
            const tx = await window.contractConfig.signer.sendTransaction({
              to,
              value: ethers.parseEther(amount.toString())
            });
            await tx.wait();
            status.textContent = 'ุงูุชูุงู ุจุง ููููุช ุงูุฌุงู ุดุฏ!\nฺฉุฏ ุชุฑุงฺฉูุด: ' + tx.hash;
            status.className = 'transfer-status success';
          } else if (token === 'dai') {
            // ุงูุชูุงู DAI - ุชุตุญุญ decimal ุจู 18
            const daiContract = new ethers.Contract(DAI_ADDRESS, DAI_ABI, window.contractConfig.signer);
            const decimals = 18; // DAI has 18 decimals, not 6
            const parsedAmount = ethers.parseUnits(amount.toString(), decimals);
            const tx = await daiContract.transfer(to, parsedAmount);
            await tx.wait();
            status.textContent = 'ุงูุชูุงู DAI ุจุง ููููุช ุงูุฌุงู ุดุฏ!\nฺฉุฏ ุชุฑุงฺฉูุด: ' + tx.hash;
            status.className = 'transfer-status success';
          } else {
            // ุงูุชูุงู IAM
            const contract = window.contractConfig.contract;
            const tx = await contract.transfer(to, ethers.parseEther(amount.toString()));
            await tx.wait();
            status.textContent = 'ุงูุชูุงู ุจุง ููููุช ุงูุฌุงู ุดุฏ!\nฺฉุฏ ุชุฑุงฺฉูุด: ' + tx.hash;
            status.className = 'transfer-status success';
          }
          transferForm.reset();
          
          // ุจุฑูุฒุฑุณุงู ููุฌูุฏโูุง ุจุนุฏ ุงุฒ ุงูุชูุงู ูููู
          setTimeout(autoRefreshTransferBalances, 2000);
        } catch (error) {
          let msg = error && error.message ? error.message : error;
          if (msg.includes('user rejected')) msg = 'ุชุฑุงฺฉูุด ุชูุณุท ฺฉุงุฑุจุฑ ูุบู ุดุฏ';
          else if (msg.includes('insufficient funds')) msg = 'ููุฌูุฏ ฺฉุงู ูุณุช';
          else if (msg.includes('invalid address')) msg = 'ุขุฏุฑุณ ููุตุฏ ูุงูุนุชุจุฑ ุงุณุช';
          else if (msg.includes('nonce')) msg = 'ุฎุทุง ุฏุฑ ุดูุงุฑู ุชุฑุงฺฉูุด. ูุทูุงู ุฏูุจุงุฑู ุชูุงุด ฺฉูุฏ';
          else if (msg.includes('execution reverted')) msg = 'ุชุฑุงฺฉูุด ูุงูููู ุจูุฏ. ูุทูุงู ุดุฑุงุท ุฑุง ุจุฑุฑุณ ฺฉูุฏ';
          else msg = 'ุฎุทุง ุฏุฑ ุงูุชูุงู: ' + msg;
          status.textContent = msg;
          status.className = 'transfer-status error';
        }
        if (transferBtn) { transferBtn.disabled = false; transferBtn.textContent = oldText; }
      });
    });
  </script>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const searchBtn = document.getElementById('searchIndexBtn');
      const searchInput = document.getElementById('searchIndex');
      const searchStatus = document.getElementById('searchIndexStatus');
      if (searchBtn && searchInput) {
        searchBtn.onclick = async function() {
          searchStatus.textContent = '';
          const idx = searchInput.value.trim();
          if (!idx || isNaN(idx) || Number(idx) < 0) {
            searchStatus.textContent = 'ุงูุฏฺฉุณ ูุนุชุจุฑ ูุงุฑุฏ ฺฉูุฏ';
            searchStatus.className = 'transfer-status error';
            return;
          }
          if (!window.contractConfig || !window.contractConfig.contract) {
            searchStatus.textContent = 'ุงุชุตุงู ฺฉู ูพูู ุจุฑูุฑุงุฑ ูุณุช';
            searchStatus.className = 'transfer-status error';
            return;
          }
          try {
            searchStatus.textContent = 'ุฏุฑ ุญุงู ุฌุณุชุฌู...';
            searchStatus.className = 'transfer-status loading';
            const contract = window.contractConfig.contract;
            const address = await contract.indexToAddress(BigInt(idx));
            if (!address || address === '0x0000000000000000000000000000000000000000') {
              searchStatus.textContent = 'Wallet address not found for this index';
              searchStatus.className = 'transfer-status error';
              document.getElementById('transferTo').value = '';
            } else {
              searchStatus.textContent = 'ุขุฏุฑุณ ููุช ูพุฏุง ุดุฏ';
              searchStatus.className = 'transfer-status success';
              document.getElementById('transferTo').value = address;
            }
          } catch (err) {
            searchStatus.textContent = 'ุฎุทุง ุฏุฑ ุฌุณุชุฌู: ' + (err && err.message ? err.message : err);
            searchStatus.className = 'transfer-status error';
            document.getElementById('transferTo').value = '';
          }
        };
      }
    });
  </script>

  <script>
    // ุชุงุจุน ุจุงุฒ/ุจุณุชู ฺฉุฑุฏู ุจุฎุดโูุง ูุงุจู ฺฏุณุชุฑุด
    function toggleExpandable(containerId) {
      const container = document.getElementById(containerId);
      if (container) {
        container.classList.toggle('collapsed');
        
        // ุฐุฎุฑู ูุถุนุช ุฏุฑ localStorage
        const isCollapsed = container.classList.contains('collapsed');
        localStorage.setItem(`expandable_${containerId}`, isCollapsed ? 'collapsed' : 'expanded');
      }
    }

    // ุจุงุฒุงุจ ูุถุนุช ุจุฎุดโูุง ูุงุจู ฺฏุณุชุฑุด ุงุฒ localStorage
    function restoreExpandableStates() {
      const expandableContainers = document.querySelectorAll('.expandable-container');
      expandableContainers.forEach(container => {
        const containerId = container.id;
        const savedState = localStorage.getItem(`expandable_${containerId}`);
        if (savedState === 'collapsed') {
          container.classList.add('collapsed');
        }
      });
    }

    document.addEventListener('DOMContentLoaded', function() {
      // ุจุงุฒุงุจ ูุถุนุช ุจุฎุดโูุง ูุงุจู ฺฏุณุชุฑุด
      restoreExpandableStates();
      
      
    });
  </script>

  <script>
    // ุชุงุจุน ููุงุด ููุช ุจุง ููุงุฏ ุนูู
    window.formatTokenPrice = function(priceWei) {
      if (!priceWei || priceWei === '0') return '0';
      let priceString = priceWei.toString();
      while (priceString.length < 18) priceString = '0' + priceString;
      if (priceString.length > 18) priceString = priceString.slice(-18);
      const result = '0.' + priceString;
      const numResult = parseFloat(result);
      if (numResult < 0.000001) {
        return numResult.toExponential(6);
      }
      return result;
    }

    // ุชุงุจุน ุจุฑูุฒุฑุณุงู ููุงุด ููุช
    async function updateTokenPriceDisplay() {
      try {
        if (!window.contractConfig || !window.contractConfig.contract) {
          await window.connectWallet();
          if (!window.contractConfig || !window.contractConfig.contract) {
            const el = document.getElementById('chart-lvl-usd');
            if (el) el.textContent = 'ุงุชุตุงู ูุงูููู';
            return;
          }
        }
        const contract = window.contractConfig.contract;
        const tokenPrice = await contract.getTokenPrice();
        const priceFormatted = window.formatTokenPrice(tokenPrice);
        const el = document.getElementById('chart-lvl-usd');
        if (el) el.textContent = priceFormatted;
        // ุจุฑูุฒุฑุณุงู point-value ุงุฒ ูุฑุงุฑุฏุงุฏ
        try {
          const pointValue = await contract.getPointValue();
          const pointValueNum = parseFloat(ethers.formatUnits(pointValue, 18));
          const pointValueFormatted = pointValueNum < 0.000001 ? pointValueNum.toExponential(6) : pointValueNum.toFixed(2);
          const el2 = document.getElementById('point-value');
          if (el2) el2.textContent = pointValueFormatted; // ุญุฐู ูพุณููุฏ IAM
        } catch (error) {
          // ...
        }
      } catch (error) {
        const el = document.getElementById('chart-lvl-usd');
                    if (el) el.textContent = 'Loading error';
      }
    }
    // ... existing code ...
  </script>

  <script>
    if (window.loadUserProfile) {
      const origLoadUserProfile = window.loadUserProfile;
      window.loadUserProfile = async function() {
        await origLoadUserProfile.apply(this, arguments);
        await updateProfileReferrer(); // ุงูุฌุง ุจุง await ู ุจุฏูู ุชุงุฎุฑ
      };
    }
  </script>
  <script src="js/token-price.js"></script>
  <script src="js/remove-archive-btn.js"></script>



  <script>
  document.addEventListener('DOMContentLoaded', function() {
    const btn = document.getElementById('connectProfileWalletBtn');
    if (btn) {
      btn.addEventListener('click', async function() {
        try {
          if (window.connectWallet) {
            await window.connectWallet();
            // After connecting, reload profile
            if (typeof loadUserProfile === 'function') loadUserProfile();
          }
        } catch (e) {
          alert('ุฎุทุง ุฏุฑ ุงุชุตุงู ฺฉู ูพูู: ' + (e.message || e));
        }
      });
    }
  });
  </script>

  <script src="js/navbar.js"></script>
  
  <!-- ููุฏุงุฑุฏู SwapManager -->
  <script>
    document.addEventListener('DOMContentLoaded', async function() {
      console.log('๐ ุดุฑูุน ููุฏุงุฑุฏู SwapManager...');
      
              // Ensure swap.js is loaded
      if (typeof SwapManager !== 'undefined') {
        try {
          console.log('โ SwapManager class found');
          
          // Wait a bit for DOM to fully load
          await new Promise(resolve => setTimeout(resolve, 1000));
          
          // ุจุฑุฑุณ ูุฌูุฏ ุนูุงุตุฑ ููุฑุฏ ูุงุฒ
          const requiredElements = ['swapForm', 'swapDirection', 'swapAmount', 'maxBtn', 'swapRate', 'swapPreview', 'swapLimitInfo', 'swapStatus'];
          const missingElements = requiredElements.filter(id => !document.getElementById(id));
          
          if (missingElements.length > 0) {
            console.warn('โ๏ธ The following elements were not found:', missingElements);
            return;
          }
          
          console.log('โ ุชูุงู ุนูุงุตุฑ ููุฑุฏ ูุงุฒ ููุฌูุฏ ูุณุชูุฏ');
          
          // ุจุฑุฑุณ ูุฌูุฏ ูุชุบุฑูุง ููุฑุฏ ูุงุฒ
          if (!window.DAI_ADDRESS || !window.DAI_ABI) {
            console.error('โ ูุชุบุฑูุง DAI_ADDRESS ุง DAI_ABI ุชุนุฑู ูุดุฏูโุงูุฏ');
            return;
          }
          
          console.log('โ ูุชุบุฑูุง DAI ููุฌูุฏ ูุณุชูุฏ');
          
          // ุงุฌุงุฏ ููููู SwapManager
          window.swapManager = new SwapManager();
          console.log('โ ููููู SwapManager ุงุฌุงุฏ ุดุฏ');
          
          // ููุฏุงุฑุฏู ุงููู
          await window.swapManager.initializeSwap();
          console.log('โ SwapManager ุจุง ููููุช ููุฏุงุฑุฏู ุดุฏ');
          
        } catch (error) {
          console.error('โ ุฎุทุง ุฏุฑ ููุฏุงุฑุฏู SwapManager:', error);
        }
      } else {
        console.warn('โ๏ธ SwapManager ุชุนุฑู ูุดุฏู ุงุณุช - ูุงู swap.js ุจุงุฑฺฏุฐุงุฑ ูุดุฏู');
      }
      
      // ุจุงุฑฺฏุฐุงุฑ ุฑูฺฉูฺฏ ฺฉุงุฑุจุฑุงู ุจุฑุชุฑ
      try {
        if (typeof window.displayTopUsersRanking === 'function') {
          // ฺฉู ุตุจุฑ ฺฉู ุชุง ุงุชุตุงู ุจู ูุฑุงุฑุฏุงุฏ ุจุฑูุฑุงุฑ ุดูุฏ
          setTimeout(async () => {
            try {
              // ุงุณุชูุงุฏู ุงุฒ ุชุงุจุน ุจูููโุณุงุฒ ุดุฏู ุจุฑุง ุนููฺฉุฑุฏ ุจูุชุฑ
              if (typeof window.getTopLikedUsersOptimized === 'function') {
                const topUsers = await window.getTopLikedUsersOptimized(10);
                if (topUsers.length > 0) {
                  await window.displayTopUsersRanking('top-users-ranking');
                } else {
                  // ุงฺฏุฑ ุชุงุจุน ุจููู ฺฉุงุฑ ูฺฉุฑุฏุ ุงุฒ ุชุงุจุน ุงุตู ุงุณุชูุงุฏู ฺฉู
                  await window.displayTopUsersRanking('top-users-ranking');
                }
              } else {
                await window.displayTopUsersRanking('top-users-ranking');
              }
            } catch (error) {
              console.error('โ ุฎุทุง ุฏุฑ ุจุงุฑฺฏุฐุงุฑ ุฑูฺฉูฺฏ:', error);
            }
          }, 2000);
        } else {
          console.warn('โ๏ธ ุชุงุจุน displayTopUsersRanking ุชุนุฑู ูุดุฏู ุงุณุช');
        }
      } catch (error) {
        console.error('โ ุฎุทุง ุฏุฑ ุจุงุฑฺฏุฐุงุฑ ุฑูฺฉูฺฏ:', error);
      }
    });
    
    // ููุฏุงุฑุฏู ูุฌุฏุฏ ุจุนุฏ ุงุฒ ุงุชุตุงู ฺฉู ูพูู
    if (window.connectWallet) {
      const originalConnectWallet = window.connectWallet;
      window.connectWallet = async function() {
        const result = await originalConnectWallet();
        
        // ููุฏุงุฑุฏู ูุฌุฏุฏ SwapManager ุจุนุฏ ุงุฒ ุงุชุตุงู
        setTimeout(async () => {
          if (window.swapManager && typeof window.swapManager.refreshSwapData === 'function') {
            try {
              console.log('๐ ุฑูุฑุด SwapManager ุจุนุฏ ุงุฒ ุงุชุตุงู ฺฉู ูพูู...');
              await window.swapManager.refreshSwapData();
              console.log('โ SwapManager ุฑูุฑุด ุดุฏ');
            } catch (error) {
              console.warn('โ๏ธ ุฎุทุง ุฏุฑ ุฑูุฑุด SwapManager:', error);
            }
          }
          // Update index dashboard status bar
          try { if (typeof window.indexStatusTryUpdate === 'function') window.indexStatusTryUpdate(); } catch(_) {}
        }, 1000);
        
        return result;
      };
    }
  </script>
  </div>

<style>
/* ูุงู ุชูุฒ ุดุฏ - CSS ุฌุฏุฏ ุฏุฑ ุงูุชูุง ูุฑุงุฑ ุฏุงุฑุฏ */

/* === ููู ฺฉุงุฑุชโูุง ูฺฉุณ ุนุฑุถ ุฏุฑ ููุจุงู === */
@media (max-width: 768px) {
  /* ฺฉุงูุชูุฑ ุงุตู ฺฉุงุฑุชโูุง */
  div[style*="display:flex;flex-wrap:wrap;gap:0.5rem;margin-bottom:1rem;justify-content:center;"] {
    display: flex !important;
    flex-direction: column !important;
    gap: 0.8rem !important;
    width: 100% !important;
    padding: 0 0.5rem !important;
  }
  
  /* ููู ฺฉุงุฑุชโูุง ูฺฉุณ ุนุฑุถ ฺฉุงูู */
  div[style*="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid"] {
    width: 100% !important;
    min-width: 100% !important;
    max-width: 100% !important;
    flex: none !important;
    padding: 1.2rem !important;
    margin: 0 !important;
    margin-bottom: 0.8rem !important;
    border-radius: 12px !important;
    box-shadow: 0 4px 16px rgba(0,0,0,0.3) !important;
    backdrop-filter: blur(6px) !important;
    border: 1.5px solid rgba(255,255,255,0.15) !important;
    box-sizing: border-box !important;
    overflow: hidden !important;
  }
  
  /* ุขฺฉููโูุง ฺฉุงุฑุช */
  div[style*="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid"] > div[style*="font-size:1.2rem;margin-bottom:0.3rem;"] {
    font-size: 1.8rem !important;
    margin-bottom: 0.6rem !important;
    text-align: center !important;
  }
  
  /* ุนููุงู ฺฉุงุฑุชโูุง */
  div[style*="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid"] > div[style*="font-size:0.8rem;font-weight:bold;margin-bottom:0.2rem;"] {
    font-size: 1rem !important;
    margin-bottom: 0.4rem !important;
    letter-spacing: 0.3px !important;
    text-align: center !important;
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
  }
  
  /* ููุงุฏุฑ ฺฉุงุฑุชโูุง - ูฺฉุณ overflow */
  div[style*="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid"] > div[style*="font-size:0.9rem;font-family:monospace;font-weight:bold;"] {
    font-size: 1.1rem !important;
    margin: 0.6rem 0 !important;
    letter-spacing: 0.2px !important;
    text-shadow: 0 1px 2px rgba(0,0,0,0.4) !important;
    text-align: center !important;
    word-break: break-all !important;
    overflow-wrap: break-word !important;
    max-width: 100% !important;
    box-sizing: border-box !important;
  }
  
  /* ุชูุถุญุงุช ฺฉุงุฑุชโูุง */
  div[style*="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid"] > div[style*="font-size:0.7rem;margin-top:0.2rem;"] {
    font-size: 0.8rem !important;
    margin-top: 0.4rem !important;
    opacity: 0.7 !important;
    text-align: center !important;
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
  }
  
  /* ฺฉุงุฑุชโูุง ุฎุงุต - ุงูุฏุงุฒูโูุง ูฺู */
  
  /* ฺฉุงุฑุช ฺฉู ุนุฑุถู */
  div[style*="border:1px solid rgba(0,255,136,0.2)"] {
    border: 3px solid rgba(0,255,136,0.4) !important;
    background: rgba(0,255,136,0.1) !important;
  }
  
  /* ฺฉุงุฑุช ููุฌูุฏ ูุฑุงุฑุฏุงุฏ IAM */
  div[style*="border:1px solid rgba(255,193,7,0.2)"] {
    border: 3px solid rgba(255,193,7,0.4) !important;
    background: rgba(255,193,7,0.1) !important;
  }
  
  /* ฺฉุงุฑุช ููุฌูุฏ DAI */
  div[style*="border:1px solid rgba(0,123,255,0.2)"] {
    border: 3px solid rgba(0,123,255,0.4) !important;
    background: rgba(0,123,255,0.1) !important;
  }
  
  /* ฺฉุงุฑุช ููุช ุซุจุชโูุงู */
  div[style*="border:1px solid rgba(138,43,226,0.2)"] {
    border: 3px solid rgba(138,43,226,0.4) !important;
    background: rgba(138,43,226,0.1) !important;
  }
  
  /* Card Entry Animation */
  div[style*="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid"] {
    animation: slideUpMobile 0.6s ease-out !important;
    animation-delay: calc(var(--card-index, 0) * 0.1s) !important;
  }
}

/* Card Entry Animation on Mobile */
@keyframes slideUpMobile {
  from {
    opacity: 0;
    transform: translateY(30px) scale(0.9);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

/* ูุฎุตูุต ุตูุญุงุช ุฎู ฺฉูฺฺฉ */
@media (max-width: 480px) {
  /* ฺฉุงูุชูุฑ ฺฉุงุฑุชโูุง */
  div[style*="display:flex;flex-wrap:wrap;gap:0.5rem;margin-bottom:1rem;justify-content:center;"] {
    padding: 0 0.3rem !important;
    gap: 0.6rem !important;
  }
  
  /* ฺฉุงุฑุชโูุง */
  div[style*="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid"] {
    padding: 1rem !important;
    margin-bottom: 0.6rem !important;
    border-radius: 10px !important;
  }
  
  /* ุขฺฉููโูุง */
  div[style*="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid"] > div[style*="font-size:1.2rem;margin-bottom:0.3rem;"] {
    font-size: 1.5rem !important;
    margin-bottom: 0.5rem !important;
  }
  
  /* ุนูุงูู */
  div[style*="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid"] > div[style*="font-size:0.8rem;font-weight:bold;margin-bottom:0.2rem;"] {
    font-size: 0.9rem !important;
    margin-bottom: 0.3rem !important;
  }
  
  /* ููุงุฏุฑ */
  div[style*="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid"] > div[style*="font-size:0.9rem;font-family:monospace;font-weight:bold;"] {
    font-size: 1rem !important;
    margin: 0.5rem 0 !important;
    line-height: 1.2 !important;
  }
  
  /* ุชูุถุญุงุช */
  div[style*="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid"] > div[style*="font-size:0.7rem;margin-top:0.2rem;"] {
    font-size: 0.75rem !important;
    margin-top: 0.3rem !important;
  }
}

/* ุฌููฺฏุฑ ุงุฒ ุจุฑูู ุฒุฏู ุงุนุฏุงุฏ ุทููุงู ุงุฒ ุฏุงุฎู ฺฉุงุฑุชโูุง (ุฏุฑ ููู ุงูุฏุงุฒูโูุง) */
div[style*="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid"] > div[style*="font-size:0.9rem;font-family:monospace;font-weight:bold;"] {
  word-break: break-all !important;
  overflow-wrap: anywhere !important;
  white-space: normal !important;
  max-width: 100% !important;
}

/* Responsive Layout for Dashboard Metric Cards on Tablet and Desktop */
@media (min-width: 769px) and (max-width: 1023px) {
  /* ุธุฑู ฺฉุงุฑุชโูุง โ 2 ุณุชูู ุฏุฑ ูุฑ ุณุทุฑ */
  div[style*="display:flex;flex-wrap:wrap;gap:0.5rem;margin-bottom:1rem;justify-content:center;"] {
    display: grid !important;
    grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
    gap: 0.8rem !important;
    justify-content: center !important;
  }
  /* ุฎูุฏ ฺฉุงุฑุชโูุง ุฏุงุฎู ุธุฑู ุจุงูุง */
  div[style*="display:flex;flex-wrap:wrap;gap:0.5rem;margin-bottom:1rem;justify-content:center;"] > div[style*="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid"] {
    min-width: 0 !important;
    max-width: 100% !important;
    width: 100% !important;
    flex: none !important;
    box-sizing: border-box !important;
  }
}

@media (min-width: 1024px) {
  /* ุธุฑู ฺฉุงุฑุชโูุง โ 3 ุณุชูู ุฏุฑ ูุฑ ุณุทุฑ */
  div[style*="display:flex;flex-wrap:wrap;gap:0.5rem;margin-bottom:1rem;justify-content:center;"] {
    display: grid !important;
    grid-template-columns: repeat(3, minmax(0, 1fr)) !important;
    gap: 1rem !important;
    justify-content: center !important;
  }
  /* ุฎูุฏ ฺฉุงุฑุชโูุง ุฏุงุฎู ุธุฑู ุจุงูุง */
  div[style*="display:flex;flex-wrap:wrap;gap:0.5rem;margin-bottom:1rem;justify-content:center;"] > div[style*="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid"] {
    min-width: 0 !important;
    max-width: 100% !important;
    width: 100% !important;
    flex: none !important;
    box-sizing: border-box !important;
  }
}

/* Dynamic Width Mode for Dashboard Metric Cards on Tablet/Desktop
   ุงู ุจููฺฉ ููุงูู ฺฏุฑุฏ ุฑุง ุฏุฑ ุจุงูุง override ูโฺฉูุฏ ุชุง ฺฉุงุฑุชโูุง ุจู ุงูุฏุงุฒูู ูุญุชูุง ุนุฑุถ ุดููุฏ */
@media (min-width: 769px) {
  /* ุธุฑู ฺฉุงุฑุชโูุง: ููฺฉุณ ู ูุงุจู ูพฺุด */
  div[style*="display:flex;flex-wrap:wrap;gap:0.5rem;margin-bottom:1rem;justify-content:center;"] {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 0.8rem !important;
    justify-content: center !important;
    align-items: stretch !important;
  }
  /* ุฎูุฏ ฺฉุงุฑุชโูุง: ุนุฑุถ ุจุฑ ุงุณุงุณ ูุญุชูุง */
  div[style*="display:flex;flex-wrap:wrap;gap:0.5rem;margin-bottom:1rem;justify-content:center;"] > div[style*="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid"] {
    flex: 0 0 auto !important;
    width: auto !important;
    min-width: auto !important;
    max-width: none !important;
    box-sizing: border-box !important;
  }
  /* ููุฏุงุฑูุง: ฺฉโุฎุท ุจูุงููุฏ ุชุง ฺฉุงุฑุช ุนุฑุถ ุดูุฏ */
  div[style*="display:flex;flex-wrap:wrap;gap:0.5rem;margin-bottom:1rem;justify-content:center;"] > div[style*="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid"] > div[style*="font-size:0.9rem;font-family:monospace;font-weight:bold;"] {
    white-space: nowrap !important;
    word-break: normal !important;
    overflow-wrap: normal !important;
  }
}

/* Dynamic Width Mode for Dashboard Metric Cards on Mobile */
@media (max-width: 768px) {
  /* ุธุฑู ฺฉุงุฑุชโูุง: ููฺฉุณุ ูพฺุด ูุนุงูุ ฺูุด ุฑุฏูุ ุงุณฺฉุฑูู ุงูู ุฏุฑ ุตูุฑุช ูุงุฒ */
  div[style*="display:flex;flex-wrap:wrap;gap:0.5rem;margin-bottom:1rem;justify-content:center;"] {
    display: flex !important;
    flex-direction: row !important;
    flex-wrap: wrap !important;
    justify-content: flex-start !important;
    align-items: stretch !important;
    gap: 0.6rem !important;
    width: 100% !important;
    padding: 0 0.5rem !important;
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
  }
  /* ฺฉุงุฑุชโูุง: ุนุฑุถ ุจุฑ ุงุณุงุณ ูุญุชูุงุ ุฌููฺฏุฑ ุงุฒ ฺฉุดุฏู ุดุฏู ุจู 100% */
  div[style*="display:flex;flex-wrap:wrap;gap:0.5rem;margin-bottom:1rem;justify-content:center;"] > div[style*="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid"] {
    flex: 0 0 auto !important;
    width: auto !important;
    min-width: max-content !important;
    max-width: none !important;
    box-sizing: border-box !important;
    margin: 0 !important;
  }
  /* ููุฏุงุฑูุง: ฺฉโุฎุท ุจุฑุง ุงูุฒุงุด ุนุฑุถ ฺฉุงุฑุช */
  div[style*="display:flex;flex-wrap:wrap;gap:0.5rem;margin-bottom:1rem;justify-content:center;"] > div[style*="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid"] > div[style*="font-size:0.9rem;font-family:monospace;font-weight:bold;"] {
    white-space: nowrap !important;
    word-break: normal !important;
    overflow-wrap: normal !important;
  }
}
</style>

<script>
// ูุฏุฑุช ฺฉุงุฑุชโูุง ู ููุงุฏุฑ ุฏุฑ ููุจุงู
function optimizeCardsForMobile() {
  if (window.innerWidth <= 768) {
    // ูพุฏุง ฺฉุฑุฏู ููู ฺฉุงุฑุชโูุง
    const cards = document.querySelectorAll('div[style*="background:rgba(0,0,0,0.3)"]');
    
    cards.forEach((card, index) => {
      // ูฺฉุณ ฺฉุฑุฏู ุนุฑุถ
      card.style.width = '100%';
      card.style.maxWidth = '100%';
      card.style.minWidth = '100%';
      card.style.boxSizing = 'border-box';
      card.style.overflow = 'hidden';
      
      // Entry Animation
      card.style.setProperty('--card-index', index.toString());
      card.style.opacity = '0';
      card.style.transform = 'translateY(20px)';
      
      // ุชุงุฎุฑ ุจุฑุง ุงููุดู
      setTimeout(() => {
        card.style.transition = 'all 0.4s ease';
        card.style.opacity = '1';
        card.style.transform = 'translateY(0)';
      }, index * 80);
      
      // ุจูููโุณุงุฒ ููุงุฏุฑ ุฏุงุฎู ฺฉุงุฑุช
      const valueElements = card.querySelectorAll('div[style*="font-family:monospace"]');
      valueElements.forEach(valueEl => {
        valueEl.style.wordBreak = 'break-all';
        valueEl.style.overflowWrap = 'break-word';
        valueEl.style.maxWidth = '100%';
        valueEl.style.textAlign = 'center';
        
        // ุงฺฏุฑ ููุฏุงุฑ ุฎู ุจููุฏ ุงุณุชุ ูููุช ุฑุง ฺฉูฺฺฉโุชุฑ ฺฉู
        const text = valueEl.textContent || '';
        if (text.length > 15) {
          valueEl.style.fontSize = '0.9rem';
          valueEl.style.lineHeight = '1.2';
        }
        if (text.length > 25) {
          valueEl.style.fontSize = '0.8rem';
          valueEl.style.lineHeight = '1.1';
        }
      });
    });
    
    // ุจูููโุณุงุฒ ฺฉุงูุชูุฑ ุงุตู
    const container = document.querySelector('div[style*="display:flex;flex-wrap:wrap"]');
    if (container) {
      container.style.width = '100%';
      container.style.padding = '0 0.5rem';
      container.style.boxSizing = 'border-box';
    }
  }
}

// ูุฏุฑุช ุฏฺฉูู ุฑูุฑุด ููุจุงู
document.addEventListener('DOMContentLoaded', function() {
  // ุจูููโุณุงุฒ ฺฉุงุฑุชโูุง ุจุฑุง ููุจุงู
  setTimeout(() => {
    optimizeCardsForMobile();
  }, 800);
  
  // ุจูููโุณุงุฒ ูุฌุฏุฏ ููฺฏุงู ุชุบุฑ ุงูุฏุงุฒู ุตูุญู
  let resizeTimeout;
  window.addEventListener('resize', () => {
    clearTimeout(resizeTimeout);
    resizeTimeout = setTimeout(() => {
      optimizeCardsForMobile();
    }, 300);
  });
  
  // ุจูููโุณุงุฒ ูุฌุฏุฏ ููฺฏุงู ุจุฑูุฒุฑุณุงู ููุงุฏุฑ
  const observer = new MutationObserver(() => {
    if (window.innerWidth <= 768) {
      setTimeout(optimizeCardsForMobile, 200);
    }
  });
  
  // ูุธุงุฑุช ุจุฑ ุชุบุฑุงุช ุฏุฑ ฺฉุงุฑุชโูุง
  const targetNode = document.querySelector('div[style*="display:flex;flex-wrap:wrap"]');
  if (targetNode) {
    observer.observe(targetNode, {
      childList: true,
      subtree: true,
      characterData: true
    });
  }
  
  // ฺฉุฏูุง ุงุตู ุตูุญู
});



// ูพุงุงู ุงุณฺฉุฑูพุชโูุง ุงุตู

// ุชุงุจุน ุจุงุฑฺฏุฐุงุฑ ุฏุณุช ุฑูฺฉูฺฏ
function loadRanking() {
  console.log('๐ ุดุฑูุน ุจุงุฑฺฏุฐุงุฑ ุฑูฺฉูฺฏ...');
  
  // ุจุฑุฑุณ ุงุชุตุงู ฺฉู ูพูู
  if (!window.contractConfig || !window.contractConfig.contract) {
    console.log('โ๏ธ ฺฉู ูพูู ูุชุตู ูุณุชุ ุฏุฑ ุญุงู ุงุชุตุงู...');
    window.connectWallet().then(() => {
      setTimeout(() => {
        loadRankingInternal();
      }, 1000);
    }).catch(error => {
      console.error('โ ุฎุทุง ุฏุฑ ุงุชุตุงู ฺฉู ูพูู:', error);
      document.getElementById('top-users-ranking').innerHTML = `
        <div style="text-align: center; padding: 2rem; color: #ff4444;">
          <div>โ ุงุจุชุฏุง ฺฉู ูพูู ุฎูุฏ ุฑุง ูุชุตู ฺฉูุฏ</div>
        </div>
      `;
    });
  } else {
    loadRankingInternal();
  }
}

function loadRankingInternal() {
  console.log('๐ ุจุฑุฑุณ ุชูุงุจุน ุฑูฺฉูฺฏ...');
  console.log('displayTopUsersRanking ููุฌูุฏ:', typeof window.displayTopUsersRanking);
  console.log('getTopLikedUsersOptimized ููุฌูุฏ:', typeof window.getTopLikedUsersOptimized);
  
  if (typeof window.displayTopUsersRanking === 'function') {
    console.log('โ ุดุฑูุน ููุงุด ุฑูฺฉูฺฏ...');
    window.displayTopUsersRanking('top-users-ranking').then(() => {
      console.log('โ ุฑูฺฉูฺฏ ุจุง ููููุช ุจุงุฑฺฏุฐุงุฑ ุดุฏ');
    }).catch(error => {
      console.error('โ ุฎุทุง ุฏุฑ ููุงุด ุฑูฺฉูฺฏ:', error);
      document.getElementById('top-users-ranking').innerHTML = `
        <div style="text-align: center; padding: 2rem; color: #ff4444;">
          <div>โ ุฎุทุง ุฏุฑ ุจุงุฑฺฏุฐุงุฑ ุฑูฺฉูฺฏ</div>
          <div style="font-size: 0.8rem; margin-top: 0.5rem;">${error.message}</div>
        </div>
      `;
    });
  } else {
    console.error('โ ุชุงุจุน displayTopUsersRanking ููุฌูุฏ ูุณุช');
    document.getElementById('top-users-ranking').innerHTML = `
      <div style="text-align: center; padding: 2rem; color: #ff4444;">
        <div>โ ุชุงุจุน ุฑูฺฉูฺฏ ููุฌูุฏ ูุณุช</div>
        <div style="font-size: 0.8rem; margin-top: 0.5rem;">ูุทูุงู ุตูุญู ุฑุง ุฑูุฑุด ฺฉูุฏ</div>
      </div>
    `;
  }
}

// ุชุงุจุน ุงุณฺฉุฑูู ุจู ุจุฎุด ุฑูฺฉูฺฏ
function scrollToRanking() {
  const rankingElement = document.getElementById('top-users-ranking');
  if (rankingElement) {
    rankingElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
    // ูุงูุงุช ฺฉุฑุฏู ุจุฎุด ุฑูฺฉูฺฏ
    rankingElement.style.boxShadow = '0 0 20px rgba(167,134,255,0.5)';
    setTimeout(() => {
      rankingElement.style.boxShadow = '';
    }, 2000);
  }
}



</script>

<!-- Floating Token Growth Card - ฺฉุงุฑุช ุดูุงูุฑ ุฑุดุฏ ุชูฺฉู -->
<script src="js/floating-token-card.js"></script>

<!-- ุงุนูุงู ุชู ูุฏุฑู -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  console.log('๐จ ุงุนูุงู ุชู ูุฏุฑู ูุงุฑูุฌ ู ุจููุด...');
  
  // Apply modern-card class to all existing cards
  const cards = document.querySelectorAll('.dashboard-card');
  cards.forEach(card => {
    if (!card.classList.contains('modern-card')) {
      card.classList.add('modern-card');
    }
  });
  
  // Apply modern-btn class to all buttons
  const buttons = document.querySelectorAll('button');
  buttons.forEach(button => {
    if (!button.classList.contains('modern-btn')) {
      button.classList.add('modern-btn', 'modern-btn-primary');
    }
  });
  
  // Apply modern-input class to all input fields
  const inputs = document.querySelectorAll('input');
  inputs.forEach(input => {
    if (!input.classList.contains('modern-input')) {
      input.classList.add('modern-input');
    }
  });
  
  console.log('โ ุชู ูุฏุฑู ูุงุฑูุฌ ู ุจููุด ุงุนูุงู ุดุฏ');
});
</script>

</body>
</html>