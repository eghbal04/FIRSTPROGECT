<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>CONTINUOUS PROFIT ACADEMY</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Arabic:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Mono&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/index-custom.css">
    <link rel="stylesheet" href="css/floating-ai-assistant.css">

    <!-- Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ethers.js Ù†Ø³Ø®Ù‡ 6 Ø§Ø² CDN -->
    <script src="https://cdn.jsdelivr.net/npm/ethers@6.10.0/dist/ethers.umd.min.js"></script>
    <!-- Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ WalletConnect Provider Ø§Ø² CDN Ø±Ø³Ù…ÛŒ -->
    <script src="https://cdn.jsdelivr.net/npm/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>
    <!-- Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ WalletConnect Handler -->
    <script src="js/walletconnect-handler.js?v=5.7"></script>

      <!-- Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ WalletConnect UMD Ø¨Ù‡ ØµÙˆØ±Øª Ù„ÙˆÚ©Ø§Ù„ -->
  <script src="js/walletconnect-v1.8.0.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>
  
  <!-- Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ù†Ø´ Ù¾Ø§ÛŒÙ‡ Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ -->
  <!-- <script src="js/contract-knowledge-base.js"></script> -->
  
  <!-- Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Floating AI Assistants -->
  <!-- <script src="js/floating-ai-assistant.js"></script> -->
  
  <!-- Immediate AI Assistant Initialization -->
  <!--
  <script>
    // Force immediate initialization
    document.addEventListener('DOMContentLoaded', function() {
      console.log('ğŸš€ DOM Content Loaded - Initializing AI Assistant...');

      setTimeout(() => {
        // ÙÙ‚Ø· Ø¯Ø³ØªÛŒØ§Ø± Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ø±Ø§ Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ú©Ù†
        if (typeof FloatingAIAssistant !== 'undefined') {
          console.log('âœ… FloatingAIAssistant class found');

          if (!window.floatingAI) {
            console.log('ğŸ”„ Creating new FloatingAIAssistant instance...');
            window.floatingAI = new FloatingAIAssistant();
          }
          
          if (window.floatingAI) {
            console.log('âœ… FloatingAI instance ready');
            window.floatingAI.switchToIdleState();
          }
        } else {
          console.error('âŒ FloatingAIAssistant class not found');
        }
      }, 1000);
    });
  </script>
  -->
  
  <!-- Test script for floating AI -->

</head>
<body>
  <div id="online-session-bubble" style="display:none;">
    <span class="bubble-text">Ø¬Ù„Ø³Ù‡ Ø¢Ù†Ù„Ø§ÛŒÙ† Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ú¯Ø²Ø§Ø±ÛŒ Ø§Ø³Øª! ğŸš€</span>
    <span class="bubble-timer" id="bubble-timer"></span>
    <a href="learning.html" class="bubble-link" target="_blank">ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ú©Ù„Ø§Ø³</a>
    <span class="bubble-close" id="bubble-close">Ã—</span>
  </div>
  <div id="bubble-mini" style="display:none;">
    <span class="bubble-mini-icon">ğŸš€</span>
  </div>
  <script>
    function formatCountdown(ms) {
      if (ms <= 0) return '00:00:00';
      let s = Math.floor(ms / 1000);
      let h = Math.floor(s / 3600);
      s = s % 3600;
      let m = Math.floor(s / 60);
      s = s % 60;
      return `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
    }
    function showSessionBubble() {
      const info = window.sessionInfo;
      if (!info || !info.active) return;
      const bubble = document.getElementById('online-session-bubble');
      const mini = document.getElementById('bubble-mini');
      const timer = document.getElementById('bubble-timer');
      const link = bubble.querySelector('.bubble-link');
      link.href = info.link || 'learning.html';
      bubble.style.display = 'flex';
      mini.style.display = 'none';
      // Ø´Ù…Ø§Ø±Ø´ Ù…Ø¹Ú©ÙˆØ³
      function updateTimer() {
        const now = Date.now();
        if (now < info.startTime) {
          timer.textContent = 'Ø´Ø±ÙˆØ¹ ØªØ§ Ø¬Ù„Ø³Ù‡: ' + formatCountdown(info.startTime - now);
        } else if (now < info.endTime) {
          timer.textContent = 'Ø²Ù…Ø§Ù† Ø¨Ø§Ù‚ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ù‡: ' + formatCountdown(info.endTime - now);
        } else {
          timer.textContent = 'Ø¬Ù„Ø³Ù‡ Ø¨Ù‡ Ù¾Ø§ÛŒØ§Ù† Ø±Ø³ÛŒØ¯';
        }
      }
      updateTimer();
      window._bubbleTimerInterval = setInterval(updateTimer, 1000);
    }
    function hideSessionBubble() {
      document.getElementById('online-session-bubble').style.display = 'none';
      document.getElementById('bubble-mini').style.display = 'flex';
      if (window._bubbleTimerInterval) clearInterval(window._bubbleTimerInterval);
    }
    function showMiniBubble() {
      document.getElementById('bubble-mini').style.display = 'flex';
      document.getElementById('online-session-bubble').style.display = 'none';
    }
    function expandMiniBubble() {
      showSessionBubble();
    }
    // Ø±ÙˆÛŒØ¯Ø§Ø¯ Ø¨Ø³ØªÙ†
    document.addEventListener('DOMContentLoaded', function() {
      if (window.sessionInfo && window.sessionInfo.active) {
        showSessionBubble();
      }
      document.getElementById('bubble-close').onclick = hideSessionBubble;
      document.getElementById('bubble-mini').onclick = expandMiniBubble;
    });
  </script>

  
  
  <div id="main-dashboard" class="page-section" style="position:relative;overflow:visible;">
    <div class="dashboard-cards" style="display:flex;justify-content:center;flex-wrap:wrap;gap:1rem;max-width:1400px;margin:0 auto;">
      <!-- AI Assistant will be inserted here by JavaScript -->

      <!-- Blockchain Information Cards -->
      <div class="dashboard-card" style="background:linear-gradient(135deg,#1a1f2e,#232946);border-radius:16px;box-shadow:0 4px 20px rgba(0,255,136,0.15);min-width:100%;max-width:100%;margin:1rem 0;width:100%;padding:1.5rem;position:relative;overflow:hidden;">
        <div style="position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,#00ff88,#a786ff,#00ff88);animation:shimmer 2s linear infinite;"></div>
        
        <div style="text-align:center;margin-bottom:1.5rem;">
          <h3 style="color:#00ff88;font-size:1.2rem;font-weight:bold;margin:0;font-family:monospace;">CONTINUOUS PROFIT ACADEMY</h3>
        </div>
        
        <!-- User Info Section -->
        <div id="dashboard-user-info" style="background:rgba(0,255,136,0.1);border-radius:12px;padding:1rem;margin-bottom:1rem;border:1px solid rgba(0,255,136,0.2);display:none;">
          <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:0.5rem;">
            <div style="text-align:center;flex:1;min-width:120px;">
              <div style="color:#00ff88;font-size:0.8rem;font-weight:bold;margin-bottom:0.3rem;">CPA ID</div>
              <div style="color:#fff;font-size:1rem;font-family:monospace;font-weight:bold;" id="dashboard-user-index">-</div>
            </div>
            <div style="text-align:center;flex:1;min-width:120px;">
              <div style="color:#00ff88;font-size:0.8rem;font-weight:bold;margin-bottom:0.3rem;">Ø¢Ø¯Ø±Ø³ Ú©ÛŒÙ Ù¾ÙˆÙ„</div>
              <div style="color:#fff;font-size:0.9rem;font-family:monospace;" id="dashboard-user-address">-</div>
            </div>
            <div style="text-align:center;flex:1;min-width:120px;">
              <div style="color:#00ff88;font-size:0.8rem;font-weight:bold;margin-bottom:0.3rem;">ÙˆØ¶Ø¹ÛŒØª</div>
              <div style="color:#00ff88;font-size:0.9rem;font-weight:bold;" id="dashboard-user-status">-</div>
            </div>
          </div>
        </div>
        
        <div style="display:flex;flex-wrap:wrap;gap:0.5rem;margin-bottom:1rem;justify-content:center;">
          <!-- Total Supply Card -->
          <div style="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid rgba(0,255,136,0.2);text-align:center;min-width:140px;flex:1;max-width:180px;">
            <div style="color:#00ff88;font-size:1.2rem;margin-bottom:0.3rem;">ğŸ’°</div>
            <div style="color:#fff;font-size:0.8rem;font-weight:bold;margin-bottom:0.2rem;">Ú©Ù„ Ø¹Ø±Ø¶Ù‡</div>
            <div style="color:#00ff88;font-size:0.9rem;font-family:monospace;font-weight:bold;" id="circulating-supply">-</div>
            <div style="color:#888;font-size:0.7rem;margin-top:0.2rem;">CPA Tokens</div>
          </div>
          
          <!-- Total Points Card -->
          <div style="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid rgba(167,134,255,0.2);text-align:center;min-width:140px;flex:1;max-width:180px;">
            <div style="color:#a786ff;font-size:1.2rem;margin-bottom:0.3rem;">ğŸ¯</div>
            <div style="color:#fff;font-size:0.8rem;font-weight:bold;margin-bottom:0.2rem;">Ú©Ù„ Ù¾ÙˆÛŒÙ†Øªâ€ŒÙ‡Ø§</div>
            <div style="color:#a786ff;font-size:0.9rem;font-family:monospace;font-weight:bold;" id="total-points">-</div>
            <div style="color:#888;font-size:0.7rem;margin-top:0.2rem;">Binary Points</div>
          </div>
          
          <!-- Contract Token Balance Card -->
          <div style="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid rgba(255,193,7,0.2);text-align:center;min-width:140px;flex:1;max-width:180px;">
            <div style="color:#ffc107;font-size:1.2rem;margin-bottom:0.3rem;">ğŸ¦</div>
            <div style="color:#fff;font-size:0.8rem;font-weight:bold;margin-bottom:0.2rem;">Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯</div>
            <div style="color:#ffc107;font-size:0.9rem;font-family:monospace;font-weight:bold;" id="contract-token-balance">-</div>
            <div style="color:#888;font-size:0.7rem;margin-top:0.2rem;">CPA in Contract</div>
          </div>
          
          <!-- Help Fund Card -->
          <div style="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid rgba(220,53,69,0.2);text-align:center;min-width:140px;flex:1;max-width:180px;">
            <div style="color:#dc3545;font-size:1.2rem;margin-bottom:0.3rem;">ğŸ’</div>
            <div style="color:#fff;font-size:0.8rem;font-weight:bold;margin-bottom:0.2rem;">ØµÙ†Ø¯ÙˆÙ‚ Ú©Ù…Ú©</div>
            <div style="color:#dc3545;font-size:0.9rem;font-family:monospace;font-weight:bold;" id="dashboard-cashback-value">-</div>
            <div style="color:#888;font-size:0.7rem;margin-top:0.2rem;">Cashback Pool</div>
          </div>
          
          <!-- DAI Contract Balance Card -->
          <div style="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid rgba(0,123,255,0.2);text-align:center;min-width:140px;flex:1;max-width:180px;">
            <div style="color:#007bff;font-size:1.2rem;margin-bottom:0.3rem;">ğŸ’µ</div>
            <div style="color:#fff;font-size:0.8rem;font-weight:bold;margin-bottom:0.2rem;">Ù…ÙˆØ¬ÙˆØ¯ÛŒ DAI</div>
            <div style="color:#007bff;font-size:0.9rem;font-family:monospace;font-weight:bold;" id="dashboard-dai-balance">-</div>
            <div style="color:#888;font-size:0.7rem;margin-top:0.2rem;">DAI in Contract</div>
          </div>
          
          <!-- Network Status Card -->
          <div style="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid rgba(40,167,69,0.2);text-align:center;min-width:140px;flex:1;max-width:180px;">
            <div style="color:#28a745;font-size:1.2rem;margin-bottom:0.3rem;">ğŸŒ</div>
            <div style="color:#fff;font-size:0.8rem;font-weight:bold;margin-bottom:0.2rem;">ÙˆØ¶Ø¹ÛŒØª Ø´Ø¨Ú©Ù‡</div>
            <div style="color:#28a745;font-size:0.9rem;font-family:monospace;font-weight:bold;" id="network-status">Polygon</div>
            <div style="color:#888;font-size:0.7rem;margin-top:0.2rem;">Active</div>
          </div>
          
          <!-- Point Value Card -->
          <div style="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid rgba(0,255,136,0.2);text-align:center;min-width:140px;flex:1;max-width:180px;">
            <div style="color:#00ff88;font-size:1.2rem;margin-bottom:0.3rem;">ğŸ’</div>
            <div style="color:#fff;font-size:0.8rem;font-weight:bold;margin-bottom:0.2rem;">Ø§Ø±Ø²Ø´ Ù‡Ø± Ù¾ÙˆÛŒÙ†Øª</div>
            <div style="color:#00ff88;font-size:0.9rem;font-family:monospace;font-weight:bold;" id="dashboard-point-value">-</div>
            <div style="color:#888;font-size:0.7rem;margin-top:0.2rem;">CPA per Point</div>
          </div>
          
          <!-- Token Price Card -->
          <div style="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid rgba(0,255,136,0.2);text-align:center;min-width:140px;flex:1;max-width:180px;">
            <div style="color:#00ff88;font-size:1.2rem;margin-bottom:0.3rem;">ğŸ’²</div>
            <div style="color:#fff;font-size:0.8rem;font-weight:bold;margin-bottom:0.2rem;">Ù‚ÛŒÙ…Øª ØªÙˆÚ©Ù† CPA</div>
            <div style="color:#00ff88;font-size:0.9rem;font-family:monospace;font-weight:bold;" id="dashboard-token-price">-</div>
            <div style="color:#888;font-size:0.7rem;margin-top:0.2rem;">DAI per CPA</div>
          </div>
          
          <!-- Wallet Count Card -->
          <div style="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid rgba(255,165,0,0.2);text-align:center;min-width:140px;flex:1;max-width:180px;">
            <div style="color:#ffa500;font-size:1.2rem;margin-bottom:0.3rem;">ğŸ‘›</div>
            <div style="color:#fff;font-size:0.8rem;font-weight:bold;margin-bottom:0.2rem;">ØªØ¹Ø¯Ø§Ø¯ ÙˆÙ„Øªâ€ŒÙ‡Ø§</div>
            <div style="color:#ffa500;font-size:0.9rem;font-family:monospace;font-weight:bold;" id="dashboard-wallets-count">-</div>
            <div style="color:#888;font-size:0.7rem;margin-top:0.2rem;">Connected Wallets</div>
          </div>
          
          <!-- Registration Price Card -->
          <div style="background:rgba(0,0,0,0.3);border-radius:12px;padding:0.8rem;border:1px solid rgba(138,43,226,0.2);text-align:center;min-width:140px;flex:1;max-width:180px;">
            <div style="color:#8a2be2;font-size:1.2rem;margin-bottom:0.3rem;">ğŸ«</div>
            <div style="color:#fff;font-size:0.8rem;font-weight:bold;margin-bottom:0.2rem;">Ù‚ÛŒÙ…Øª Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…</div>
            <div style="color:#8a2be2;font-size:0.9rem;font-family:monospace;font-weight:bold;" id="dashboard-registration-price">-</div>
            <div style="color:#888;font-size:0.7rem;margin-top:0.2rem;">CPA per Registration</div>
          </div>
        </div>
        
        <!-- Last Update Info -->
        <div style="text-align:center;margin-top:1rem;padding-top:1rem;border-top:1px solid rgba(255,255,255,0.1);">
          <div style="color:#888;font-size:0.8rem;font-family:monospace;margin-bottom:0.5rem;">
            Ø¢Ø®Ø±ÛŒÙ† Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ: <span id="blockchain-last-update">-</span>
          </div>
          <!-- Ø¯Ú©Ù…Ù‡ Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø­Ø°Ù Ø´Ø¯ -->
        </div>
        

      </div>

      <!-- Price Chart Section -->
      <div class="dashboard-card" id="price-chart-section" style="background:linear-gradient(135deg,#1a1f2e,#232946);border-radius:16px;box-shadow:0 4px 20px rgba(0,255,136,0.15);min-width:100%;max-width:100%;margin:1rem 0;width:100%;padding:1.5rem;position:relative;overflow:hidden;">
        <div style="position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,#00ff88,#a786ff,#00ff88);animation:shimmer 2s linear infinite;"></div>
        
        <!-- Current Prices Display -->
        <!-- Ø­Ø°Ù Ø´Ø¯: Ù†Ù…Ø§ÛŒØ´ Ù‚ÛŒÙ…Øª ØªÙˆÚ©Ù† Ùˆ Ù¾ÙˆÛŒÙ†Øª -->

        <!-- Token Chart Controls -->
        <div style="display:flex;justify-content:center;align-items:center;gap:0.5rem;margin-bottom:0.5rem;flex-wrap:wrap;">
          <select id="token-period-select" style="background:rgba(0,255,136,0.1);color:#00ff88;border:1px solid #00ff88;border-radius:6px;padding:0.4rem 1rem;font-size:0.9rem;font-family:monospace;cursor:pointer;">
            <option value="day">Day (24h)</option>
            <option value="week">Week (7d)</option>
            <option value="month">Month (30d)</option>
            <option value="year">Year (12m)</option>
          </select>
          <div style="text-align:center;padding:0.3rem 0.8rem;background:rgba(0,0,0,0.3);border-radius:6px;border:1px solid rgba(0,255,136,0.2);min-width:120px;">
            <div style="color:#00ff88;font-size:0.8rem;font-family:monospace;">Token Min: <span id="token-min-price" style="color:#fff;">-</span></div>
          </div>
          <div style="text-align:center;padding:0.3rem 0.8rem;background:rgba(0,0,0,0.3);border-radius:6px;border:1px solid rgba(0,255,136,0.2);min-width:120px;">
            <div style="color:#00ff88;font-size:0.8rem;font-family:monospace;">Token Max: <span id="token-max-price" style="color:#fff;">-</span></div>
          </div>
        </div>
        
        <!-- Token Chart Container -->
        <div style="background:rgba(0,0,0,0.3);border-radius:8px;padding:0.8rem;border:1px solid rgba(0,255,136,0.2);width:100%;max-width:100%;margin-bottom:1rem;">
          <div style="color:#00ff88;font-size:0.9rem;font-weight:bold;text-align:center;margin-bottom:0.3rem;font-family:monospace;">Token Price Chart</div>
          <canvas id="price-chart-canvas" style="width:100% !important;height:180px !important;border-radius:4px;max-width:100%;"></canvas>
        </div>
        
        <!-- Point Chart Controls -->
        <div style="display:flex;justify-content:center;align-items:center;gap:0.5rem;margin-bottom:0.5rem;flex-wrap:wrap;">
          <select id="point-period-select" style="background:rgba(167,134,255,0.1);color:#a786ff;border:1px solid #a786ff;border-radius:6px;padding:0.4rem 1rem;font-size:0.9rem;font-family:monospace;cursor:pointer;">
            <option value="day">Day (24h)</option>
            <option value="week">Week (7d)</option>
            <option value="month">Month (30d)</option>
            <option value="year">Year (12m)</option>
          </select>
          <div style="text-align:center;padding:0.3rem 0.8rem;background:rgba(0,0,0,0.3);border-radius:6px;border:1px solid rgba(167,134,255,0.2);min-width:120px;">
            <div style="color:#a786ff;font-size:0.8rem;font-family:monospace;">Point Min: <span id="point-min-price" style="color:#fff;">-</span></div>
          </div>
          <div style="text-align:center;padding:0.3rem 0.8rem;background:rgba(0,0,0,0.3);border-radius:6px;border:1px solid rgba(167,134,255,0.2);min-width:120px;">
            <div style="color:#a786ff;font-size:0.8rem;font-family:monospace;">Point Max: <span id="point-max-price" style="color:#fff;">-</span></div>
          </div>
        </div>
        
        <!-- Point Chart Container -->
        <div style="background:rgba(0,0,0,0.3);border-radius:8px;padding:0.8rem;border:1px solid rgba(167,134,255,0.2);width:100%;max-width:100%;">
          <div style="color:#a786ff;font-size:0.9rem;font-weight:bold;text-align:center;margin-bottom:0.3rem;font-family:monospace;">Point Value Chart</div>
          <canvas id="point-chart-canvas" style="width:100% !important;height:180px !important;border-radius:4px;max-width:100%;"></canvas>
        </div>
        

        

      </div>

      <!-- Buttons Row for Main Sections -->
      <!-- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ù¾Ù†Ø¬â€ŒÚ¯Ø§Ù†Ù‡ Ø­Ø°Ù Ø´Ø¯Ù†Ø¯ØŒ ÙÙ‚Ø· Ù†ÙˆØ§Ø± Ù¾Ø§ÛŒÛŒÙ† ÙØ¹Ø§Ù„ Ø§Ø³Øª -->

      <!-- CPA Introduction Section -->
      <div class="cpa-intro-section" style="background:linear-gradient(135deg,#181c2a,#232946);border-radius:18px;box-shadow:0 4px 24px rgba(0,255,136,0.10);margin:2rem 0 1.5rem 0;padding:2.2rem 1.5rem;max-width:900px;width:100%;margin-left:auto;margin-right:auto;direction:rtl;">
        <h2 style="color:#00ff88;font-family:'Montserrat','Noto Sans Arabic',sans-serif;font-size:1.5rem;font-weight:bold;margin-bottom:1.2rem;text-align:center;">Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ø¢Ú©Ø§Ø¯Ù…ÛŒ Ø³ÙˆØ¯ Ù…Ø³ØªÙ…Ø± (CPA)</h2>
        <div id="cpa-typewriter-wrapper" style="position:relative;max-height:2.1em;overflow:hidden;transition:max-height 0.5s cubic-bezier(.4,2,.6,1);">
          <div id="cpa-typewriter" style="color:#fff;font-size:1.08rem;line-height:2.1;text-align:justify;min-height:220px;"></div>
          <div id="cpa-fade" style="position:absolute;left:0;right:0;bottom:0;height:70px;background:linear-gradient(0deg,#181c2a 80%,rgba(35,41,70,0.01) 100%);pointer-events:none;transition:opacity 0.3s;"></div>
        </div>
        <div style="text-align:center;margin-top:1.2rem;">
          <button id="cpa-expand-btn" style="background:linear-gradient(90deg,#00ff88,#a786ff);color:#181c2a;font-weight:bold;border:none;border-radius:8px;padding:0.7rem 2.2rem;font-size:1rem;cursor:pointer;box-shadow:0 2px 12px rgba(0,255,136,0.10);transition:background 0.2s,box-shadow 0.2s;">Ù†Ù…Ø§ÛŒØ´ Ø¨ÛŒØ´ØªØ±</button>
        </div>
      </div>
      <script>
      document.addEventListener('DOMContentLoaded', function() {
        const text = `Ø¢Ú©Ø§Ø¯Ù…ÛŒ Ø³ÙˆØ¯ Ù…Ø³ØªÙ…Ø± (CPA) ÛŒÚ© Ø§Ú©ÙˆØ³ÛŒØ³ØªÙ… Ù†ÙˆØ¢ÙˆØ±Ø§Ù†Ù‡ Ùˆ Ù…Ø±Ø¯Ù…â€ŒÙ…Ø­ÙˆØ± Ø§Ø³Øª Ú©Ù‡ Ø¨Ø§ Ù‡Ø¯Ù Ø§Ø±Ø§Ø¦Ù‡ Ø®Ø¯Ù…Ø§Øª Ù…Ø§Ù„ÛŒØŒ Ø¢Ù…ÙˆØ²Ø´ÛŒ Ùˆ Ù…Ø¹Ø§Ù…Ù„Ø§ØªÛŒ Ú©Ø§Ù…Ù„Ø§Ù‹ ØºÛŒØ±Ù…ØªÙ…Ø±Ú©Ø² Ùˆ Ø´ÙØ§ÙØŒ Ø¨Ù†ÛŒØ§Ù† Ù†Ù‡Ø§Ø¯Ù‡ Ø´Ø¯Ù‡ Ø§Ø³Øª. Ø¯Ø± Ø§ÛŒÙ† Ù…Ø¬Ù…ÙˆØ¹Ù‡ØŒ Ø³Ø±Ù…Ø§ÛŒÙ‡ Ø´Ù…Ø§ Ù‡Ù…ÛŒØ´Ù‡ Ø¯Ø± Ø§Ø®ØªÛŒØ§Ø± Ø®ÙˆØ¯ØªØ§Ù† Ø¨Ø§Ù‚ÛŒ Ù…ÛŒâ€ŒÙ…Ø§Ù†Ø¯Ø› Ú†Ù‡ Ø¯Ø± Ø­Ø³Ø§Ø¨ Ø´Ø®ØµÛŒâ€ŒØªØ§Ù† Ø¯Ø± ØµØ±Ø§ÙÛŒØŒ Ú†Ù‡ Ø¯Ø± Ø¨Ø±ÙˆÚ©Ø±ØŒ Ùˆ Ú†Ù‡ Ø¯Ø± Ú©ÛŒÙ Ù¾ÙˆÙ„ Ù‡ÙˆØ´Ù…Ù†Ø¯ Ù…ØªØµÙ„ Ø¨Ù‡ Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ ØºÛŒØ±Ù…ØªÙ…Ø±Ú©Ø².\n\nØ®Ø¯Ù…Ø§Øª Ù…Ø§:\nâ€¢ Ø§Ø±Ø§Ø¦Ù‡ Ø³ÛŒÚ¯Ù†Ø§Ù„â€ŒÙ‡Ø§ÛŒ ØªØ®ØµØµÛŒ Ùˆ Ø±Ø¨Ø§Øªâ€ŒÙ‡Ø§ÛŒ Ø§ØªÙˆØªØ±ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø±Ù‡Ø§ÛŒ Ù…Ø§Ù„ÛŒ\nâ€¢ Ø§Ù…Ú©Ø§Ù† ÙØ¹Ø§Ù„ÛŒØª Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† Ø§ÛŒØ¬Ù†Øª Ø¨Ø±Ø§ÛŒ Ø§ÙØ±Ø§Ø¯ Ùˆ IB Ø¯Ø± Ø¨Ø±ÙˆÚ©Ø±Ù‡Ø§\nâ€¢ Ø§Ù…Ú©Ø§Ù† Ø¨Ø§Ø²Ø§Ø±ÛŒØ§Ø¨ÛŒ Ø´Ø¨Ú©Ù‡â€ŒØ§ÛŒ Ø¨Ø±Ø§ÛŒ Ø¯ÙˆØ³ØªØ§Ù†ÛŒ Ú©Ù‡ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡Ù†Ø¯ Ø§ÛŒÙ† Ù…Ø¬Ù…ÙˆØ¹Ù‡ Ø±Ø§ Ø§Ø±ØªÙ‚Ø§ Ø¯Ù‡Ù†Ø¯\nâ€¢ Ø´Ù…Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø§Ø² Ø³Ù‡Ø§Ù…â€ŒÙ‡Ø§ÛŒ Ù…Ø¹Ø±ÙÛŒ Ø§ÙØ±Ø§Ø¯ (Referral Shares) Ø¨Ù‡Ø±Ù‡â€ŒÙ…Ù†Ø¯ Ø´ÙˆÛŒØ¯.\nâ€¢ Ù‡Ù…Ú†Ù†ÛŒÙ† Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¨Ø§ Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒ Ø¯Ø± ØµÙ†Ø¯ÙˆÙ‚ CPA Ùˆ ØªÙˆÚ©Ù† Ø§ÙØ²Ø§ÛŒØ´ÛŒ Ø¢Ù†ØŒ Ø¨Ù‡ ØµÙˆØ±Øª ØªØ¶Ù…ÛŒÙ†ÛŒ Ø¨Ù‡ Ø³ÙˆØ¯ Ø¨Ø±Ø³ÛŒØ¯.\nâ€¢ Ø¢Ù…ÙˆØ²Ø´â€ŒÙ‡Ø§ÛŒ Ø¬Ø§Ù…Ø¹ ÙØ§Ø±Ú©Ø³ Ùˆ Ø§Ø±Ø² Ø¯ÛŒØ¬ÛŒØªØ§Ù„\nâ€¢ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² ØµÙ†Ø¯ÙˆÙ‚ ØºÛŒØ±Ù…ØªÙ…Ø±Ú©Ø² CPA Ùˆ ØªÙˆÚ©Ù† CPA\nâ€¢ Ø®Ø¯Ù…Ø§Øª Ú©Ù¾ÛŒâ€ŒØªØ±ÛŒØ¯: Ø§Ú¯Ø± Ø±Ø¨Ø§Øª CPA Ø³ÙˆØ¯ Ú©Ù†Ø¯ØŒ Ø´Ù…Ø§ Ù‡Ù… Ø³ÙˆØ¯ Ù…ÛŒâ€ŒÚ©Ù†ÛŒØ¯ Ùˆ Ø§Ú¯Ø± Ø¶Ø±Ø± Ú©Ù†Ø¯ØŒ Ø´Ù…Ø§ Ù†ÛŒØ² Ø¶Ø±Ø± Ù…ÛŒâ€ŒÚ©Ù†ÛŒØ¯Ø› Ù‡ÛŒÚ† Ø³ÙˆØ¯ÛŒ Ø§Ø² Ø­Ø³Ø§Ø¨ Ø´Ù…Ø§ Ø¯Ø± Ø²Ù…Ø§Ù† Ø¶Ø±Ø± Ø¨Ø±Ø¯Ø§Ø´Øª Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯ Ùˆ ØªØ§ Ø¬Ø¨Ø±Ø§Ù† Ø¶Ø±Ø±ØŒ CPA Ø³Ù‡Ù…ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯.\nâ€¢ Ø´Ø¹Ø§Ø± Ù…Ø§: Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒØ§Øª Ø¯Ø± Ø­Ø³Ø§Ø¨ Ø®ÙˆØ¯ØªØŒ Ø³ÙˆØ¯Øª ÙˆØ§Ù‚Ø¹ÛŒ Ùˆ Ø´ÙØ§Ù\n\nØµØ¯Ø§Ù‚ØªØŒ Ø´ÙØ§ÙÛŒØª Ùˆ Ø®Ø¯Ù…Ø§Øª ØµØ¯Ø¯Ø±ØµØ¯ÛŒØŒ Ø§ØµÙˆÙ„ Ø¨Ù†ÛŒØ§Ø¯ÛŒÙ† Ù…Ø§Ø³Øª. Ù‡ÛŒÚ†â€ŒÚ¯Ø§Ù‡ Ø³Ø±Ù…Ø§ÛŒÙ‡ Ø´Ù…Ø§ Ø¨Ù‡ Ø­Ø³Ø§Ø¨ CPA Ù…Ù†ØªÙ‚Ù„ Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯Ø› Ø¨Ù„Ú©Ù‡ Ø´Ù…Ø§ Ù‡Ù…ÙˆØ§Ø±Ù‡ Ú©Ù†ØªØ±Ù„ Ú©Ø§Ù…Ù„ Ø¯Ø§Ø±Ø§ÛŒÛŒ Ø®ÙˆØ¯ Ø±Ø§ Ø¯Ø§Ø±ÛŒØ¯ Ùˆ ØªÙ†Ù‡Ø§ Ø¯Ø± Ø³ÙˆØ¯ ÙˆØ§Ù‚Ø¹ÛŒ Ø´Ø±ÛŒÚ© Ù‡Ø³ØªÛŒÙ…. Ø¯Ø± Ø¯Ù†ÛŒØ§ÛŒÛŒ Ú©Ù‡ Ø¨Ø³ÛŒØ§Ø±ÛŒ Ø¨Ù‡ Ø¯Ù†Ø¨Ø§Ù„ Ø¬Ø°Ø¨ Ø³Ø±Ù…Ø§ÛŒÙ‡ Ù…Ø±Ø¯Ù… Ùˆ Ø§Ø±Ø§Ø¦Ù‡ ÙˆØ¹Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ØªÙˆØ®Ø§Ù„ÛŒ Ù‡Ø³ØªÙ†Ø¯ØŒ Ù…Ø§ Ø¯Ø± CPA ØªÙ†Ù‡Ø§ Ø²Ù…Ø§Ù†ÛŒ Ø³ÙˆØ¯ Ù…ÛŒâ€ŒØ¨Ø±ÛŒÙ… Ú©Ù‡ Ø´Ù…Ø§ ÙˆØ§Ù‚Ø¹Ø§Ù‹ Ø³ÙˆØ¯ Ú©Ù†ÛŒØ¯ Ùˆ Ø¯Ø± Ø²ÛŒØ§Ù†ØŒ Ø´Ø±ÛŒÚ© Ùˆ Ù‡Ù…Ø±Ø§Ù‡ Ø´Ù…Ø§ Ø®ÙˆØ§Ù‡ÛŒÙ… Ø¨ÙˆØ¯.\n\nCPAØ› Ø§Ù†ØªØ®Ø§Ø¨ÛŒ Ø¨Ø±Ø§ÛŒ Ø¢ÛŒÙ†Ø¯Ù‡â€ŒØ§ÛŒ Ù…Ø·Ù…Ø¦Ù†ØŒ Ø´ÙØ§Ù Ùˆ Ù…Ø±Ø¯Ù…â€ŒÙ…Ø­ÙˆØ±.`;
        const container = document.getElementById('cpa-typewriter');
        let i = 0;
        let speed = 40; // ms per character (slower)
        function typeWriter() {
          if (i < text.length) {
            let char = text.charAt(i);
            if (char === '\\n' || char === '\n') {
              container.innerHTML += '<br>';
              i++;
              setTimeout(typeWriter, 350); // longer pause for line breaks
            } else {
              container.innerHTML += char;
              i++;
              setTimeout(typeWriter, speed);
            }
          }
        }
        typeWriter();

        // Expand/collapse logic
        const wrapper = document.getElementById('cpa-typewriter-wrapper');
        const fade = document.getElementById('cpa-fade');
        const btn = document.getElementById('cpa-expand-btn');
        let expanded = false;
        btn.addEventListener('click', function() {
          expanded = !expanded;
          if (expanded) {
            wrapper.style.maxHeight = '2000px';
            fade.style.opacity = '0';
            btn.textContent = 'Ù†Ù…Ø§ÛŒØ´ Ú©Ù…ØªØ±';
          } else {
            wrapper.style.maxHeight = '2.1em';
            fade.style.opacity = '1';
            btn.textContent = 'Ù†Ù…Ø§ÛŒØ´ Ø¨ÛŒØ´ØªØ±';
          }
        });
      });
      </script>

  <!-- Swap Section -->
  <div id="main-swap" class="page-section expandable-container" style="width:100vw;max-width:none;margin:0;left:0;right:0;padding:0.5rem 0;display:none;">
    <div class="expand-header" style="padding:0 1.5rem;">
      <h2 style="margin:0 0 0.5rem 0;">ğŸ”„ ØªØ¨Ø¯ÛŒÙ„ Ø§Ø±Ø²</h2>
      <p style="margin:0 0 0.5rem 0;">ØªØ¨Ø¯ÛŒÙ„ Ø¨ÛŒÙ† ØªÙˆÚ©Ù†â€ŒÙ‡Ø§ÛŒ DAI Ùˆ CPA</p>
    </div>
    <div class="expand-content" style="padding:0;">
      <div class="swap-container" style="max-width:600px;margin:0 auto;padding:1.5rem;">
        
        <!-- Swap Rules and Information -->
        <div style="background:linear-gradient(135deg,#232946,#181c2a);border-radius:12px;padding:1.5rem;margin-bottom:1.5rem;border:2px solid #00ff88;">
          <h3 style="color:#00ff88;margin-bottom:1rem;font-size:1.2rem;">ğŸ“‹ Ù‚ÙˆØ§Ù†ÛŒÙ† Ùˆ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ ØªØ¨Ø¯ÛŒÙ„</h3>
          
          <div style="margin-bottom:1rem;">
            <h4 style="color:#00ff88;margin-bottom:0.5rem;">ğŸ”„ Ù†Ø­ÙˆÙ‡ ØªØ¨Ø¯ÛŒÙ„:</h4>
            <ul style="color:#b8c1ec;line-height:1.6;margin:0;padding-right:1rem;">
              <li>âœ… <strong style="color:#00ff88;">DAI â†’ CPA:</strong> Ø®Ø±ÛŒØ¯ ØªÙˆÚ©Ù† CPA Ø¨Ø§ DAI (Ù†Ø±Ø® Ù…ØªØºÛŒØ±)</li>
              <li>âœ… <strong style="color:#00ff88;">CPA â†’ DAI:</strong> ÙØ±ÙˆØ´ ØªÙˆÚ©Ù† CPA Ùˆ Ø¯Ø±ÛŒØ§ÙØª DAI</li>
              <li>âœ… Ú©Ø§Ø±Ù…Ø²Ø¯ ØªØ¨Ø¯ÛŒÙ„: 2% Ø§Ø² Ù…Ø¨Ù„Øº ØªØ¨Ø¯ÛŒÙ„</li>
              <li>âœ… Ø­Ø¯Ø§Ù‚Ù„ Ù…Ù‚Ø¯Ø§Ø± ØªØ¨Ø¯ÛŒÙ„: 1 DAI ÛŒØ§ 1 CPA</li>
            </ul>
          </div>
          
          <div style="margin-bottom:1rem;">
            <h4 style="color:#00ff88;margin-bottom:0.5rem;">ğŸ’° Ù…Ø²Ø§ÛŒØ§ÛŒ ØªØ¨Ø¯ÛŒÙ„:</h4>
            <ul style="color:#b8c1ec;line-height:1.6;margin:0;padding-right:1rem;">
              <li><strong style="color:#00ff88;">CPA:</strong> ØªÙˆÚ©Ù† Ø§ØµÙ„ÛŒ Ù¾Ù„ØªÙØ±Ù… - Ø¨Ø±Ø§ÛŒ Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒ Ùˆ Ú©Ø³Ø¨ Ø¯Ø±Ø¢Ù…Ø¯</li>
              <li><strong style="color:#00ccff;">DAI:</strong> ØªÙˆÚ©Ù† Ø§Ø³ØªÛŒØ¨Ù„ - Ø¨Ø±Ø§ÛŒ Ø­ÙØ¸ Ø§Ø±Ø²Ø´ Ùˆ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø±ÙˆØ²Ø§Ù†Ù‡</li>
              <li>ğŸ”„ ØªØ¨Ø¯ÛŒÙ„ ÙÙˆØ±ÛŒ Ùˆ Ø¨Ø¯ÙˆÙ† Ù†ÛŒØ§Ø² Ø¨Ù‡ ØªØ§ÛŒÛŒØ¯ Ø§Ø¶Ø§ÙÛŒ</li>
              <li>ğŸ“Š Ù†Ø±Ø® ØªØ¨Ø¯ÛŒÙ„ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø¹Ø±Ø¶Ù‡ Ùˆ ØªÙ‚Ø§Ø¶Ø§ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯</li>
            </ul>
          </div>
          
          <div>
            <h4 style="color:#00ff88;margin-bottom:0.5rem;">âš ï¸ Ù†Ú©Ø§Øª Ù…Ù‡Ù…:</h4>
            <ul style="color:#b8c1ec;line-height:1.6;margin:0;padding-right:1rem;">
              <li>ğŸ” Ù‚Ø¨Ù„ Ø§Ø² ØªØ¨Ø¯ÛŒÙ„ØŒ Ù†Ø±Ø® ÙØ¹Ù„ÛŒ Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯</li>
              <li>ğŸ’° Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ø§ÙÛŒ Ø¨Ø±Ø§ÛŒ ØªØ¨Ø¯ÛŒÙ„ + Ú©Ø§Ø±Ù…Ø²Ø¯ Ø¯Ø§Ø´ØªÙ‡ Ø¨Ø§Ø´ÛŒØ¯</li>
              <li>â±ï¸ ØªØ¨Ø¯ÛŒÙ„â€ŒÙ‡Ø§ ÙÙˆØ±ÛŒ Ø§Ù†Ø¬Ø§Ù… Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯</li>
              <li>ğŸ“ Ø¯Ø± ØµÙˆØ±Øª Ù…Ø´Ú©Ù„ Ø¨Ø§ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ ØªÙ…Ø§Ø³ Ø¨Ú¯ÛŒØ±ÛŒØ¯</li>
            </ul>
          </div>
        </div>
        <!-- Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨Ù„Ø§Ú©Ú†ÛŒÙ† (Ø§ÙØ²ÙˆØ¯Ù‡ Ø´Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø®Ø·Ø§Ù‡Ø§ÛŒ not found) -->
<div id="main-dashboard">
  <div style="display:flex;flex-wrap:wrap;gap:16px;margin-bottom:24px;">
    <div><b>CPA Ø¯Ø± Ú¯Ø±Ø¯Ø´:</b> <span id="circulating-supply">...</span></div>
    <div><b>Ø§Ù…ØªÛŒØ§Ø² Ú©Ù„:</b> <span id="total-points">...</span></div>
    <div><b>Ù…ÙˆØ¬ÙˆØ¯ÛŒ CPA Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯:</b> <span id="contract-token-balance">...</span></div>
    <div><b>Ú©ÙØ´â€ŒØ¨ÙÚ©:</b> <span id="dashboard-cashback-value">...</span></div>
    <div><b>Ù…ÙˆØ¬ÙˆØ¯ÛŒ DAI Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯:</b> <span id="dashboard-dai-balance">...</span></div>
    <div><b>Ø§Ø±Ø²Ø´ Ù‡Ø± Ø§Ù…ØªÛŒØ§Ø²:</b> <span id="dashboard-point-value">...</span></div>
    <div><b>Ù‚ÛŒÙ…Øª ØªÙˆÚ©Ù†:</b> <span id="dashboard-token-price">...</span></div>
    <div><b>ØªØ¹Ø¯Ø§Ø¯ Ú©ÛŒÙ Ù¾ÙˆÙ„â€ŒÙ‡Ø§:</b> <span id="dashboard-wallets-count">...</span></div>
    <div><b>Ù‡Ø²ÛŒÙ†Ù‡ Ø«Ø¨Øªâ€ŒÙ†Ø§Ù…:</b> <span id="dashboard-registration-price">...</span></div>
    <div><b>Ø¢Ø®Ø±ÛŒÙ† Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ:</b> <span id="blockchain-last-update">...</span></div>
  </div>
</div>
        <form id="swapForm" class="swap-form">
          <div class="swap-row">
            <label for="swapDirection">Ù†ÙˆØ¹ ØªØ¨Ø¯ÛŒÙ„:</label>
            <select id="swapDirection" required>
              <option value="dai-to-cpa">DAI â†’ CPA</option>
              <option value="cpa-to-dai">CPA â†’ DAI</option>
            </select>
            <small style="color:#b8c1ec;font-size:0.85rem;margin-top:0.3rem;display:block;">Ù†ÙˆØ¹ ØªØ¨Ø¯ÛŒÙ„ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</small>
          </div>
          
          <div class="swap-row">
            <label for="swapAmount">Ù…Ù‚Ø¯Ø§Ø±:</label>
            <div class="amount-input-group">
              <input type="number" id="swapAmount" placeholder="Ù…Ù‚Ø¯Ø§Ø± Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯" min="0" step="any" required>
              <button type="button" id="maxBtn" class="max-btn">Ø­Ø¯Ø§Ú©Ø«Ø±</button>
            </div>
            <small style="color:#b8c1ec;font-size:0.85rem;margin-top:0.3rem;display:block;">Ù…Ù‚Ø¯Ø§Ø± Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ø¨Ø±Ø§ÛŒ ØªØ¨Ø¯ÛŒÙ„ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯</small>
          </div>
          
          <div id="swapRate" class="swap-rate">Ù†Ø±Ø® ØªØ¨Ø¯ÛŒÙ„: Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</div>
          <div id="swapPreview" class="swap-preview"></div>
          <div id="swapLimitInfo" class="swap-limit-info" style="margin-top:0.5rem;color:#555;font-size:0.98em;"></div>
          
          <button type="submit" class="swap-btn">ØªØ¨Ø¯ÛŒÙ„</button>
          <div id="swapStatus" class="swap-status"></div>
        </form>
        
        <!-- Balance Check -->
        <div style="background:rgba(0,255,136,0.1);border-radius:8px;padding:1rem;margin-top:1.5rem;">
          <h4 style="color:#00ff88;margin-bottom:0.8rem;">ğŸ’° Ù…ÙˆØ¬ÙˆØ¯ÛŒ ÙØ¹Ù„ÛŒ Ø´Ù…Ø§:</h4>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem;">
            <div style="text-align:center;">
              <div style="color:#00ff88;font-weight:bold;">DAI</div>
              <div id="daiBalance" style="color:#b8c1ec;font-family:monospace;">-</div>
            </div>
            <div style="text-align:center;">
              <div style="color:#00ccff;font-weight:bold;">CPA</div>
              <div id="cpaBalance" style="color:#b8c1ec;font-family:monospace;">-</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Transfer Section -->
  <div id="main-transfer" class="page-section expandable-container" style="width:100vw;max-width:none;margin:0;left:0;right:0;padding:0.5rem 0;display:none;">
    <div class="expand-header">
      <h2 style="margin:0 0 0.5rem 0;">ğŸ’¸ ØªØ±Ø§Ù†Ø³ÙØ±</h2>
      <p style="margin:0 0 0.5rem 0;">Ø§Ù†ØªÙ‚Ø§Ù„ ØªÙˆÚ©Ù† Ø¨Ù‡ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø¯ÛŒÚ¯Ø±</p>
    </div>
    <div class="expand-content" style="padding:0;">
      <div class="transfer-container" style="max-width:600px;margin:0 auto;padding:1.5rem;">
        
        <!-- Transfer Rules and Information -->
        <div style="background:linear-gradient(135deg,#232946,#181c2a);border-radius:12px;padding:1.5rem;margin-bottom:1.5rem;border:2px solid #a786ff;">
          <h3 style="color:#00ff88;margin-bottom:1rem;font-size:1.2rem;">ğŸ“‹ Ù‚ÙˆØ§Ù†ÛŒÙ† Ùˆ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø§Ù†ØªÙ‚Ø§Ù„</h3>
          
          <div style="margin-bottom:1rem;">
            <h4 style="color:#a786ff;margin-bottom:0.5rem;">ğŸ”’ Ø§Ù…Ù†ÛŒØª Ø§Ù†ØªÙ‚Ø§Ù„:</h4>
            <ul style="color:#b8c1ec;line-height:1.6;margin:0;padding-right:1rem;">
              <li>âœ… Ø§Ù†ØªÙ‚Ø§Ù„â€ŒÙ‡Ø§ ØºÛŒØ±Ù‚Ø§Ø¨Ù„ Ø¨Ø§Ø²Ú¯Ø´Øª Ù‡Ø³ØªÙ†Ø¯ - Ù‚Ø¨Ù„ Ø§Ø² Ø§Ø±Ø³Ø§Ù„ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯</li>
              <li>âœ… Ø¢Ø¯Ø±Ø³ Ù…Ù‚ØµØ¯ Ø±Ø§ Ø¨Ø§ Ø¯Ù‚Øª ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯ - ÛŒÚ© Ú©Ø§Ø±Ø§Ú©ØªØ± Ø§Ø´ØªØ¨Ø§Ù‡ Ø¨Ø§Ø¹Ø« Ø§Ø² Ø¯Ø³Øª Ø±ÙØªÙ† Ø¯Ø§Ø±Ø§ÛŒÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯</li>
              <li>âœ… Ø§Ø¨ØªØ¯Ø§ Ù…Ù‚Ø¯Ø§Ø± Ú©Ù…ÛŒ Ø§Ø±Ø³Ø§Ù„ Ú©Ù†ÛŒØ¯ ØªØ§ Ø§Ø² ØµØ­Øª Ø¢Ø¯Ø±Ø³ Ù…Ø·Ù…Ø¦Ù† Ø´ÙˆÛŒØ¯</li>
              <li>âœ… Ø§Ø² Ú©ÛŒÙ Ù¾ÙˆÙ„â€ŒÙ‡Ø§ÛŒ Ù…Ø¹ØªØ¨Ø± Ùˆ Ø§Ù…Ù† Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯</li>
            </ul>
          </div>
          
          <div style="margin-bottom:1rem;">
            <h4 style="color:#a786ff;margin-bottom:0.5rem;">ğŸ’° Ø§Ù†ÙˆØ§Ø¹ ØªÙˆÚ©Ù† Ù‚Ø§Ø¨Ù„ Ø§Ù†ØªÙ‚Ø§Ù„:</h4>
            <ul style="color:#b8c1ec;line-height:1.6;margin:0;padding-right:1rem;">
              <li><strong style="color:#00ff88;">DAI:</strong> ØªÙˆÚ©Ù† Ø§Ø³ØªÛŒØ¨Ù„ Ø¨Ø§ Ø§Ø±Ø²Ø´ 1 Ø¯Ù„Ø§Ø± - Ø¨Ø±Ø§ÛŒ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø±ÙˆØ²Ø§Ù†Ù‡</li>
              <li><strong style="color:#a786ff;">POL (MATIC):</strong> ØªÙˆÚ©Ù† Ø´Ø¨Ú©Ù‡ Polygon - Ø¨Ø±Ø§ÛŒ Ù¾Ø±Ø¯Ø§Ø®Øª Ú©Ø§Ø±Ù…Ø²Ø¯ ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§</li>
              <li><strong style="color:#00ccff;">CPA:</strong> ØªÙˆÚ©Ù† Ø§ØµÙ„ÛŒ Ù¾Ù„ØªÙØ±Ù… - Ø¨Ø±Ø§ÛŒ Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒ Ùˆ Ú©Ø³Ø¨ Ø¯Ø±Ø¢Ù…Ø¯</li>
            </ul>
          </div>
          
          <div style="margin-bottom:1rem;">
            <h4 style="color:#a786ff;margin-bottom:0.5rem;">âš¡ Ú©Ø§Ø±Ù…Ø²Ø¯ ØªØ±Ø§Ú©Ù†Ø´:</h4>
            <ul style="color:#b8c1ec;line-height:1.6;margin:0;padding-right:1rem;">
              <li>ğŸ’¸ Ú©Ø§Ø±Ù…Ø²Ø¯ Ø´Ø¨Ú©Ù‡ Polygon: ~0.001-0.01 MATIC (Ø¨Ø³ØªÙ‡ Ø¨Ù‡ ØªØ±Ø§ÙÛŒÚ© Ø´Ø¨Ú©Ù‡)</li>
              <li>â±ï¸ Ø²Ù…Ø§Ù† ØªØ§ÛŒÛŒØ¯: 2-5 Ø«Ø§Ù†ÛŒÙ‡ (Ù…Ø¹Ù…ÙˆÙ„Ø§Ù‹)</li>
              <li>ğŸ” ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§ Ø¯Ø± PolygonScan Ù‚Ø§Ø¨Ù„ Ø±Ø¯ÛŒØ§Ø¨ÛŒ Ù‡Ø³ØªÙ†Ø¯</li>
            </ul>
          </div>
          
          <div>
            <h4 style="color:#a786ff;margin-bottom:0.5rem;">ğŸ¯ Ù†Ú©Ø§Øª Ù…Ù‡Ù…:</h4>
            <ul style="color:#b8c1ec;line-height:1.6;margin:0;padding-right:1rem;">
              <li>ğŸ“± Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¨Ø§ Ø§ÛŒÙ†Ø¯Ú©Ø³ Ú©Ø§Ø±Ø¨Ø± Ø¬Ø³ØªØ¬Ùˆ Ú©Ù†ÛŒØ¯ ØªØ§ Ø¢Ø¯Ø±Ø³ Ø±Ø§ Ù¾ÛŒØ¯Ø§ Ú©Ù†ÛŒØ¯</li>
              <li>ğŸ” Ù‚Ø¨Ù„ Ø§Ø² Ø§Ù†ØªÙ‚Ø§Ù„ØŒ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø®ÙˆØ¯ Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯</li>
              <li>âš ï¸ Ù…Ù‚Ø¯Ø§Ø± Ø§Ù†ØªÙ‚Ø§Ù„ + Ú©Ø§Ø±Ù…Ø²Ø¯ Ø´Ø¨Ú©Ù‡ Ø¨Ø§ÛŒØ¯ Ú©Ù…ØªØ± Ø§Ø² Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø¨Ø§Ø´Ø¯</li>
              <li>ğŸ“ Ø¯Ø± ØµÙˆØ±Øª Ù…Ø´Ú©Ù„ Ø¨Ø§ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ ØªÙ…Ø§Ø³ Ø¨Ú¯ÛŒØ±ÛŒØ¯</li>
            </ul>
          </div>
        </div>
        
        <form id="transferForm" class="transfer-form">
          <div class="transfer-row">
            <label for="transferTo">Ø¢Ø¯Ø±Ø³ Ù…Ù‚ØµØ¯:</label>
            <input type="text" id="transferTo" placeholder="0x..." required style="direction:ltr;">
            <small style="color:#b8c1ec;font-size:0.85rem;margin-top:0.3rem;display:block;">Ø¢Ø¯Ø±Ø³ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ù…Ù‚ØµØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯ (42 Ú©Ø§Ø±Ø§Ú©ØªØ±)</small>
          </div>
          <div class="transfer-row" style="margin-bottom:0.5rem;">
            <label for="searchIndex">Ø¬Ø³ØªØ¬Ùˆ Ø¨Ø§ Ø§ÛŒÙ†Ø¯Ú©Ø³:</label>
            <div style="display:flex;gap:0.5rem;align-items:center;">
              <input type="number" id="searchIndex" placeholder="Ø§ÛŒÙ†Ø¯Ú©Ø³ Ú©Ø§Ø±Ø¨Ø±" min="0" style="width:120px;direction:ltr;">
              <button type="button" id="searchIndexBtn" class="transfer-btn" style="padding:0.5rem 1.2rem;font-size:1rem;min-width:80px;">Ø¬Ø³ØªØ¬Ùˆ</button>
            </div>
            <div id="searchIndexStatus" class="transfer-status" style="margin-top:0.3rem;"></div>
            <small style="color:#b8c1ec;font-size:0.85rem;margin-top:0.3rem;display:block;">Ø§ÛŒÙ†Ø¯Ú©Ø³ Ú©Ø§Ø±Ø¨Ø± Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯ ØªØ§ Ø¢Ø¯Ø±Ø³ Ø¨Ù‡ Ø·ÙˆØ± Ø®ÙˆØ¯Ú©Ø§Ø± Ù¾Ø± Ø´ÙˆØ¯</small>
          </div>
          <div class="transfer-row">
            <label for="transferAmount">Ù…Ù‚Ø¯Ø§Ø±:</label>
            <input type="number" id="transferAmount" placeholder="Ù…Ù‚Ø¯Ø§Ø± Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯" min="0" step="any" required>
            <small style="color:#b8c1ec;font-size:0.85rem;margin-top:0.3rem;display:block;">Ù…Ù‚Ø¯Ø§Ø± Ø§Ù†ØªÙ‚Ø§Ù„ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯ (Ø­Ø¯Ø§Ù‚Ù„ 0.001)</small>
          </div>
          <div class="transfer-row">
            <label for="transferToken">Ù†ÙˆØ¹ ØªÙˆÚ©Ù†:</label>
            <select id="transferToken" required>
              <option value="dai" selected>DAI</option>
              <option value="pol">POL</option>
              <option value="cpa">CPA</option>
            </select>
            <small style="color:#b8c1ec;font-size:0.85rem;margin-top:0.3rem;display:block;">Ù†ÙˆØ¹ ØªÙˆÚ©Ù† Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ø¨Ø±Ø§ÛŒ Ø§Ù†ØªÙ‚Ø§Ù„ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</small>
          </div>
          
          <!-- Balance Check -->
          <div style="background:rgba(167,134,255,0.1);border-radius:8px;padding:1rem;margin-bottom:1rem;">
            <h4 style="color:#a786ff;margin-bottom:0.8rem;">ğŸ’° Ù…ÙˆØ¬ÙˆØ¯ÛŒ ÙØ¹Ù„ÛŒ Ø´Ù…Ø§:</h4>
            <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:1rem;">
              <div style="text-align:center;">
                <div style="color:#00ff88;font-weight:bold;">DAI</div>
                <div id="transfer-dai-balance" style="color:#b8c1ec;font-family:monospace;">-</div>
              </div>
              <div style="text-align:center;">
                <div style="color:#a786ff;font-weight:bold;">POL</div>
                <div id="transfer-poly-balance" style="color:#b8c1ec;font-family:monospace;">-</div>
              </div>
              <div style="text-align:center;">
                <div style="color:#00ccff;font-weight:bold;">CPA</div>
                <div id="transfer-cpa-balance" style="color:#b8c1ec;font-family:monospace;">-</div>
              </div>
            </div>
          </div>
          
          <button type="submit" class="transfer-btn">Ø§Ù†ØªÙ‚Ø§Ù„</button>
          <div id="transferStatus" class="transfer-status"></div>
        </form>
      </div>
    </div>
  </div>

  <!-- Network Section -->
  <div id="main-network" class="page-section expandable-container" style="width:100vw;max-width:none;margin:0;left:0;right:0;padding:0.5rem 0;display:none;">
    <div class="expand-header">
      <h2 style="color: #00ff88; margin: 0;">ğŸŒ Network</h2>
    </div>
    <div class="expand-content">
      <div class="network-container" style="max-width: 1200px; margin: 0 auto; padding: 1rem;">
        <!-- Network Stats -->
        <div id="network-stats" class="network-user-info-container"></div>
        
        <!-- Network Members List -->
        <div id="network-tree">
          <div style="color:#00ccff;text-align:center;padding:2rem;">
            ğŸ”„ Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø±Ø®Øª Ø´Ø¨Ú©Ù‡...
            <br><br>
            <button onclick="window.initializeNetworkTab()" style="
              background: linear-gradient(135deg, #00ff88, #00cc66);
              color: #232946;
              border: none;
              padding: 0.8rem 1.5rem;
              border-radius: 8px;
              font-weight: bold;
              cursor: pointer;
              margin-top: 1rem;
            ">ğŸ”„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ø¬Ø¯Ø¯</button>
          </div>
        </div>
      </div>
    </div>
  </div>


  <!-- Ù†Ù…Ø§ÛŒØ´ ÙˆØ¶Ø¹ÛŒØª Ø§ØªØµØ§Ù„ -->
  <div id="connection-status" style="
    display: none;
    margin: 0 1rem 1rem 1rem;
    padding: 1rem;
    border-radius: 12px;
    font-family: 'Nazanin', 'B Nazanin', 'BNazanin', Tahoma, Arial, sans-serif;
    font-size: 0.9rem;
    font-weight: 600;
    text-align: center;
  "></div>

      <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    
    <!-- Ø³Ø§ÛŒØ± Ø§Ø³Ú©Ø±ÛŒÙ¾Øªâ€ŒÙ‡Ø§ -->
    <script src="js/firebase-config.js"></script>
    <script src="js/price-charts-manager.js"></script>
    <script src="js/config.js"></script>
  <script src="js/reports.js"></script>
  <script src="js/web3-interactions.js"></script>
  <script src="js/main.js"></script>
  <script src="js/network.js?v=5.7"></script>
  <script src="js/network-database.js?v=5.8"></script>
  <script src="js/profile.js?v=5.7"></script>
  <script src="js/news.js?v=5.7"></script>
  <script src="js/homepage.js?v=5.8"></script>
  <script src="js/price-history-manager.js?v=5.8"></script>
  <script src="js/price-chart.js?v=5.8"></script>
  <script src="js/point-chart.js?v=5.8"></script>

  <style>
    /* Fix for chart width issues */
    #price-chart-section {
      width: 100% !important;
      max-width: 100% !important;
      overflow-x: hidden !important;
    }
    
    #price-chart-canvas,
    #point-chart-canvas {
      width: 100% !important;
      max-width: 100% !important;
      height: 150px !important;
      box-sizing: border-box !important;
    }
    
    @media (max-width: 768px) {
      #price-chart-canvas,
      #point-chart-canvas {
        height: 120px !important;
      }
    }
    
    /* Transfer Status Styles */
    .transfer-status {
      margin-top: 1rem;
      padding: 0.8rem;
      border-radius: 8px;
      font-size: 0.9rem;
      text-align: center;
      font-weight: 500;
      transition: all 0.3s ease;
    }
    
    .transfer-status.success {
      background: rgba(0, 255, 136, 0.1);
      color: #00ff88;
      border: 1px solid rgba(0, 255, 136, 0.3);
    }
    
    .transfer-status.error {
      background: rgba(255, 68, 68, 0.1);
      color: #ff4444;
      border: 1px solid rgba(255, 68, 68, 0.3);
    }
    
    .transfer-status.loading {
      background: rgba(167, 134, 255, 0.1);
      color: #a786ff;
      border: 1px solid rgba(167, 134, 255, 0.3);
    }
    
    /* Transfer Form Improvements */
    .transfer-form {
      background: linear-gradient(135deg, #232946, #181c2a);
      border-radius: 12px;
      padding: 1.5rem;
      border: 2px solid #a786ff;
    }
    
    .transfer-row {
      margin-bottom: 1.5rem;
    }
    
    .transfer-row label {
      display: block;
      color: #a786ff;
      font-weight: bold;
      margin-bottom: 0.5rem;
      font-size: 0.95rem;
    }
    
    .transfer-row input,
    .transfer-row select {
      width: 100%;
      padding: 0.8rem;
      border-radius: 8px;
      border: 2px solid #a786ff;
      background: rgba(0, 0, 0, 0.2);
      color: #fff;
      font-size: 0.95rem;
      transition: border-color 0.3s ease;
      box-sizing: border-box;
    }
    
    .transfer-row input:focus,
    .transfer-row select:focus {
      outline: none;
      border-color: #00ff88;
    }
    
    .transfer-btn {
      background: linear-gradient(90deg, #00ff88, #a786ff);
      color: #181c2a;
      font-weight: bold;
      border: none;
      border-radius: 8px;
      padding: 1rem 2rem;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      width: 100%;
      margin-top: 1rem;
    }
    
    .transfer-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 255, 136, 0.3);
    }
    
    .transfer-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }
  </style>
  
  <!-- ØªØ¹Ø±ÛŒÙ Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø² Ø¨Ø±Ø§ÛŒ Ø³ÙˆØ§Ù¾ -->
  <script>
    // Ø¢Ø¯Ø±Ø³ Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯ DAI (DAI) Ø¯Ø± Ø´Ø¨Ú©Ù‡ Polygon
    window.DAI_ADDRESS = '0x8f3Cf7ad23Cd3CaDbD9735AFf958023239c6A063';
    
    // ABI Ø³Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ DAI (DAI)
    window.DAI_ABI = [
      {
        "inputs": [
          {
            "internalType": "address",
            "name": "spender",
            "type": "address"
          },
          {
            "internalType": "uint256",
            "name": "value",
            "type": "uint256"
          }
        ],
        "name": "approve",
        "outputs": [
          {
            "internalType": "bool",
            "name": "",
            "type": "bool"
          }
        ],
        "stateMutability": "nonpayable",
        "type": "function"
      },
      {
        "inputs": [
          {
            "internalType": "address",
            "name": "owner",
            "type": "address"
          },
          {
            "internalType": "address",
            "name": "spender",
            "type": "address"
          }
        ],
        "name": "allowance",
        "outputs": [
          {
            "internalType": "uint256",
            "name": "",
            "type": "uint256"
          }
        ],
        "stateMutability": "view",
        "type": "function"
      },
      {
        "inputs": [
          {
            "internalType": "address",
            "name": "account",
            "type": "address"
          }
        ],
        "name": "balanceOf",
        "outputs": [
          {
            "internalType": "uint256",
            "name": "",
            "type": "uint256"
          }
        ],
        "stateMutability": "view",
        "type": "function"
      }
    ];
  </script>
  
  <script src="js/swap.js?v=5.7"></script>
  

 
  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
  <script>
    (async () => {
      const { contract, address } = await window.connectWallet();
      const user = await contract.users(address);
  
    })();
  </script>

  <script>
    async function updateAboutWalletsCount() {
      try {
        if (!window.contractConfig || !window.contractConfig.contract) {
          await window.connectWallet();
        }
        const contract = window.contractConfig.contract;
        if (contract && contract.wallets) {
          const walletsCount = await contract.wallets();
          document.getElementById('about-wallets-count').innerText = walletsCount.toString();
        } else {
          document.getElementById('about-wallets-count').innerText = '-';
        }
      } catch (e) {
        document.getElementById('about-wallets-count').innerText = '-';
      }
    }
    // Hook into tab switching
    const aboutBtn = document.getElementById('tab-about-btn');
    if (aboutBtn) {
      aboutBtn.addEventListener('click', updateAboutWalletsCount);
    }
  </script>

  <script>
    function toggleDashboardChart(chartId, btn) {
      const chartDiv = document.getElementById(chartId);
      if (!chartDiv) return;
      const isOpen = chartDiv.style.display === 'block';
      chartDiv.style.display = isOpen ? 'none' : 'block';
      btn.textContent = isOpen ? 'â–¼' : 'â–²';
      // Placeholder: Here you can load/render the chart if needed
    }
  </script>
  <!-- Ù…ÙˆØ¯Ø§Ù„ Ø§ÙØ²ÙˆØ¯Ù†/ÙˆÛŒØ±Ø§ÛŒØ´ Ø³Ø§Ø¨ Ø§Ø¯Ù…ÛŒÙ† -->
  <div class="sub-admin-modal" id="sub-admin-modal">
    <div class="sub-admin-modal-content">
      <h3 id="modal-title">Ø§ÙØ²ÙˆØ¯Ù† Ø³Ø§Ø¨ Ø§Ø¯Ù…ÛŒÙ† Ø¬Ø¯ÛŒØ¯</h3>
      <form class="sub-admin-form" id="sub-admin-form">
        <div class="form-group">
          <label for="sub-admin-name">Ù†Ø§Ù… Ø³Ø§Ø¨ Ø§Ø¯Ù…ÛŒÙ†:</label>
          <input type="text" id="sub-admin-name" placeholder="Ù†Ø§Ù… Ú©Ø§Ù…Ù„ Ø³Ø§Ø¨ Ø§Ø¯Ù…ÛŒÙ†" required>
        </div>
        
        <div class="form-group">
          <label for="sub-admin-address">Ø¢Ø¯Ø±Ø³ Ú©ÛŒÙ Ù¾ÙˆÙ„:</label>
          <input type="text" id="sub-admin-address" placeholder="0x..." required>
        </div>
        
        <div class="form-group">
          <label for="sub-admin-role">Ù†Ù‚Ø´:</label>
          <select id="sub-admin-role" required>
            <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ù‚Ø´</option>
            <option value="moderator">Ù…Ø¯ÛŒØ± Ù…Ø­ØªÙˆØ§</option>
            <option value="support">Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ</option>
            <option value="analyst">ØªØ­Ù„ÛŒÙ„Ú¯Ø±</option>
            <option value="teacher">Ù…Ø¯Ø±Ø³</option>
            <option value="custom">Ø³ÙØ§Ø±Ø´ÛŒ</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="sub-admin-description">ØªÙˆØ¶ÛŒØ­Ø§Øª:</label>
          <textarea id="sub-admin-description" placeholder="ØªÙˆØ¶ÛŒØ­Ø§Øª Ø§Ø¶Ø§ÙÛŒ..." rows="3"></textarea>
        </div>
        
        <div class="permissions-group">
          <h5>ğŸ” Ø¯Ø³ØªØ±Ø³ÛŒâ€ŒÙ‡Ø§ÛŒ Ø³Ø§Ø¨ Ø§Ø¯Ù…ÛŒÙ†</h5>
          
          <div class="permission-item">
            <input type="checkbox" id="perm-stream-control" name="permissions">
            <label for="perm-stream-control">Ú©Ù†ØªØ±Ù„ Ù„Ø§ÛŒÙˆ Ø§Ø³ØªØ±ÛŒÙ…</label>
          </div>
          
          <div class="permission-item">
            <input type="checkbox" id="perm-chat-moderate" name="permissions">
            <label for="perm-chat-moderate">Ù…Ø¯ÛŒØ±ÛŒØª Ú†Øª</label>
          </div>
          
          <div class="permission-item">
            <input type="checkbox" id="perm-ban-users" name="permissions">
            <label for="perm-ban-users">Ù…Ø³Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† Ú©Ø§Ø±Ø¨Ø±Ø§Ù†</label>
          </div>
          
          <div class="permission-item">
            <input type="checkbox" id="perm-view-reports" name="permissions">
            <label for="perm-view-reports">Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§</label>
          </div>
          
          <div class="permission-item">
            <input type="checkbox" id="perm-manage-content" name="permissions">
            <label for="perm-manage-content">Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø­ØªÙˆØ§</label>
          </div>
          
          <div class="permission-item">
            <input type="checkbox" id="perm-view-analytics" name="permissions">
            <label for="perm-view-analytics">Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø¢Ù…Ø§Ø±</label>
          </div>
          
          <div class="permission-item">
            <input type="checkbox" id="perm-edit-products" name="permissions">
            <label for="perm-edit-products">ÙˆÛŒØ±Ø§ÛŒØ´ Ù…Ø­ØµÙˆÙ„Ø§Øª</label>
          </div>
          
          <div class="permission-item">
            <input type="checkbox" id="perm-view-orders" name="permissions">
            <label for="perm-view-orders">Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø³ÙØ§Ø±Ø´Ø§Øª</label>
          </div>
        </div>
        
        <div class="modal-buttons">
          <button type="submit" class="modal-btn primary" id="save-sub-admin-btn">ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡</button>
          <button type="button" class="modal-btn secondary" id="cancel-sub-admin-btn">âŒ Ø§Ù†ØµØ±Ø§Ù</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Ù…ÙˆØ¯Ø§Ù„ ØªØ£ÛŒÛŒØ¯ Ø­Ø°Ù -->
  <div class="sub-admin-modal" id="delete-confirm-modal">
    <div class="sub-admin-modal-content">
      <h3>âš ï¸ ØªØ£ÛŒÛŒØ¯ Ø­Ø°Ù</h3>
      <p style="color: #ccc; text-align: center; margin-bottom: 1.5rem;">
        Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ Ú©Ù‡ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø§ÛŒÙ† Ø³Ø§Ø¨ Ø§Ø¯Ù…ÛŒÙ† Ø±Ø§ Ø­Ø°Ù Ú©Ù†ÛŒØ¯ØŸ
      </p>
      <div style="background: #181c2a; padding: 1rem; border-radius: 8px; margin-bottom: 1.5rem;">
        <p style="color: #fff; margin: 0;"><strong>Ù†Ø§Ù…:</strong> <span id="delete-admin-name"></span></p>
        <p style="color: #888; margin: 0.5rem 0 0 0;"><strong>Ø¢Ø¯Ø±Ø³:</strong> <span id="delete-admin-address"></span></p>
      </div>
      <div class="modal-buttons">
        <button class="modal-btn danger" id="confirm-delete-btn">ğŸ—‘ï¸ Ø­Ø°Ù</button>
        <button class="modal-btn secondary" id="cancel-delete-btn">âŒ Ø§Ù†ØµØ±Ø§Ù</button>
      </div>
    </div>
  </div>



  <div id="custom-footer-div" style="text-align:center; padding:2rem; color:#00ff88; font-size:1.2rem;">
  <br>  <br>  <br>  <br>  <br>  <br>  <br>
  </div>


  <script>
    document.addEventListener('DOMContentLoaded', function() {
      var archiveBtn = Array.from(document.querySelectorAll('button, a')).find(el => el.textContent.includes('Ø¢Ø±Ø´ÛŒÙˆ Ø¨Ø§Ø²Ø§Ø±Ù‡Ø§ÛŒ Ù…Ø§Ù„ÛŒ'));
      if (archiveBtn) archiveBtn.remove();
      
      // Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ ØªØ¨ ÙØ¹Ø§Ù„ Ø§Ø² localStorage
      const savedTab = localStorage.getItem('currentActiveTab');
      if (savedTab && savedTab !== 'network' && typeof window.showTab === 'function') {
        // Ú©Ù…ÛŒ ØµØ¨Ø± Ú©Ù† ØªØ§ ØµÙØ­Ù‡ Ú©Ø§Ù…Ù„Ø§Ù‹ Ù„ÙˆØ¯ Ø´ÙˆØ¯
        setTimeout(() => {
          window.showTab(savedTab);
        }, 1000);
      }
    });
  </script>

  <script>
  (async function() {
    if (window.getUserProfile) {
      const profile = await window.getUserProfile();
      if (!profile.activated) {
        // Ù‚ÙÙ„ Ú©Ø±Ø¯Ù† ÙÙ‚Ø· Ø¨Ø®Ø´ Ø±ÛŒÙ¾ÙˆØ±Øª
        const reportsSection = document.getElementById('main-reports');
        if (reportsSection) {
          reportsSection.innerHTML = '<div style="color:#ff6b6b;text-align:center;padding:3rem;font-size:1.5rem;">Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ø§ÛŒÙ† Ø¨Ø®Ø´ ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† ÙØ¹Ø§Ù„ Ù…Ø¬Ø§Ø² Ø§Ø³Øª.<br>ğŸ”’</div>';
          reportsSection.style.background = '#181c2a';
        }
      }
    }
  })();
  </script>

  <!-- Ú©Ù†ØªØ±Ù„ Ù†Ù…Ø§ÛŒØ´ ÙˆØ±ÙˆØ¯ÛŒ Ø¢Ø¯Ø±Ø³ Ù…Ù‚ØµØ¯ -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const transferForm = document.getElementById('transferForm');
      if (!transferForm) return;
      transferForm.addEventListener('submit', async function(e) {
        e.preventDefault();
        const transferBtn = transferForm.querySelector('button[type="submit"]');
        if (transferBtn) {
          transferBtn.disabled = true;
          var oldText = transferBtn.textContent;
          transferBtn.textContent = 'Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø±Ø¯Ø§Ø²Ø´...';
        }
        const to = document.getElementById('transferTo').value.trim();
        const amount = parseFloat(document.getElementById('transferAmount').value);
        const token = document.getElementById('transferToken').value;
        const status = document.getElementById('transferStatus');
        status.textContent = '';
        status.className = 'transfer-status';
        if (!to || !amount || amount <= 0) {
          status.textContent = 'Ø¢Ø¯Ø±Ø³ Ù…Ù‚ØµØ¯ Ùˆ Ù…Ù‚Ø¯Ø§Ø± Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯';
          status.className = 'transfer-status error';
          if (transferBtn) { transferBtn.disabled = false; transferBtn.textContent = oldText; }
          return;
        }
        if (!window.contractConfig || !window.contractConfig.contract || !window.contractConfig.signer) {
          status.textContent = 'Ø§ØªØµØ§Ù„ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø¨Ø±Ù‚Ø±Ø§Ø± Ù†ÛŒØ³Øª';
          status.className = 'transfer-status error';
          if (transferBtn) { transferBtn.disabled = false; transferBtn.textContent = oldText; }
          return;
        }
        try {
          status.textContent = 'Ø¯Ø± Ø­Ø§Ù„ Ø§Ø±Ø³Ø§Ù„...';
          status.className = 'transfer-status loading';
          if (token === 'pol') {
            // Ø§Ù†ØªÙ‚Ø§Ù„ MATIC/POL
            const tx = await window.contractConfig.signer.sendTransaction({
              to,
              value: ethers.parseEther(amount.toString())
            });
            await tx.wait();
            status.textContent = 'Ø§Ù†ØªÙ‚Ø§Ù„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯!\nÚ©Ø¯ ØªØ±Ø§Ú©Ù†Ø´: ' + tx.hash;
            status.className = 'transfer-status success';
          } else if (token === 'dai') {
            // Ø§Ù†ØªÙ‚Ø§Ù„ DAI
            const daiContract = new ethers.Contract(DAI_ADDRESS, DAI_ABI, window.contractConfig.signer);
            const decimals = 6; // DAI has 18 decimals
            const parsedAmount = ethers.parseUnits(amount.toString(), decimals);
            const tx = await daiContract.transfer(to, parsedAmount);
            await tx.wait();
            status.textContent = 'Ø§Ù†ØªÙ‚Ø§Ù„ DAI Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯!\nÚ©Ø¯ ØªØ±Ø§Ú©Ù†Ø´: ' + tx.hash;
            status.className = 'transfer-status success';
          } else {
            // Ø§Ù†ØªÙ‚Ø§Ù„ CPA
            const contract = window.contractConfig.contract;
            const tx = await contract.transfer(to, ethers.parseEther(amount.toString()));
            await tx.wait();
            status.textContent = 'Ø§Ù†ØªÙ‚Ø§Ù„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯!\nÚ©Ø¯ ØªØ±Ø§Ú©Ù†Ø´: ' + tx.hash;
            status.className = 'transfer-status success';
          }
          transferForm.reset();
        } catch (error) {
          let msg = error && error.message ? error.message : error;
          if (msg.includes('user rejected')) msg = 'ØªØ±Ø§Ú©Ù†Ø´ ØªÙˆØ³Ø· Ú©Ø§Ø±Ø¨Ø± Ù„ØºÙˆ Ø´Ø¯';
          else if (msg.includes('insufficient funds')) msg = 'Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ø§ÙÛŒ Ù†ÛŒØ³Øª';
          else if (msg.includes('invalid address')) msg = 'Ø¢Ø¯Ø±Ø³ Ù…Ù‚ØµØ¯ Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª';
          else if (msg.includes('nonce')) msg = 'Ø®Ø·Ø§ Ø¯Ø± Ø´Ù…Ø§Ø±Ù‡ ØªØ±Ø§Ú©Ù†Ø´. Ù„Ø·ÙØ§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯';
          else if (msg.includes('execution reverted')) msg = 'ØªØ±Ø§Ú©Ù†Ø´ Ù†Ø§Ù…ÙˆÙÙ‚ Ø¨ÙˆØ¯. Ù„Ø·ÙØ§Ù‹ Ø´Ø±Ø§ÛŒØ· Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯';
          else msg = 'Ø®Ø·Ø§ Ø¯Ø± Ø§Ù†ØªÙ‚Ø§Ù„: ' + msg;
          status.textContent = msg;
          status.className = 'transfer-status error';
        }
        if (transferBtn) { transferBtn.disabled = false; transferBtn.textContent = oldText; }
      });
    });
  </script>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const searchBtn = document.getElementById('searchIndexBtn');
      const searchInput = document.getElementById('searchIndex');
      const searchStatus = document.getElementById('searchIndexStatus');
      if (searchBtn && searchInput) {
        searchBtn.onclick = async function() {
          searchStatus.textContent = '';
          const idx = searchInput.value.trim();
          if (!idx || isNaN(idx) || Number(idx) < 0) {
            searchStatus.textContent = 'Ø§ÛŒÙ†Ø¯Ú©Ø³ Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯';
            searchStatus.className = 'transfer-status error';
            return;
          }
          if (!window.contractConfig || !window.contractConfig.contract) {
            searchStatus.textContent = 'Ø§ØªØµØ§Ù„ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø¨Ø±Ù‚Ø±Ø§Ø± Ù†ÛŒØ³Øª';
            searchStatus.className = 'transfer-status error';
            return;
          }
          try {
            searchStatus.textContent = 'Ø¯Ø± Ø­Ø§Ù„ Ø¬Ø³ØªØ¬Ùˆ...';
            searchStatus.className = 'transfer-status loading';
            const contract = window.contractConfig.contract;
            const address = await contract.indexToAddress(BigInt(idx));
            if (!address || address === '0x0000000000000000000000000000000000000000') {
              searchStatus.textContent = 'Ø¢Ø¯Ø±Ø³ ÙˆÙ„Øª Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ† Ø§ÛŒÙ†Ø¯Ú©Ø³ ÛŒØ§ÙØª Ù†Ø´Ø¯';
              searchStatus.className = 'transfer-status error';
              document.getElementById('transferTo').value = '';
            } else {
              searchStatus.textContent = 'Ø¢Ø¯Ø±Ø³ ÙˆÙ„Øª Ù¾ÛŒØ¯Ø§ Ø´Ø¯';
              searchStatus.className = 'transfer-status success';
              document.getElementById('transferTo').value = address;
            }
          } catch (err) {
            searchStatus.textContent = 'Ø®Ø·Ø§ Ø¯Ø± Ø¬Ø³ØªØ¬Ùˆ: ' + (err && err.message ? err.message : err);
            searchStatus.className = 'transfer-status error';
            document.getElementById('transferTo').value = '';
          }
        };
      }
    });
  </script>

  <script>
    // ØªØ§Ø¨Ø¹ Ø¨Ø§Ø²/Ø¨Ø³ØªÙ‡ Ú©Ø±Ø¯Ù† Ø¨Ø®Ø´â€ŒÙ‡Ø§ÛŒ Ù‚Ø§Ø¨Ù„ Ú¯Ø³ØªØ±Ø´
    function toggleExpandable(containerId) {
      const container = document.getElementById(containerId);
      if (container) {
        container.classList.toggle('collapsed');
        
        // Ø°Ø®ÛŒØ±Ù‡ ÙˆØ¶Ø¹ÛŒØª Ø¯Ø± localStorage
        const isCollapsed = container.classList.contains('collapsed');
        localStorage.setItem(`expandable_${containerId}`, isCollapsed ? 'collapsed' : 'expanded');
      }
    }

    // Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ ÙˆØ¶Ø¹ÛŒØª Ø¨Ø®Ø´â€ŒÙ‡Ø§ÛŒ Ù‚Ø§Ø¨Ù„ Ú¯Ø³ØªØ±Ø´ Ø§Ø² localStorage
    function restoreExpandableStates() {
      const expandableContainers = document.querySelectorAll('.expandable-container');
      expandableContainers.forEach(container => {
        const containerId = container.id;
        const savedState = localStorage.getItem(`expandable_${containerId}`);
        if (savedState === 'collapsed') {
          container.classList.add('collapsed');
        }
      });
    }

    document.addEventListener('DOMContentLoaded', function() {
      // Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ ÙˆØ¶Ø¹ÛŒØª Ø¨Ø®Ø´â€ŒÙ‡Ø§ÛŒ Ù‚Ø§Ø¨Ù„ Ú¯Ø³ØªØ±Ø´
      restoreExpandableStates();
      
      
    });
  </script>

  <script>
    // ØªØ§Ø¨Ø¹ Ù†Ù…Ø§ÛŒØ´ Ù‚ÛŒÙ…Øª Ø¨Ø§ Ù†Ù…Ø§Ø¯ Ø¹Ù„Ù…ÛŒ
    window.formatTokenPrice = function(priceWei) {
      if (!priceWei || priceWei === '0') return '0';
      let priceString = priceWei.toString();
      while (priceString.length < 18) priceString = '0' + priceString;
      if (priceString.length > 18) priceString = priceString.slice(-18);
      const result = '0.' + priceString;
      const numResult = parseFloat(result);
      if (numResult < 0.000001) {
        return numResult.toExponential(6);
      }
      return result;
    }

    // ØªØ§Ø¨Ø¹ Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ù…Ø§ÛŒØ´ Ù‚ÛŒÙ…Øª
    async function updateTokenPriceDisplay() {
      try {
        if (!window.contractConfig || !window.contractConfig.contract) {
          await window.connectWallet();
          if (!window.contractConfig || !window.contractConfig.contract) {
            const el = document.getElementById('chart-lvl-usd');
            if (el) el.textContent = 'Ø§ØªØµØ§Ù„ Ù†Ø§Ù…ÙˆÙÙ‚';
            return;
          }
        }
        const contract = window.contractConfig.contract;
        const tokenPrice = await contract.getTokenPrice();
        const priceFormatted = window.formatTokenPrice(tokenPrice);
        const el = document.getElementById('chart-lvl-usd');
        if (el) el.textContent = priceFormatted;
        // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ point-value Ø§Ø² Ù‚Ø±Ø§Ø±Ø¯Ø§Ø¯
        try {
          const pointValue = await contract.getPointValue();
          const pointValueNum = parseFloat(ethers.formatUnits(pointValue, 18));
          const pointValueFormatted = pointValueNum < 0.000001 ? pointValueNum.toExponential(6) : pointValueNum.toFixed(2);
          const el2 = document.getElementById('point-value');
          if (el2) el2.textContent = pointValueFormatted + ' CPA';
        } catch (error) {
          // ...
        }
      } catch (error) {
        const el = document.getElementById('chart-lvl-usd');
        if (el) el.textContent = 'Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ';
      }
    }
    // ... existing code ...
  </script>

  <script>
    if (window.loadUserProfile) {
      const origLoadUserProfile = window.loadUserProfile;
      window.loadUserProfile = async function() {
        await origLoadUserProfile.apply(this, arguments);
        await updateProfileReferrer(); // Ø§ÛŒÙ†Ø¬Ø§ Ø¨Ø§ await Ùˆ Ø¨Ø¯ÙˆÙ† ØªØ§Ø®ÛŒØ±
      };
    }
  </script>
  <script src="js/token-price.js"></script>
  <script src="js/remove-archive-btn.js"></script>



  <script>
  document.addEventListener('DOMContentLoaded', function() {
    const btn = document.getElementById('connectProfileWalletBtn');
    if (btn) {
      btn.addEventListener('click', async function() {
        try {
          if (window.connectWallet) {
            await window.connectWallet();
            // Ù¾Ø³ Ø§Ø² Ø§ØªØµØ§Ù„ØŒ Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ø±Ø§ Ù…Ø¬Ø¯Ø¯ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ú©Ù†
            if (typeof loadUserProfile === 'function') loadUserProfile();
          }
        } catch (e) {
          alert('Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„ Ú©ÛŒÙ Ù¾ÙˆÙ„: ' + (e.message || e));
        }
      });
    }
  });
  </script>

  <script src="js/navbar.js"></script>
  
  <!-- Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ SwapManager -->
  <script>
    document.addEventListener('DOMContentLoaded', async function() {
      console.log('ğŸš€ Ø´Ø±ÙˆØ¹ Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ SwapManager...');
      
      // Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø§Ø² Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ swap.js
      if (typeof SwapManager !== 'undefined') {
        try {
          console.log('âœ… Ú©Ù„Ø§Ø³ SwapManager ÛŒØ§ÙØª Ø´Ø¯');
          
          // Ú©Ù…ÛŒ ØµØ¨Ø± Ú©Ù† ØªØ§ DOM Ú©Ø§Ù…Ù„Ø§Ù‹ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´ÙˆØ¯
          await new Promise(resolve => setTimeout(resolve, 1000));
          
          // Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¬ÙˆØ¯ Ø¹Ù†Ø§ØµØ± Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø²
          const requiredElements = ['swapForm', 'swapDirection', 'swapAmount', 'maxBtn', 'swapRate', 'swapPreview', 'swapLimitInfo', 'swapStatus'];
          const missingElements = requiredElements.filter(id => !document.getElementById(id));
          
          if (missingElements.length > 0) {
            console.warn('âš ï¸ Ø¹Ù†Ø§ØµØ± Ø²ÛŒØ± ÛŒØ§ÙØª Ù†Ø´Ø¯Ù†Ø¯:', missingElements);
            return;
          }
          
          console.log('âœ… ØªÙ…Ø§Ù… Ø¹Ù†Ø§ØµØ± Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø² Ù…ÙˆØ¬ÙˆØ¯ Ù‡Ø³ØªÙ†Ø¯');
          
          // Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¬ÙˆØ¯ Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø²
          if (!window.DAI_ADDRESS || !window.DAI_ABI) {
            console.error('âŒ Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ DAI_ADDRESS ÛŒØ§ DAI_ABI ØªØ¹Ø±ÛŒÙ Ù†Ø´Ø¯Ù‡â€ŒØ§Ù†Ø¯');
            return;
          }
          
          console.log('âœ… Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ DAI Ù…ÙˆØ¬ÙˆØ¯ Ù‡Ø³ØªÙ†Ø¯');
          
          // Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù…ÙˆÙ†Ù‡ SwapManager
          window.swapManager = new SwapManager();
          console.log('âœ… Ù†Ù…ÙˆÙ†Ù‡ SwapManager Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯');
          
          // Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
          await window.swapManager.initializeSwap();
          console.log('âœ… SwapManager Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø´Ø¯');
          
        } catch (error) {
          console.error('âŒ Ø®Ø·Ø§ Ø¯Ø± Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ SwapManager:', error);
        }
      } else {
        console.warn('âš ï¸ SwapManager ØªØ¹Ø±ÛŒÙ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª - ÙØ§ÛŒÙ„ swap.js Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù†Ø´Ø¯Ù‡');
      }
    });
    
    // Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ù…Ø¬Ø¯Ø¯ Ø¨Ø¹Ø¯ Ø§Ø² Ø§ØªØµØ§Ù„ Ú©ÛŒÙ Ù¾ÙˆÙ„
    if (window.connectWallet) {
      const originalConnectWallet = window.connectWallet;
      window.connectWallet = async function() {
        const result = await originalConnectWallet();
        
        // Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ù…Ø¬Ø¯Ø¯ SwapManager Ø¨Ø¹Ø¯ Ø§Ø² Ø§ØªØµØ§Ù„
        setTimeout(async () => {
          if (window.swapManager && typeof window.swapManager.refreshSwapData === 'function') {
            try {
              console.log('ğŸ”„ Ø±ÙØ±Ø´ SwapManager Ø¨Ø¹Ø¯ Ø§Ø² Ø§ØªØµØ§Ù„ Ú©ÛŒÙ Ù¾ÙˆÙ„...');
              await window.swapManager.refreshSwapData();
              console.log('âœ… SwapManager Ø±ÙØ±Ø´ Ø´Ø¯');
            } catch (error) {
              console.warn('âš ï¸ Ø®Ø·Ø§ Ø¯Ø± Ø±ÙØ±Ø´ SwapManager:', error);
            }
          }
        }, 1000);
        
        return result;
      };
    }
  </script>
  </div>
</body>
</html>

