<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Error Test</title>
</head>
<body>
  <h1>Error Test Page</h1>
  <div id="status">Testing...</div>
  
  <script>
    // Suppress all extension errors
    window.addEventListener('error', function(e){
      const m = (e && e.message) || '';
      const stack = (e && e.error && e.error.stack) || '';
      const combined = m + ' ' + stack;
      
      if (combined.includes('Could not establish connection') || 
          combined.includes('getEnabledChains') || 
          combined.includes('isDefaultWallet') || 
          combined.includes('Internal JSON-RPC error') ||
          combined.includes('exports is not defined') ||
          combined.includes('The method "isDefaultWallet" does not exist') ||
          combined.includes('Module not found') ||
          combined.includes('index.js:3') ||
          combined.includes('MetaMask - RPC Error') ||
          combined.includes('inpage.js')) {
        console.warn('⚠️ Suppressed extension error:', m);
        e.preventDefault();
        return false;
      }
    });
    
    window.addEventListener('unhandledrejection', function(e){
      const r = e && e.reason;
      const msg = (r && (r.message || r)) || '';
      const stack = (r && r.stack) || '';
      const combined = msg + ' ' + stack;
      
      if (typeof msg === 'string' && (combined.includes('Could not establish connection') || 
          combined.includes('getEnabledChains') || 
          combined.includes('isDefaultWallet') || 
          combined.includes('Internal JSON-RPC error') ||
          combined.includes('exports is not defined') ||
          combined.includes('The method "isDefaultWallet" does not exist') ||
          combined.includes('Module not found') ||
          combined.includes('index.js:3') ||
          combined.includes('MetaMask - RPC Error') ||
          combined.includes('inpage.js'))) {
        console.warn('⚠️ Suppressed extension rejection:', msg);
        e.preventDefault();
        return false;
      }
    });
    
    // Suppress console errors from extensions
    const originalConsoleError = console.error;
    console.error = function(...args) {
      const message = args.join(' ');
      if (message.includes('MetaMask - RPC Error') ||
          message.includes('isDefaultWallet') ||
          message.includes('inpage.js') ||
          message.includes('exports is not defined')) {
        console.warn('⚠️ Suppressed console error:', message);
        return;
      }
      originalConsoleError.apply(console, args);
    };
    
    // Test async function
    async function testAsync() {
      try {
        document.getElementById('status').textContent = 'Testing async functions...';
        
        // Simulate async operation
        await new Promise(resolve => setTimeout(resolve, 1000));
        
        document.getElementById('status').textContent = '✅ All tests passed!';
        
      } catch (error) {
        document.getElementById('status').textContent = '❌ Error: ' + error.message;
      }
    }
    
    // Run test
    testAsync();
  </script>
</body>
</html>
